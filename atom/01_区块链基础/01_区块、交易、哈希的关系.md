# åŒºå—ã€äº¤æ˜“ã€å“ˆå¸Œçš„å…³ç³»

## 1. ã€30å­—æ ¸å¿ƒã€‘

**åŒºå—æ˜¯ä»¥å¤ªåŠçš„æ•°æ®å®¹å™¨ï¼Œé€šè¿‡å“ˆå¸Œå‡½æ•°é“¾æ¥æˆé“¾ï¼Œæ¯ä¸ªåŒºå—åŒ…å«äº¤æ˜“åˆ—è¡¨ï¼Œå“ˆå¸Œç¡®ä¿æ•°æ®ä¸å¯ç¯¡æ”¹æ€§å’Œå®Œæ•´æ€§ã€‚**

---

## 2. ã€ç¬¬ä¸€æ€§åŸç†ã€‘

### ä»€ä¹ˆæ˜¯ç¬¬ä¸€æ€§åŸç†ï¼Ÿ

**ç¬¬ä¸€æ€§åŸç†**ï¼šå›åˆ°äº‹ç‰©æœ€åŸºæœ¬çš„çœŸç†ï¼Œä»æºå¤´æ€è€ƒé—®é¢˜

### åŒºå—ã€äº¤æ˜“ã€å“ˆå¸Œçš„ç¬¬ä¸€æ€§åŸç† ğŸ¯

#### 1. æœ€åŸºç¡€çš„å®šä¹‰

**åŒºå— = ä¸€ç»„äº¤æ˜“æ•°æ® + å…ƒæ•°æ®**
**äº¤æ˜“ = è´¦æˆ·ä¹‹é—´çš„ä»·å€¼æˆ–æ•°æ®è½¬ç§»è®°å½•**
**å“ˆå¸Œ = å°†ä»»æ„é•¿åº¦æ•°æ®æ˜ å°„ä¸ºå›ºå®šé•¿åº¦å”¯ä¸€æŒ‡çº¹çš„å‡½æ•°**

ä»…æ­¤è€Œå·²ï¼æ²¡æœ‰æ›´åŸºç¡€çš„äº†ã€‚

#### 2. ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸‰ä¸ªæ¦‚å¿µï¼Ÿ

**æ ¸å¿ƒé—®é¢˜ï¼šå¦‚ä½•åœ¨ä¸å¯ä¿¡çš„ç½‘ç»œä¸­ï¼Œè®©æ‰€æœ‰äººå¯¹è´¦æœ¬è¾¾æˆå…±è¯†ï¼Œå¹¶ä¸”ä¿è¯è´¦æœ¬ä¸å¯ç¯¡æ”¹ï¼Ÿ**

åœ¨ä¼ ç»Ÿä¸­å¿ƒåŒ–ç³»ç»Ÿä¸­ï¼ˆå¦‚é“¶è¡Œï¼‰ï¼Œç”±ä¸­å¿ƒåŒ–æœºæ„ä¿è¯è´¦æœ¬çš„æ­£ç¡®æ€§ã€‚ä½†åœ¨å»ä¸­å¿ƒåŒ–ç½‘ç»œä¸­ï¼Œæ²¡æœ‰ä¸­å¿ƒåŒ–æƒå¨ï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ

#### 3. è¿™ä¸‰ä¸ªæ¦‚å¿µçš„ä¸‰å±‚ä»·å€¼

##### ä»·å€¼1ï¼šæ•°æ®ç»„ç»‡ï¼ˆåŒºå—ï¼‰

**é—®é¢˜**ï¼šå¦‚æœæ¯ç¬”äº¤æ˜“éƒ½å•ç‹¬å¹¿æ’­å’ŒéªŒè¯ï¼Œç½‘ç»œä¼šè¢«æµ·é‡äº¤æ˜“æ·¹æ²¡ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šå°†äº¤æ˜“æ‰“åŒ…æˆåŒºå—ï¼Œæ‰¹é‡å¤„ç†å’ŒéªŒè¯ã€‚

**ç¤ºä¾‹**ï¼š
- âŒ ä¸å¥½çš„è®¾è®¡ï¼š10000ç¬”äº¤æ˜“ â†’ 10000æ¬¡ç‹¬ç«‹éªŒè¯ â†’ ç½‘ç»œæ‹¥å µ
- âœ… åŒºå—è®¾è®¡ï¼š10000ç¬”äº¤æ˜“ â†’ æ‰“åŒ…æˆ10ä¸ªåŒºå— â†’ åªéœ€éªŒè¯10ä¸ªåŒºå—å¤´

##### ä»·å€¼2ï¼šå®Œæ•´æ€§éªŒè¯ï¼ˆå“ˆå¸Œï¼‰

**é—®é¢˜**ï¼šå¦‚ä½•å¿«é€ŸéªŒè¯æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ï¼Ÿé€ä¸ªæ¯”å¯¹å¤ªæ…¢ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†æ•´ä¸ªåŒºå—æ•°æ®å‹ç¼©æˆ256ä½æŒ‡çº¹ï¼Œä»»ä½•æ•°æ®æ”¹åŠ¨éƒ½ä¼šå¯¼è‡´å“ˆå¸Œå®Œå…¨ä¸åŒã€‚

**ç¤ºä¾‹**ï¼š
```javascript
// åŸå§‹æ•°æ®
const block = "äº¤æ˜“1: Alice â†’ Bob 1 ETH, äº¤æ˜“2: Charlie â†’ David 2 ETH";
const hash1 = keccak256(block);
// è¾“å‡º: 0xa4f3...2b1c

// ç¯¡æ”¹åçš„æ•°æ®
const tamperedBlock = "äº¤æ˜“1: Alice â†’ Bob 100 ETH, äº¤æ˜“2: Charlie â†’ David 2 ETH";
const hash2 = keccak256(tamperedBlock);
// è¾“å‡º: 0x72d9...8e3f (å®Œå…¨ä¸åŒ)
```

##### ä»·å€¼3ï¼šé“¾å¼ç»“æ„ï¼ˆåŒºå—é“¾ï¼‰

**é—®é¢˜**ï¼šå¦‚ä½•ä¿è¯å†å²è®°å½•ä¸å¯ç¯¡æ”¹ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šæ¯ä¸ªåŒºå—çš„å“ˆå¸Œéƒ½åŒ…å«ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œï¼ˆparent hashï¼‰ï¼Œå½¢æˆé“¾å¼ç»“æ„ã€‚ç¯¡æ”¹ä»»ä½•å†å²åŒºå—éƒ½ä¼šå¯¼è‡´åç»­æ‰€æœ‰åŒºå—çš„å“ˆå¸Œå¤±æ•ˆã€‚

**ç¤ºä¾‹**ï¼š
```
åŒºå—1 (hash: 0xAAA)
    â†“ (parent hash: 0xAAA)
åŒºå—2 (hash: 0xBBB)
    â†“ (parent hash: 0xBBB)
åŒºå—3 (hash: 0xCCC)

å¦‚æœç¯¡æ”¹åŒºå—1:
åŒºå—1' (hash: 0xXXX) âŒ ä¸åŒ¹é…
    â†“ (åŒºå—2çš„parent hashä»æ˜¯0xAAAï¼ŒéªŒè¯å¤±è´¥ï¼)
```

#### 4. ä»ç¬¬ä¸€æ€§åŸç†æ¨å¯¼ä»¥å¤ªåŠåŒºå—é“¾å®ç°

**æ¨ç†é“¾ï¼š**

```
1. å‰æï¼šéœ€è¦ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„ã€ä¸å¯ç¯¡æ”¹çš„è´¦æœ¬
   â†“
2. æ¨å¯¼ï¼šè´¦æœ¬éœ€è¦å°†äº¤æ˜“æ‰¹é‡æ‰“åŒ… â†’ å¼•å…¥"åŒºå—"æ¦‚å¿µ
   â†“
3. æ¨å¯¼ï¼šéœ€è¦éªŒè¯åŒºå—æ•°æ®å®Œæ•´æ€§ â†’ å¼•å…¥"å“ˆå¸Œå‡½æ•°"
   â†“
4. æ¨å¯¼ï¼šéœ€è¦ä¿è¯å†å²ä¸å¯ç¯¡æ”¹ â†’ å¼•å…¥"é“¾å¼ç»“æ„"(æ¯ä¸ªåŒºå—åŒ…å«parent hash)
   â†“
5. æ¨å¯¼ï¼šéœ€è¦é«˜æ•ˆéªŒè¯æ‰€æœ‰äº¤æ˜“ â†’ å¼•å…¥"Merkle Tree"(ç”¨äº¤æ˜“æ ¹å“ˆå¸Œè¡¨ç¤ºæ‰€æœ‰äº¤æ˜“)
   â†“
6. æ¨å¯¼ï¼šéœ€è¦è·Ÿè¸ªè´¦æˆ·çŠ¶æ€ â†’ å¼•å…¥"çŠ¶æ€æ ¹"(State Root)
   â†“
7. æ¨å¯¼ï¼šéœ€è¦éªŒè¯äº¤æ˜“æ‰§è¡Œç»“æœ â†’ å¼•å…¥"æ”¶æ®æ ¹"(Receipts Root)
   â†“
8. æœ€ç»ˆå®ç°ï¼šä»¥å¤ªåŠåŒºå—ç»“æ„
   - Header: parent hash, state root, transaction root, receipts root, timestamp, nonce...
   - Body: transactions
   - Hash: Keccak256(header) â†’ é“¾æ¥åˆ°ä¸‹ä¸€ä¸ªåŒºå—
```

#### 5. ä¸€å¥è¯æ€»ç»“ç¬¬ä¸€æ€§åŸç†

**åŒºå—æ˜¯äº¤æ˜“çš„æ‰¹é‡å®¹å™¨ï¼Œå“ˆå¸Œæ˜¯æ•°æ®å®Œæ•´æ€§çš„æŒ‡çº¹ï¼Œé€šè¿‡parent hashé“¾æ¥å½¢æˆä¸å¯ç¯¡æ”¹çš„é“¾å¼è´¦æœ¬ï¼Œè¿™å°±æ˜¯åŒºå—é“¾çš„æœ¬è´¨ã€‚**

---

## 3. ã€3ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‘

### æ ¸å¿ƒæ¦‚å¿µ1ï¼šåŒºå—ç»“æ„ ğŸ§±

**ä¸€å¥è¯å®šä¹‰ï¼š** åŒºå—ç”±åŒºå—å¤´(Header)å’ŒåŒºå—ä½“(Body)ç»„æˆï¼ŒHeaderåŒ…å«å…ƒæ•°æ®å’Œä¸‰ä¸ªé‡è¦çš„Merkleæ ¹ï¼ŒBodyåŒ…å«äº¤æ˜“åˆ—è¡¨ã€‚

#### åŒºå—å¤´ï¼ˆBlock Headerï¼‰çš„å…³é”®å­—æ®µï¼š

```javascript
{
  // ===== é“¾æ¥å­—æ®µ =====
  parentHash: "0xabc123...",      // çˆ¶åŒºå—å“ˆå¸Œï¼ˆé“¾æ¥ä¸Šä¸€ä¸ªåŒºå—ï¼‰
  number: 12345678,                // åŒºå—å·ï¼ˆé«˜åº¦ï¼‰

  // ===== ä¸‰ä¸ªMerkleæ ¹ =====
  stateRoot: "0xdef456...",        // çŠ¶æ€æ ‘æ ¹ï¼ˆæ‰€æœ‰è´¦æˆ·çŠ¶æ€çš„å“ˆå¸Œæ‘˜è¦ï¼‰
  transactionsRoot: "0x789abc...", // äº¤æ˜“æ ‘æ ¹ï¼ˆæœ¬åŒºå—æ‰€æœ‰äº¤æ˜“çš„å“ˆå¸Œæ‘˜è¦ï¼‰
  receiptsRoot: "0x456def...",     // æ”¶æ®æ ‘æ ¹ï¼ˆæ‰€æœ‰äº¤æ˜“æ‰§è¡Œç»“æœçš„å“ˆå¸Œæ‘˜è¦ï¼‰

  // ===== å…±è¯†å­—æ®µ =====
  timestamp: 1625097600,           // åŒºå—æ—¶é—´æˆ³ï¼ˆUnixæ—¶é—´ï¼‰
  nonce: "0x0000000000000042",     // éšæœºæ•°ï¼ˆPoWæ—¶ä»£ç”¨äºæŒ–çŸ¿ï¼ŒPoSåä¸º0ï¼‰
  difficulty: 2000000000000000,    // éš¾åº¦å€¼ï¼ˆPoSååºŸå¼ƒï¼‰

  // ===== å…¶ä»–å…ƒæ•°æ® =====
  miner: "0x123abc...",            // çŸ¿å·¥/éªŒè¯è€…åœ°å€
  gasLimit: 30000000,              // æœ¬åŒºå—Gasä¸Šé™
  gasUsed: 12456789,               // å®é™…ä½¿ç”¨çš„Gas
  extraData: "0x...",              // é¢å¤–æ•°æ®ï¼ˆçŸ¿å·¥ç•™è¨€ï¼‰

  // ===== åŒºå—å“ˆå¸Œï¼ˆè®¡ç®—å¾—å‡ºï¼Œä¸å­˜å‚¨åœ¨Headerä¸­ï¼‰=====
  hash: Keccak256(Headeræ‰€æœ‰å­—æ®µ)   // æœ¬åŒºå—å“ˆå¸Œ
}
```

#### åŒºå—ä½“ï¼ˆBlock Bodyï¼‰ï¼š

```javascript
{
  transactions: [
    {
      from: "0xAlice",
      to: "0xBob",
      value: "1000000000000000000", // 1 ETH (å•ä½: Wei)
      nonce: 5,
      gasLimit: 21000,
      maxFeePerGas: "30000000000",
      data: "0x"
    },
    // ... æ›´å¤šäº¤æ˜“
  ]
}
```

**è¯¦ç»†è§£é‡Šï¼š**

ä»¥å¤ªåŠåŒºå—é‡‡ç”¨"Header+Body"çš„åˆ†ç¦»è®¾è®¡ï¼Œè¿™æ ·å¯ä»¥å¿«é€ŸéªŒè¯åŒºå—å“ˆå¸Œï¼ˆåªéœ€è®¡ç®—Headerï¼‰ï¼Œè€Œæ— éœ€ä¸‹è½½å®Œæ•´äº¤æ˜“æ•°æ®ã€‚è¿™æ˜¯**è½»å®¢æˆ·ç«¯ï¼ˆLight Clientï¼‰**èƒ½å¤Ÿå¿«é€ŸåŒæ­¥çš„å…³é”®ã€‚

**ä¸‰ä¸ªMerkleæ ¹çš„ä½œç”¨ï¼š**
- **State Root**: ä»£è¡¨æ‰€æœ‰è´¦æˆ·ä½™é¢ã€åˆçº¦å­˜å‚¨çš„å¿«ç…§ï¼Œæ”¹å˜ä»»ä½•è´¦æˆ·çŠ¶æ€éƒ½ä¼šæ”¹å˜è¿™ä¸ªæ ¹
- **Transactions Root**: ç”¨Merkle Treeç»„ç»‡æ‰€æœ‰äº¤æ˜“ï¼Œå¯ä»¥ç”¨O(log n)æ—¶é—´éªŒè¯æŸç¬”äº¤æ˜“æ˜¯å¦åœ¨åŒºå—ä¸­
- **Receipts Root**: è®°å½•æ‰€æœ‰äº¤æ˜“çš„æ‰§è¡Œç»“æœï¼ˆäº‹ä»¶æ—¥å¿—ã€Gasä½¿ç”¨ç­‰ï¼‰

**åœ¨åŒºå—é“¾å¼€å‘ä¸­çš„åº”ç”¨ï¼š**

å½“ä½ å¼€å‘DAppæ—¶ï¼Œå¯ä»¥é€šè¿‡ethers.jsè¯»å–åŒºå—ä¿¡æ¯ï¼š

```javascript
const { ethers } = require('ethers');
const provider = new ethers.JsonRpcProvider('https://eth.llamarpc.com');

// è·å–æœ€æ–°åŒºå—
const block = await provider.getBlock('latest');

console.log('åŒºå—å·:', block.number);
console.log('åŒºå—å“ˆå¸Œ:', block.hash);
console.log('çˆ¶åŒºå—å“ˆå¸Œ:', block.parentHash);
console.log('äº¤æ˜“æ•°é‡:', block.transactions.length);
console.log('æ—¶é—´æˆ³:', new Date(block.timestamp * 1000).toISOString());
```

---

### æ ¸å¿ƒæ¦‚å¿µ2ï¼šäº¤æ˜“ï¼ˆTransactionï¼‰ğŸ“

**ä¸€å¥è¯å®šä¹‰ï¼š** äº¤æ˜“æ˜¯ä»¥å¤ªåŠçŠ¶æ€æ”¹å˜çš„å”¯ä¸€æ–¹å¼ï¼ŒåŒ…å«å‘é€è€…ã€æ¥æ”¶è€…ã€é‡‘é¢ã€æ•°æ®å’ŒGasä¿¡æ¯ï¼Œé€šè¿‡æ•°å­—ç­¾åéªŒè¯èº«ä»½ã€‚

#### äº¤æ˜“ç»“æ„ï¼ˆType 2 - EIP-1559æ ‡å‡†ï¼‰ï¼š

```javascript
{
  // ===== èº«ä»½å­—æ®µ =====
  from: "0xAlice...",              // å‘é€è€…åœ°å€ï¼ˆç”±ç­¾åæ¨å¯¼ï¼‰
  to: "0xBob...",                  // æ¥æ”¶è€…åœ°å€ï¼ˆè½¬è´¦ï¼‰æˆ–åˆçº¦åœ°å€ï¼ˆåˆçº¦è°ƒç”¨ï¼‰

  // ===== ä»·å€¼å­—æ®µ =====
  value: "1000000000000000000",    // è½¬è´¦é‡‘é¢ï¼ˆå•ä½: Wei, 1 ETH = 10^18 Weiï¼‰

  // ===== Gaså­—æ®µ =====
  gasLimit: 21000,                 // æ„¿æ„æ”¯ä»˜çš„æœ€å¤§Gasæ•°é‡
  maxFeePerGas: "30000000000",     // æ¯å•ä½Gasçš„æœ€é«˜è´¹ç”¨ï¼ˆåŒ…å«Base Fee + Priority Feeï¼‰
  maxPriorityFeePerGas: "2000000000", // å°è´¹ï¼ˆç»™éªŒè¯è€…çš„å¥–åŠ±ï¼‰

  // ===== é˜²é‡æ”¾å­—æ®µ =====
  nonce: 5,                        // è´¦æˆ·äº¤æ˜“è®¡æ•°å™¨ï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰
  chainId: 1,                      // é“¾IDï¼ˆ1=ä»¥å¤ªåŠä¸»ç½‘ï¼Œé˜²æ­¢è·¨é“¾é‡æ”¾ï¼‰

  // ===== æ•°æ®å­—æ®µ =====
  data: "0x...",                   // åˆçº¦è°ƒç”¨æ•°æ®ï¼ˆè½¬è´¦æ—¶ä¸º0xï¼‰

  // ===== ç­¾åå­—æ®µ =====
  v: 27,                           // ç­¾åæ¢å¤ID
  r: "0x1234...",                  // ç­¾åçš„réƒ¨åˆ†
  s: "0x5678...",                  // ç­¾åçš„séƒ¨åˆ†

  // ===== äº¤æ˜“å“ˆå¸Œï¼ˆè®¡ç®—å¾—å‡ºï¼‰=====
  hash: Keccak256(RLPç¼–ç åçš„äº¤æ˜“æ•°æ®)
}
```

**è¯¦ç»†è§£é‡Šï¼š**

**Nonceçš„é‡è¦æ€§ï¼š**
Nonceæ˜¯è´¦æˆ·çš„äº¤æ˜“è®¡æ•°å™¨ï¼Œä»0å¼€å§‹ï¼Œæ¯å‘é€ä¸€ç¬”äº¤æ˜“+1ã€‚å®ƒé˜²æ­¢**é‡æ”¾æ”»å‡»**ï¼š

```javascript
// å‡è®¾Aliceç»™Bobè½¬è´¦1 ETH
äº¤æ˜“1: { from: Alice, to: Bob, value: 1 ETH, nonce: 0 }

// å¦‚æœæ²¡æœ‰nonceï¼Œæ¶æ„èŠ‚ç‚¹å¯ä»¥é‡å¤å¹¿æ’­è¿™ç¬”äº¤æ˜“
// æœ‰äº†nonceï¼ŒåŒæ ·çš„äº¤æ˜“æ— æ³•å†æ¬¡æ‰§è¡Œï¼ˆnonceå¿…é¡»é€’å¢ï¼‰
äº¤æ˜“2: { from: Alice, to: Bob, value: 1 ETH, nonce: 0 } âŒ è¢«æ‹’ç»
```

**Transaction Hash vs Block Hashï¼š**

- **Transaction Hash**: å¯¹å•ç¬”äº¤æ˜“çš„æ‰€æœ‰å­—æ®µè¿›è¡ŒKeccak256å“ˆå¸Œï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¿™ç¬”äº¤æ˜“
- **Block Hash**: å¯¹æ•´ä¸ªåŒºå—å¤´è¿›è¡ŒKeccak256å“ˆå¸Œï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¿™ä¸ªåŒºå—

```javascript
// äº¤æ˜“å“ˆå¸Œç¤ºä¾‹
const txHash = "0x123abc...";   // æŸ¥è¯¢å•ç¬”äº¤æ˜“ç”¨è¿™ä¸ªå“ˆå¸Œ

// åŒºå—å“ˆå¸Œç¤ºä¾‹
const blockHash = "0x456def..."; // æŸ¥è¯¢åŒºå—ç”¨è¿™ä¸ªå“ˆå¸Œ
```

**åœ¨DAppå¼€å‘ä¸­çš„åº”ç”¨ï¼š**

```javascript
// å‘é€äº¤æ˜“
const tx = await signer.sendTransaction({
  to: "0xRecipient...",
  value: ethers.parseEther("1.0"),
  gasLimit: 21000
});

// ç­‰å¾…äº¤æ˜“ç¡®è®¤
const receipt = await tx.wait();
console.log('äº¤æ˜“å“ˆå¸Œ:', receipt.hash);
console.log('åŒºå—å·:', receipt.blockNumber);
console.log('Gasä½¿ç”¨:', receipt.gasUsed.toString());
```

---

### æ ¸å¿ƒæ¦‚å¿µ3ï¼šå“ˆå¸Œå‡½æ•°ï¼ˆKeccak256ï¼‰ğŸ”

**ä¸€å¥è¯å®šä¹‰ï¼š** Keccak256æ˜¯ä»¥å¤ªåŠä½¿ç”¨çš„å“ˆå¸Œå‡½æ•°ï¼Œå°†ä»»æ„é•¿åº¦è¾“å…¥è½¬æ¢ä¸º256ä½å›ºå®šé•¿åº¦è¾“å‡ºï¼Œå…·æœ‰å•å‘æ€§ã€æŠ—ç¢°æ’æ€§å’Œé›ªå´©æ•ˆåº”ã€‚

#### Keccak256çš„æ ¸å¿ƒç‰¹æ€§ï¼š

```javascript
// ç¤ºä¾‹1ï¼šå›ºå®šé•¿åº¦è¾“å‡ºï¼ˆæ— è®ºè¾“å…¥å¤šé•¿ï¼Œè¾“å‡ºéƒ½æ˜¯256ä½=64ä¸ª16è¿›åˆ¶å­—ç¬¦ï¼‰
keccak256("Hello")
// â†’ 0x06b3dfaec148fb1bb2b066f10ec285e7c9bf402ab32aa78a5d38e34566810cd2

keccak256("Hello World! This is a much longer string...")
// â†’ 0x1c8aff950685c2ed4bc3174f3472287b56d9517b9c948127319a09a7a36deac8
// ä¾ç„¶æ˜¯64ä¸ª16è¿›åˆ¶å­—ç¬¦ï¼ˆ256ä½ï¼‰

// ç¤ºä¾‹2ï¼šé›ªå´©æ•ˆåº”ï¼ˆè¾“å…¥å¾®å°æ”¹å˜ï¼Œè¾“å‡ºå®Œå…¨ä¸åŒï¼‰
keccak256("Hello")
// â†’ 0x06b3dfaec148fb1bb2b066f10ec285e7c9bf402ab32aa78a5d38e34566810cd2

keccak256("hello")  // åªæ”¹äº†å¤§å°å†™
// â†’ 0x1c8aff950685c2ed4bc3174f3472287b56d9517b9c948127319a09a7a36deac8
// è¾“å‡ºå®Œå…¨ä¸åŒï¼

// ç¤ºä¾‹3ï¼šç¡®å®šæ€§ï¼ˆåŒæ ·çš„è¾“å…¥æ°¸è¿œäº§ç”ŸåŒæ ·çš„è¾“å‡ºï¼‰
keccak256("Ethereum") === keccak256("Ethereum")  // æ°¸è¿œä¸ºtrue
```

#### å››å¤§å¯†ç å­¦ç‰¹æ€§ï¼š

**1. ç¡®å®šæ€§ï¼ˆDeterministicï¼‰**
ç›¸åŒè¾“å…¥ â†’ ç›¸åŒè¾“å‡ºï¼ˆæ°¸è¿œï¼‰

**2. å•å‘æ€§/æŠ—åŸåƒæ”»å‡»ï¼ˆPreimage Resistanceï¼‰**
å·²çŸ¥ `hash(x) = y`ï¼Œæ— æ³•æ¨å¯¼å‡º `x`

```javascript
// ä½ çŸ¥é“å“ˆå¸Œå€¼æ˜¯ 0x06b3dfa...ï¼Œèƒ½æ¨å¯¼å‡ºåŸå§‹è¾“å…¥æ˜¯ "Hello" å—ï¼Ÿ
// ç­”æ¡ˆï¼šä¸èƒ½ï¼åªèƒ½æš´åŠ›å°è¯•æ‰€æœ‰å¯èƒ½
```

**3. æŠ—ç¢°æ’æ€§ï¼ˆCollision Resistanceï¼‰**
æ‰¾åˆ°ä¸¤ä¸ªä¸åŒè¾“å…¥ `x1 â‰  x2` ä½¿å¾— `hash(x1) = hash(x2)` åœ¨è®¡ç®—ä¸Šä¸å¯è¡Œ

```javascript
// ç†è®ºä¸Š2^256ç§å¯èƒ½ï¼Œæ‰¾åˆ°ç¢°æ’éœ€è¦å°è¯•2^128æ¬¡ï¼ˆå®‡å®™å¹´é¾„ä¸å¤Ÿï¼‰
```

**4. é›ªå´©æ•ˆåº”ï¼ˆAvalanche Effectï¼‰**
è¾“å…¥å¾®å°æ”¹å˜ â†’ è¾“å‡ºå®Œå…¨ä¸åŒï¼ˆçº¦50%çš„ä½ç¿»è½¬ï¼‰

**è¯¦ç»†è§£é‡Šï¼š**

Keccak256æ˜¯SHA-3æ ‡å‡†çš„ä¸€ä¸ªå˜ä½“ï¼ˆæ³¨æ„ï¼šKeccak256 â‰  SHA3-256ï¼Œä»¥å¤ªåŠä½¿ç”¨çš„æ˜¯NISTæ ‡å‡†åŒ–å‰çš„ç‰ˆæœ¬ï¼‰ã€‚

**Spongeæ„é€ ï¼š**
1. **Absorbing Phase**ï¼ˆå¸æ”¶é˜¶æ®µï¼‰ï¼šå°†è¾“å…¥æ•°æ®åˆ†å—ï¼Œé€å—"å¸æ”¶"åˆ°å†…éƒ¨çŠ¶æ€
2. **Squeezing Phase**ï¼ˆæŒ¤å‡ºé˜¶æ®µï¼‰ï¼šä»å†…éƒ¨çŠ¶æ€"æŒ¤å‡º"256ä½è¾“å‡º

**ä¸SHA-256çš„åŒºåˆ«ï¼š**
- **Bitcoin**ä½¿ç”¨SHA-256ï¼ˆåŒé‡å“ˆå¸Œï¼šSHA256(SHA256(data))ï¼‰
- **Ethereum**ä½¿ç”¨Keccak256ï¼ˆå•æ¬¡å“ˆå¸Œï¼‰
- Keccak256æŠ—é•¿åº¦æ‰©å±•æ”»å‡»ï¼ˆSHA-256å®¹æ˜“å—æ­¤æ”»å‡»ï¼‰

**åœ¨åŒºå—é“¾/æ™ºèƒ½åˆçº¦ä¸­çš„åº”ç”¨ï¼š**

```solidity
// Solidityä¸­ä½¿ç”¨Keccak256
pragma solidity ^0.8.0;

contract HashExample {
    // ç”¨é€”1ï¼šç”Ÿæˆå”¯ä¸€ID
    function generateId(address user, uint256 timestamp) public pure returns (bytes32) {
        return keccak256(abi.encodePacked(user, timestamp));
    }

    // ç”¨é€”2ï¼šéªŒè¯æ•°æ®å®Œæ•´æ€§
    function verifyData(string memory data, bytes32 expectedHash) public pure returns (bool) {
        return keccak256(bytes(data)) == expectedHash;
    }

    // ç”¨é€”3ï¼šåˆ›å»ºMerkle Treeï¼ˆéªŒè¯åŒ…å«æ€§ï¼‰
    function hashPair(bytes32 a, bytes32 b) public pure returns (bytes32) {
        return keccak256(abi.encodePacked(a < b ? a : b, a < b ? b : a));
    }
}
```

```javascript
// JavaScript/ethers.jsä¸­ä½¿ç”¨Keccak256
const { ethers } = require('ethers');

// ç”¨é€”1ï¼šè®¡ç®—åˆçº¦åœ°å€ï¼ˆç”±éƒ¨ç½²è€…åœ°å€+nonceæ¨å¯¼ï¼‰
const contractAddress = ethers.getCreateAddress({
  from: "0xDeployer...",
  nonce: 5
});

// ç”¨é€”2ï¼šè®¡ç®—å‡½æ•°é€‰æ‹©å™¨ï¼ˆå‰4å­—èŠ‚ï¼‰
const selector = ethers.id("transfer(address,uint256)").slice(0, 10);
// â†’ 0xa9059cbb (è¿™å°±æ˜¯ERC20 transferå‡½æ•°çš„é€‰æ‹©å™¨)

// ç”¨é€”3ï¼šéªŒè¯äº¤æ˜“æ•°æ®
const txHash = ethers.keccak256(ethers.toUtf8Bytes("transaction data"));
```

---

## 4. ã€æœ€å°å¯ç”¨ã€‘

æŒæ¡ä»¥ä¸‹å†…å®¹ï¼Œå°±èƒ½ç†è§£åŒºå—é“¾åŸºæœ¬åŸç†å¹¶å¼€å‘åŸºç¡€DAppï¼š

### 4.1 åŒºå—æ˜¯æ‰¹é‡æ‰“åŒ…äº¤æ˜“çš„å®¹å™¨

**æ ¸å¿ƒè¦ç‚¹ï¼š**
- æ¯ä¸ªåŒºå—åŒ…å«å¤šç¬”äº¤æ˜“ï¼ˆä»¥å¤ªåŠå¹³å‡æ¯å—150-300ç¬”ï¼‰
- åŒºå—æœ‰å›ºå®šæ—¶é—´é—´éš”ï¼ˆä»¥å¤ªåŠPoSåæ˜¯12ç§’/å—ï¼‰
- åŒºå—å¤´åŒ…å«3ä¸ªé‡è¦çš„Merkleæ ¹ï¼šçŠ¶æ€æ ¹ã€äº¤æ˜“æ ¹ã€æ”¶æ®æ ¹

**å®é™…åº”ç”¨ï¼š**
```javascript
// DAppå¼€å‘æ—¶ï¼ŒæŸ¥è¯¢åŒºå—ä¿¡æ¯
const block = await provider.getBlock(blockNumber);
console.log(`åŒºå— ${block.number} åŒ…å« ${block.transactions.length} ç¬”äº¤æ˜“`);
```

---

### 4.2 å“ˆå¸Œæ˜¯æ•°æ®çš„å”¯ä¸€æŒ‡çº¹

**æ ¸å¿ƒè¦ç‚¹ï¼š**
- ä»»ä½•æ•°æ®æ”¹åŠ¨éƒ½ä¼šå¯¼è‡´å“ˆå¸Œå®Œå…¨ä¸åŒ
- æ— æ³•ä»å“ˆå¸Œåæ¨åŸå§‹æ•°æ®
- ç”¨äºå¿«é€ŸéªŒè¯æ•°æ®å®Œæ•´æ€§

**å®é™…åº”ç”¨ï¼š**
```javascript
// éªŒè¯äº¤æ˜“æ˜¯å¦è¢«ç¯¡æ”¹
const originalTxHash = receipt.hash;
const currentTxHash = ethers.keccak256(ethers.toUtf8Bytes(transactionData));
if (originalTxHash !== currentTxHash) {
  console.log("äº¤æ˜“æ•°æ®è¢«ç¯¡æ”¹ï¼");
}
```

---

### 4.3 Parent Hashå½¢æˆä¸å¯ç¯¡æ”¹çš„é“¾

**æ ¸å¿ƒè¦ç‚¹ï¼š**
- æ¯ä¸ªåŒºå—åŒ…å«ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œï¼ˆparent hashï¼‰
- ç¯¡æ”¹å†å²åŒºå—ä¼šå¯¼è‡´åç»­æ‰€æœ‰åŒºå—å“ˆå¸Œå¤±æ•ˆ
- è¿™å°±æ˜¯"åŒºå—é“¾"åç§°çš„ç”±æ¥

**å®é™…åº”ç”¨ï¼š**
```javascript
// éªŒè¯åŒºå—é“¾è¿ç»­æ€§
const block1 = await provider.getBlock(100);
const block2 = await provider.getBlock(101);
console.log(block2.parentHash === block1.hash); // true
```

---

### 4.4 äº¤æ˜“é€šè¿‡nonceé˜²é‡æ”¾

**æ ¸å¿ƒè¦ç‚¹ï¼š**
- æ¯ä¸ªè´¦æˆ·æœ‰nonceè®¡æ•°å™¨ï¼ˆä»0å¼€å§‹ï¼‰
- å‘é€äº¤æ˜“æ—¶å¿…é¡»ä½¿ç”¨æ­£ç¡®çš„nonceï¼ˆå½“å‰nonceå€¼ï¼‰
- nonceå¿…é¡»è¿ç»­é€’å¢ï¼ˆä¸èƒ½è·³è¿‡ï¼‰

**å®é™…åº”ç”¨ï¼š**
```javascript
// è·å–è´¦æˆ·å½“å‰nonce
const nonce = await provider.getTransactionCount(address);

// å‘é€äº¤æ˜“æ—¶æŒ‡å®šnonce
const tx = await signer.sendTransaction({
  to: recipient,
  value: ethers.parseEther("1.0"),
  nonce: nonce  // å¿…é¡»æ­£ç¡®ï¼Œå¦åˆ™äº¤æ˜“å¡ä½
});
```

---

### 4.5 äº¤æ˜“å“ˆå¸Œæ˜¯äº¤æ˜“çš„å”¯ä¸€æ ‡è¯†ç¬¦

**æ ¸å¿ƒè¦ç‚¹ï¼š**
- äº¤æ˜“å‘é€åç«‹å³è¿”å›äº¤æ˜“å“ˆå¸Œï¼ˆtxHashï¼‰
- å¯ä»¥ç”¨txHashæŸ¥è¯¢äº¤æ˜“çŠ¶æ€å’Œæ”¶æ®
- äº¤æ˜“å“ˆå¸Œåœ¨å…¨ç½‘å”¯ä¸€

**å®é™…åº”ç”¨ï¼š**
```javascript
// å‘é€äº¤æ˜“
const tx = await signer.sendTransaction({...});
console.log("äº¤æ˜“å“ˆå¸Œ:", tx.hash);

// ç”¨å“ˆå¸ŒæŸ¥è¯¢äº¤æ˜“çŠ¶æ€
const receipt = await provider.getTransactionReceipt(tx.hash);
console.log("äº¤æ˜“çŠ¶æ€:", receipt.status === 1 ? "æˆåŠŸ" : "å¤±è´¥");
```

---

**è¿™äº›çŸ¥è¯†è¶³ä»¥ï¼š**
- âœ… ç†è§£åŒºå—é“¾çš„"é“¾"ç»“æ„å’Œä¸å¯ç¯¡æ”¹æ€§
- âœ… ç¼–å†™DAppæ—¶æ­£ç¡®å¤„ç†äº¤æ˜“å‘é€å’Œç¡®è®¤
- âœ… ä½¿ç”¨åŒºå—æµè§ˆå™¨ï¼ˆEtherscanï¼‰æŸ¥è¯¢åŒºå—å’Œäº¤æ˜“
- âœ… ç†è§£ä¸ºä»€ä¹ˆéœ€è¦ç­‰å¾…å¤šä¸ªåŒºå—ç¡®è®¤ï¼ˆé˜²æ­¢é“¾é‡ç»„ï¼‰
- âœ… ä¸ºå­¦ä¹ æ™ºèƒ½åˆçº¦ã€Merkle Treeã€çŠ¶æ€ç®¡ç†æ‰“ä¸‹åŸºç¡€

---

## 5. ã€1ä¸ªç±»æ¯”ã€‘

### ç±»æ¯”1ï¼šåŒºå— ğŸ§±

#### ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼šåŒºå— = è´¦æœ¬çš„ä¸€é¡µ

æƒ³è±¡ä½ åœ¨è®°å½•ç­çº§çš„é›¶é£ŸåŸºé‡‘è´¦æœ¬ï¼š

**ä¼ ç»Ÿçº¸è´¨è´¦æœ¬ï¼š**
- æ¯ä¸€é¡µè®°å½•å½“å¤©çš„æ‰€æœ‰äº¤æ˜“ï¼ˆå°æ˜ä¹°äº†è–¯ç‰‡-5å…ƒï¼Œå°çº¢å……å€¼+10å…ƒ...ï¼‰
- æ¯ä¸€é¡µåº•éƒ¨å†™ä¸Šæ—¥æœŸå’Œé¡µç 
- æ¯ä¸€é¡µé¡¶éƒ¨å†™ä¸Š"ä¸Šä¸€é¡µçš„æ ¡éªŒç "ï¼ˆä¸Šä¸€é¡µæ‰€æœ‰äº¤æ˜“é‡‘é¢çš„æ€»å’Œï¼‰

**å¯¹åº”åŒºå—é“¾ï¼š**
- **ä¸€é¡µ = ä¸€ä¸ªåŒºå—**
- **è¿™ä¸€é¡µçš„äº¤æ˜“ = åŒºå—ä½“ï¼ˆtransactionsï¼‰**
- **é¡µç  = åŒºå—å·ï¼ˆblock numberï¼‰**
- **æ—¥æœŸ = æ—¶é—´æˆ³ï¼ˆtimestampï¼‰**
- **ä¸Šä¸€é¡µæ ¡éªŒç  = çˆ¶åŒºå—å“ˆå¸Œï¼ˆparent hashï¼‰**
- **è¿™ä¸€é¡µçš„å”¯ä¸€æŒ‡çº¹ = åŒºå—å“ˆå¸Œï¼ˆblock hashï¼‰**

**ä¸¾ä¾‹ï¼š**

å‡è®¾ç¬¬3é¡µè´¦æœ¬è®°å½•ï¼š
```
ç¬¬3é¡µ (2024-01-15)
ä¸Šä¸€é¡µæ ¡éªŒç : 152å…ƒ

äº¤æ˜“1: å°æ˜ä¹°è–¯ç‰‡ -5å…ƒ
äº¤æ˜“2: å°çº¢å……å€¼ +10å…ƒ
äº¤æ˜“3: å°åˆšä¹°å¯ä¹ -3å…ƒ

æœ¬é¡µæ ¡éªŒç : 154å…ƒ
æœ¬é¡µæŒ‡çº¹: "ç¬¬3é¡µ-2024-01-15-ä¸Šé¡µ152-æœ¬é¡µ154" â†’ ç”Ÿæˆå”¯ä¸€ç¼–å· #ABC123
```

å¦‚æœæœ‰äººæƒ³ç¯¡æ”¹ç¬¬3é¡µï¼ˆæŠŠå°æ˜çš„-5å…ƒæ”¹æˆ-50å…ƒï¼‰ï¼š
1. æœ¬é¡µæŒ‡çº¹ä¼šå˜ï¼š#ABC123 â†’ #XYZ789
2. ç¬¬4é¡µè®°å½•çš„"ä¸Šä¸€é¡µæ ¡éªŒç "ä»æ˜¯#ABC123
3. **éªŒè¯å¤±è´¥ï¼** æ‰€æœ‰äººéƒ½èƒ½å‘ç°ç¬¬3é¡µè¢«ç¯¡æ”¹äº†

---

#### å‰ç«¯é¢†åŸŸç±»æ¯”ï¼šåŒºå— = Git Commit

å¦‚æœä½ ç†Ÿæ‚‰Gitï¼ŒåŒºå—å°±æ˜¯**ä¸å¯å˜çš„commit**ï¼š

```bash
# Gitå†å²
commit abc123 (HEAD -> main)
Author: Alice
Date: 2024-01-15
Parent: def456

    Added transfer function
    Modified 3 files

commit def456
Author: Bob
Date: 2024-01-14
Parent: 789abc

    Initial contract setup
```

**å¯¹åº”å…³ç³»ï¼š**

| åŒºå—é“¾æ¦‚å¿µ | Gitæ¦‚å¿µ | è¯´æ˜ |
|----------|---------|------|
| åŒºå—å·ï¼ˆBlock Numberï¼‰ | Commitåºå· | é¡ºåºé€’å¢ |
| åŒºå—å“ˆå¸Œï¼ˆBlock Hashï¼‰ | Commit Hash (SHA-1) | å”¯ä¸€æ ‡è¯†ç¬¦ |
| çˆ¶åŒºå—å“ˆå¸Œï¼ˆParent Hashï¼‰ | Parent Commit | é“¾æ¥ä¸Šä¸€ä¸ªcommit |
| äº¤æ˜“åˆ—è¡¨ï¼ˆTransactionsï¼‰ | æ–‡ä»¶ä¿®æ”¹ï¼ˆChangesï¼‰ | è¿™ä¸ªcommitåŒ…å«çš„ä¿®æ”¹ |
| æ—¶é—´æˆ³ï¼ˆTimestampï¼‰ | Commit Date | åˆ›å»ºæ—¶é—´ |
| åŒºå—é“¾ï¼ˆBlockchainï¼‰ | Git History | åªèƒ½appendï¼Œä¸èƒ½ä¿®æ”¹å†å² |

**ä»£ç ç¤ºä¾‹ï¼š**

```javascript
// Gitçš„commitå†å² vs åŒºå—é“¾çš„åŒºå—é“¾æ¥
class GitCommit {
  constructor(changes, parentHash) {
    this.changes = changes;           // å¯¹åº”äº¤æ˜“åˆ—è¡¨
    this.parentHash = parentHash;     // å¯¹åº”çˆ¶åŒºå—å“ˆå¸Œ
    this.timestamp = Date.now();
    this.hash = this.calculateHash(); // å¯¹åº”åŒºå—å“ˆå¸Œ
  }

  calculateHash() {
    const data = this.parentHash + JSON.stringify(this.changes) + this.timestamp;
    return sha1(data); // Gitç”¨SHA-1ï¼Œä»¥å¤ªåŠç”¨Keccak256
  }
}

// ä»¥å¤ªåŠçš„åŒºå—ç»“æ„
class Block {
  constructor(transactions, parentHash) {
    this.transactions = transactions;   // å¯¹åº”Gitçš„changes
    this.parentHash = parentHash;       // å¯¹åº”Gitçš„parent commit
    this.timestamp = Date.now();
    this.hash = this.calculateHash();   // å¯¹åº”Gitçš„commit hash
  }

  calculateHash() {
    const data = this.parentHash + JSON.stringify(this.transactions) + this.timestamp;
    return keccak256(data); // ä»¥å¤ªåŠç”¨Keccak256
  }
}
```

**ä¸ºä»€ä¹ˆè¿™ä¸ªç±»æ¯”å‡†ç¡®ï¼Ÿ**

1. **åªèƒ½è¿½åŠ ï¼Œä¸èƒ½ä¿®æ”¹**ï¼šGitå†å²å’ŒåŒºå—é“¾éƒ½ä¸èƒ½ä¿®æ”¹å·²æœ‰çš„commit/åŒºå—ï¼ˆå¼ºåˆ¶ä¿®æ”¹ä¼šå¯¼è‡´hashå˜åŒ–ï¼‰
2. **é€šè¿‡hashé“¾æ¥**ï¼šæ¯ä¸ªcommit/åŒºå—éƒ½å¼•ç”¨ä¸Šä¸€ä¸ªçš„hash
3. **åˆ†å¸ƒå¼å…±è¯†**ï¼šå¤šäººåä½œçš„Gitä»“åº“éœ€è¦åè°ƒå†²çªï¼Œç±»ä¼¼åŒºå—é“¾çš„å…±è¯†æœºåˆ¶
4. **å®Œæ•´æ€§éªŒè¯**ï¼šæ”¹å˜ä»»ä½•å†å²commitä¼šå¯¼è‡´åç»­æ‰€æœ‰commitçš„hashå¤±æ•ˆ

---

### ç±»æ¯”2ï¼šäº¤æ˜“å“ˆå¸Œ ğŸ”–

#### ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼šäº¤æ˜“å“ˆå¸Œ = å¿«é€’å•å·

ä½ åœ¨ç½‘ä¸Šä¹°äº†ä¸€æœ¬ä¹¦ï¼š

**ä¸‹å•åï¼š**
- å•†å®¶ç»™ä½ ä¸€ä¸ª**å¿«é€’å•å·**ï¼šSF1234567890
- è¿™ä¸ªå•å·æ˜¯å…¨å›½å”¯ä¸€çš„ï¼ˆä¸ä¼šé‡å¤ï¼‰
- ä½ å¯ä»¥éšæ—¶ç”¨è¿™ä¸ªå•å·æŸ¥è¯¢åŒ…è£¹çŠ¶æ€

**å¯¹åº”äº¤æ˜“å“ˆå¸Œï¼š**
- **å¿«é€’å•å· = äº¤æ˜“å“ˆå¸Œï¼ˆTransaction Hashï¼‰**
- **åŒ…è£¹å†…å®¹ = äº¤æ˜“æ•°æ®ï¼ˆfrom, to, value, data...ï¼‰**
- **ç‰©æµçŠ¶æ€ = äº¤æ˜“çŠ¶æ€ï¼ˆpending, confirmed, failedï¼‰**
- **å¿«é€’è¿½è¸ªç½‘ç«™ = åŒºå—æµè§ˆå™¨ï¼ˆEtherscanï¼‰**

**ä¸¾ä¾‹ï¼š**

```javascript
// å‘é€ä»¥å¤ªåŠäº¤æ˜“ â†’ è·å¾—äº¤æ˜“å“ˆå¸Œ
const tx = await signer.sendTransaction({
  to: "0xBob...",
  value: ethers.parseEther("1.0")
});

// äº¤æ˜“å“ˆå¸Œç±»ä¼¼å¿«é€’å•å·
console.log("äº¤æ˜“å“ˆå¸Œ:", tx.hash);
// â†’ 0x1234abcd5678ef90...ï¼ˆè¿™æ˜¯ä½ çš„"å¿«é€’å•å·"ï¼‰

// ç”¨"å•å·"æŸ¥è¯¢çŠ¶æ€
const receipt = await provider.getTransactionReceipt(tx.hash);
console.log("äº¤æ˜“çŠ¶æ€:", receipt.status === 1 ? "å·²é€è¾¾" : "é…é€å¤±è´¥");
console.log("ç¡®è®¤åŒºå—:", receipt.blockNumber); // "å·²ç­¾æ”¶çš„å¿«é€’ç«™"
```

---

#### å‰ç«¯é¢†åŸŸç±»æ¯”ï¼šäº¤æ˜“å“ˆå¸Œ = HTTPè¯·æ±‚çš„Request ID

å¦‚æœä½ å¼€å‘è¿‡APIï¼Œäº¤æ˜“å“ˆå¸Œç±»ä¼¼**è¯·æ±‚è¿½è¸ªID**ï¼š

```javascript
// å‰ç«¯å‘é€APIè¯·æ±‚
const response = await fetch('/api/transfer', {
  method: 'POST',
  headers: {
    'X-Request-ID': 'req_abc123xyz',  // è¯·æ±‚IDï¼ˆç±»æ¯”äº¤æ˜“å“ˆå¸Œï¼‰
  },
  body: JSON.stringify({
    from: 'Alice',
    to: 'Bob',
    amount: 100
  })
});

// åç«¯æ—¥å¿—
console.log(`[req_abc123xyz] å¤„ç†ä¸­...`);
console.log(`[req_abc123xyz] å·²å®Œæˆ`);

// ç”¨Request IDæŸ¥è¯¢è¯·æ±‚çŠ¶æ€
const status = await fetch(`/api/requests/req_abc123xyz/status`);
```

**å¯¹åº”å…³ç³»ï¼š**

```javascript
// HTTP Request ID vs äº¤æ˜“å“ˆå¸Œ
class ApiRequest {
  constructor(data) {
    this.data = data;
    this.requestId = generateUUID();    // ç±»ä¼¼äº¤æ˜“å“ˆå¸Œ
    this.timestamp = Date.now();
    this.status = 'pending';            // pending â†’ processing â†’ completed
  }

  async getStatus() {
    return fetch(`/api/requests/${this.requestId}/status`);
  }
}

// Ethereum Transaction
class Transaction {
  constructor(data) {
    this.data = data;
    this.hash = keccak256(rlp.encode(data)); // äº¤æ˜“å“ˆå¸Œ
    this.timestamp = Date.now();
    this.status = 'pending';                 // pending â†’ mined â†’ confirmed
  }

  async getReceipt() {
    return provider.getTransactionReceipt(this.hash);
  }
}
```

---

### ç±»æ¯”3ï¼šParent Hashé“¾æ¥ â›“ï¸

#### ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼šParent Hash = é˜²ä¼ªå°æ¡

æƒ³è±¡ä¸€æœ¬éœ€è¦é˜²ç¯¡æ”¹çš„é‡è¦æ–‡ä»¶ï¼ˆå¦‚é—å˜±ã€åˆåŒï¼‰ï¼š

**ä¼ ç»Ÿé˜²ç¯¡æ”¹æ–¹æ³•ï¼š**
- ç¬¬1é¡µç­¾ååï¼Œç”¨å°æ¡å°ä½ï¼ˆå°æ¡ä¸Šå†™"ç¬¬1é¡µæŒ‡çº¹ï¼šABC"ï¼‰
- ç¬¬2é¡µå†™åœ¨å°æ¡ä¸Šæ–¹ï¼Œå†ç”¨æ–°å°æ¡å°ä½ï¼ˆå°æ¡ä¸Šå†™"ç¬¬2é¡µæŒ‡çº¹ï¼šDEFï¼Œä¸Šä¸€é¡µï¼šABC"ï¼‰
- ç¬¬3é¡µå†™åœ¨å°æ¡ä¸Šæ–¹ï¼Œå†å°ä½ï¼ˆå°æ¡ä¸Šå†™"ç¬¬3é¡µæŒ‡çº¹ï¼šGHIï¼Œä¸Šä¸€é¡µï¼šDEF"ï¼‰

**å¦‚æœæœ‰äººæƒ³ç¯¡æ”¹ç¬¬1é¡µï¼š**
1. æ’•å¼€ç¬¬1é¡µçš„å°æ¡ï¼Œä¿®æ”¹å†…å®¹
2. ç¬¬1é¡µçš„æ–°æŒ‡çº¹å˜æˆXYZï¼ˆä¸å†æ˜¯ABCï¼‰
3. ä½†ç¬¬2é¡µçš„å°æ¡ä»å†™ç€"ä¸Šä¸€é¡µï¼šABC"
4. **éªŒè¯å¤±è´¥ï¼** ç¬¬2é¡µçš„å°æ¡ä¸ç¬¬1é¡µçš„æ–°æŒ‡çº¹ä¸åŒ¹é…

**å¯¹åº”åŒºå—é“¾ï¼š**
- **å°æ¡ = åŒºå—å“ˆå¸Œ**
- **å°æ¡ä¸Šçš„"ä¸Šä¸€é¡µ" = çˆ¶åŒºå—å“ˆå¸Œï¼ˆparent hashï¼‰**
- **æŒ‡çº¹ = Keccak256å“ˆå¸Œ**

---

#### å‰ç«¯é¢†åŸŸç±»æ¯”ï¼šParent Hash = Gitçš„Parent Commit

```javascript
// Gitå†å²çš„é“¾å¼ç»“æ„
const commits = [
  {
    hash: "abc123",
    parent: null,          // ç¬¬ä¸€ä¸ªcommitï¼Œæ²¡æœ‰parent
    message: "Initial commit"
  },
  {
    hash: "def456",
    parent: "abc123",      // æŒ‡å‘ä¸Šä¸€ä¸ªcommit
    message: "Add feature"
  },
  {
    hash: "ghi789",
    parent: "def456",      // æŒ‡å‘ä¸Šä¸€ä¸ªcommit
    message: "Fix bug"
  }
];

// éªŒè¯é“¾çš„å®Œæ•´æ€§
function verifyChain(commits) {
  for (let i = 1; i < commits.length; i++) {
    if (commits[i].parent !== commits[i-1].hash) {
      console.log(`é“¾æ–­è£‚ï¼åŒºå—${i}çš„parent hashä¸åŒ¹é…`);
      return false;
    }
  }
  return true;
}
```

**ä»¥å¤ªåŠåŒºå—é“¾çš„é“¾å¼ç»“æ„ï¼š**

```javascript
// ä»¥å¤ªåŠåŒºå—çš„é“¾å¼ç»“æ„
const blocks = [
  {
    number: 1,
    hash: "0xabc123...",
    parentHash: "0x000000...",  // åˆ›ä¸–åŒºå—ï¼Œparentæ˜¯0
    transactions: [...]
  },
  {
    number: 2,
    hash: "0xdef456...",
    parentHash: "0xabc123...",  // æŒ‡å‘åŒºå—1çš„å“ˆå¸Œ
    transactions: [...]
  },
  {
    number: 3,
    hash: "0xghi789...",
    parentHash: "0xdef456...",  // æŒ‡å‘åŒºå—2çš„å“ˆå¸Œ
    transactions: [...]
  }
];

// éªŒè¯åŒºå—é“¾å®Œæ•´æ€§
async function verifyBlockchain(startBlock, endBlock) {
  for (let i = startBlock + 1; i <= endBlock; i++) {
    const currentBlock = await provider.getBlock(i);
    const parentBlock = await provider.getBlock(i - 1);

    if (currentBlock.parentHash !== parentBlock.hash) {
      console.log(`åŒºå—é“¾éªŒè¯å¤±è´¥ï¼åŒºå—${i}çš„parentHashä¸åŒ¹é…`);
      return false;
    }
  }
  console.log(`åŒºå— ${startBlock} åˆ° ${endBlock} éªŒè¯é€šè¿‡`);
  return true;
}
```

---

### ç±»æ¯”æ€»ç»“è¡¨

| åŒºå—é“¾æ¦‚å¿µ | ç”Ÿæ´»åœºæ™¯ç±»æ¯” | å‰ç«¯é¢†åŸŸç±»æ¯” | æ ¸å¿ƒç›¸ä¼¼æ€§ |
|-----------|-------------|-------------|-----------|
| **åŒºå—ï¼ˆBlockï¼‰** | è´¦æœ¬çš„ä¸€é¡µ | Git Commit | æ‰¹é‡è®°å½•ï¼Œä¸å¯ä¿®æ”¹ |
| **åŒºå—å“ˆå¸Œï¼ˆBlock Hashï¼‰** | é¡µé¢æŒ‡çº¹/ç¼–å· | Commit Hash | å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå†…å®¹æ‘˜è¦ |
| **çˆ¶åŒºå—å“ˆå¸Œï¼ˆParent Hashï¼‰** | "ä¸Šä¸€é¡µç¼–å·"å­—æ®µ | Parent Commit Hash | é“¾æ¥ä¸Šä¸€ä¸ªè®°å½• |
| **åŒºå—é“¾ï¼ˆBlockchainï¼‰** | è£…è®¢æˆå†Œçš„è´¦æœ¬ | Git History | åªèƒ½è¿½åŠ ï¼Œä¸èƒ½ä¿®æ”¹å†å² |
| **äº¤æ˜“ï¼ˆTransactionï¼‰** | è´¦æœ¬ä¸­çš„ä¸€æ¡è®°å½• | APIè¯·æ±‚ | çŠ¶æ€æ”¹å˜çš„æœ€å°å•å…ƒ |
| **äº¤æ˜“å“ˆå¸Œï¼ˆTx Hashï¼‰** | å¿«é€’å•å· | HTTP Request ID | å”¯ä¸€è¿½è¸ªæ ‡è¯†ç¬¦ |
| **Keccak256å“ˆå¸Œ** | èº«ä»½è¯å·/æŒ‡çº¹ | æ–‡ä»¶MD5 | å†…å®¹æ”¹å˜â†’å“ˆå¸Œæ”¹å˜ |
| **Merkle Tree** | å®¶æ—æ—è°±æ ‘ | DOMæ ‘ | å¿«é€ŸéªŒè¯åŒ…å«å…³ç³» |
| **Nonce** | å‘ç¥¨æµæ°´å· | è‡ªå¢ID | é˜²æ­¢é‡å¤æ‰§è¡Œ |

---

## 6. ã€åç›´è§‰ç‚¹ã€‘

### è¯¯åŒº1ï¼šåŒºå—é“¾æ˜¯ä¸€ä¸ª"é“¾è¡¨"æ•°æ®ç»“æ„ âŒ

**ä¸ºä»€ä¹ˆé”™ï¼Ÿ**

å¾ˆå¤šäººå¬åˆ°"é“¾"å°±è®¤ä¸ºåŒºå—é“¾æ˜¯ä¼ ç»Ÿçš„é“¾è¡¨ï¼ˆLinked Listï¼‰ï¼Œä½†å®é™…ä¸Šï¼š

- **ä¼ ç»Ÿé“¾è¡¨**ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ‰æŒ‡å‘**ä¸‹ä¸€ä¸ªèŠ‚ç‚¹**çš„æŒ‡é’ˆ (`next pointer`)
- **åŒºå—é“¾**ï¼šæ¯ä¸ªåŒºå—æœ‰æŒ‡å‘**ä¸Šä¸€ä¸ªåŒºå—**çš„å“ˆå¸Œ (`parent hash`)

```javascript
// âŒ é”™è¯¯ç†è§£ï¼šä¼ ç»Ÿé“¾è¡¨
class LinkedListNode {
  constructor(data) {
    this.data = data;
    this.next = null;  // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
  }
}

// âœ… æ­£ç¡®ç†è§£ï¼šåŒºå—é“¾
class Block {
  constructor(data, parentHash) {
    this.data = data;
    this.parentHash = parentHash;  // æŒ‡å‘ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œï¼ˆåå‘é“¾æ¥ï¼‰
    this.hash = this.calculateHash();
  }
}
```

æ›´å‡†ç¡®çš„è¯´æ³•ï¼š
- åŒºå—é“¾æ˜¯**åå‘é“¾è¡¨**ï¼ˆæŒ‡é’ˆæŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼‰
- åŒºå—é“¾ä½¿ç”¨**å“ˆå¸ŒæŒ‡é’ˆ**ï¼ˆä¸æ˜¯å†…å­˜åœ°å€ï¼Œè€Œæ˜¯å¯†ç å­¦å“ˆå¸Œï¼‰
- åŒºå—é“¾æ˜¯**ä¸å¯å˜**çš„ï¼ˆé“¾è¡¨å¯ä»¥ä¿®æ”¹èŠ‚ç‚¹ï¼‰

**ä¸ºä»€ä¹ˆäººä»¬å®¹æ˜“è¿™æ ·é”™ï¼Ÿ**

å› ä¸º"åŒºå—é“¾"çš„ä¸­æ–‡ç¿»è¯‘å®¹æ˜“è®©äººè”æƒ³åˆ°æ•°æ®ç»“æ„ä¸­çš„"é“¾è¡¨"ï¼Œä½†è‹±æ–‡"Blockchain"çš„"chain"æ›´å¼ºè°ƒ"é“¾æ¡"ï¼ˆäº’ç›¸é“¾æ¥ï¼‰è€Œé"é“¾è¡¨"ï¼ˆæ•°æ®ç»“æ„ï¼‰ã€‚

**æ­£ç¡®ç†è§£ï¼š**

```javascript
// åŒºå—é“¾çš„çœŸå®ç»“æ„
Block 1000 (hash: 0xAAA, parentHash: 0x000) â† åˆ›ä¸–åŒºå—
          â†‘ (Block 1001çš„parentHashæŒ‡å‘è¿™é‡Œ)
Block 1001 (hash: 0xBBB, parentHash: 0xAAA)
          â†‘ (Block 1002çš„parentHashæŒ‡å‘è¿™é‡Œ)
Block 1002 (hash: 0xCCC, parentHash: 0xBBB)

// éªŒè¯æ–¹å‘ï¼šä»æ–°åˆ°æ—§ï¼ˆæ²¿ç€parentHashåå‘éªŒè¯ï¼‰
// æ–°åŒºå—ç”Ÿæˆæ–¹å‘ï¼šä»æ—§åˆ°æ–°ï¼ˆä¸æ–­è¿½åŠ æ–°åŒºå—ï¼‰
```

---

### è¯¯åŒº2ï¼šä¿®æ”¹å†å²åŒºå—ä¼šå¯¼è‡´"æ•´æ¡é“¾"é‡æ–°è®¡ç®— âŒ

**ä¸ºä»€ä¹ˆé”™ï¼Ÿ**

å¾ˆå¤šäººè®¤ä¸ºï¼šå¦‚æœç¯¡æ”¹äº†ç¬¬100å·åŒºå—ï¼Œé‚£ä¹ˆç¬¬101ã€102...ç›´åˆ°æœ€æ–°åŒºå—çš„å“ˆå¸Œéƒ½éœ€è¦é‡æ–°è®¡ç®—ã€‚

**å®é™…æƒ…å†µï¼š**

- **åªæœ‰è¢«ç¯¡æ”¹åŒºå—åŠå…¶æ‰€æœ‰åç»­åŒºå—çš„å“ˆå¸Œéœ€è¦é‡æ–°è®¡ç®—**
- **ä½†æ˜¯**ï¼Œåœ¨PoWï¼ˆå·¥ä½œé‡è¯æ˜ï¼‰å…±è¯†ä¸‹ï¼Œé‡æ–°è®¡ç®—æ¯ä¸ªåŒºå—éœ€è¦è§£å‡ºPoWéš¾é¢˜ï¼ˆå¹³å‡10åˆ†é’Ÿ/å—ï¼Œå¯¹æ¯”ç‰¹å¸è€Œè¨€ï¼‰
- **åœ¨PoSï¼ˆæƒç›Šè¯æ˜ï¼‰ä¸‹ï¼Œé‡æ–°åˆ›å»ºåŒºå—éœ€è¦æŒæœ‰è¶³å¤Ÿçš„è´¨æŠ¼æƒç›Šå¹¶è¢«é€‰ä¸ºéªŒè¯è€…

**ä¸ºä»€ä¹ˆäººä»¬å®¹æ˜“è¿™æ ·é”™ï¼Ÿ**

å› ä¸ºæ•™ç§‘ä¹¦å¸¸è¯´"ç¯¡æ”¹å†å²åŒºå—ä¼šå¯¼è‡´åç»­æ‰€æœ‰åŒºå—å“ˆå¸Œå¤±æ•ˆ"ï¼Œä½†æ²¡æœ‰è¯´æ˜**é‡æ–°è®¡ç®—å“ˆå¸Œæœ¬èº«å¾ˆå®¹æ˜“ï¼Œéš¾çš„æ˜¯é‡æ–°äº§ç”Ÿæœ‰æ•ˆçš„å…±è¯†è¯æ˜**ã€‚

**æ­£ç¡®ç†è§£ï¼š**

```javascript
// ç¯¡æ”¹åŒºå—çš„çœŸå®æˆæœ¬
function tamperBlock(blockNumber) {
  // æ­¥éª¤1ï¼šä¿®æ”¹åŒºå—å†…å®¹ï¼ˆå¾ˆå®¹æ˜“ï¼‰
  blocks[blockNumber].transactions.push(fakeTransaction);

  // æ­¥éª¤2ï¼šé‡æ–°è®¡ç®—è¿™ä¸ªåŒºå—çš„å“ˆå¸Œï¼ˆå¾ˆå®¹æ˜“ï¼Œæ¯«ç§’çº§ï¼‰
  blocks[blockNumber].hash = keccak256(blocks[blockNumber]);

  // æ­¥éª¤3ï¼šæ›´æ–°åç»­åŒºå—çš„parentHashï¼ˆå¾ˆå®¹æ˜“ï¼‰
  for (let i = blockNumber + 1; i < blocks.length; i++) {
    blocks[i].parentHash = blocks[i-1].hash;
    blocks[i].hash = keccak256(blocks[i]);
  }

  // âŒ ä½†æ˜¯ï¼šæ²¡æœ‰æœ‰æ•ˆçš„å…±è¯†è¯æ˜ï¼ˆPoWæˆ–PoSï¼‰
  // - PoWï¼šéœ€è¦é‡æ–°æŒ–çŸ¿ï¼Œæ‰¾åˆ°æ»¡è¶³éš¾åº¦çš„nonceï¼ˆæå…¶è€—æ—¶ï¼‰
  // - PoSï¼šéœ€è¦æŒæœ‰è¶³å¤Ÿçš„è´¨æŠ¼ETHå¹¶è¢«é€‰ä¸ºéªŒè¯è€…ï¼ˆéœ€è¦å¤§é‡èµ„é‡‘ï¼‰

  // ç»“æœï¼šä½ çš„ç¯¡æ”¹é“¾ä¼šè¢«ç½‘ç»œæ‹’ç»ï¼ˆå…¶ä»–èŠ‚ç‚¹ä¸æ‰¿è®¤ï¼‰
}
```

**åœ¨æ¯”ç‰¹å¸ï¼ˆPoWï¼‰ä¸‹ç¯¡æ”¹ç¬¬100å·åŒºå—çš„æˆæœ¬ï¼š**

```javascript
// å‡è®¾å½“å‰æœ€æ–°åŒºå—æ˜¯ç¬¬1000å·
// ä½ æƒ³ç¯¡æ”¹ç¬¬100å·åŒºå—

const blocksToRemine = 1000 - 100; // éœ€è¦é‡æ–°æŒ–900ä¸ªåŒºå—
const avgMiningTime = 10 * 60;     // æ¯”ç‰¹å¸å¹³å‡10åˆ†é’Ÿ/å—

const totalTime = blocksToRemine * avgMiningTime / 3600;
// â†’ éœ€è¦150å°æ—¶ï¼ˆ6.25å¤©ï¼‰

// è€Œä¸”åœ¨è¿™6.25å¤©é‡Œï¼Œè¯šå®çŸ¿å·¥åˆæŒ–å‡ºäº†æ–°åŒºå—
// ä½ éœ€è¦çš„ç®—åŠ› > å…¨ç½‘51%æ‰èƒ½è¿½ä¸Šè¯šå®é“¾
```

**åœ¨ä»¥å¤ªåŠï¼ˆPoSï¼‰ä¸‹ç¯¡æ”¹çš„æˆæœ¬ï¼š**

éœ€è¦æ§åˆ¶è¶…è¿‡å…¨ç½‘66.7%çš„è´¨æŠ¼ETHï¼ˆçº¦æ•°ç™¾äº¿ç¾å…ƒï¼‰ï¼Œä¸”å³ä½¿æˆåŠŸï¼Œåè®®å¯ä»¥é€šè¿‡ç¤¾ä¼šå…±è¯†å›æ»šï¼ˆç¡¬åˆ†å‰ï¼‰ã€‚

---

### è¯¯åŒº3ï¼šäº¤æ˜“å“ˆå¸Œå’ŒåŒºå—å“ˆå¸Œæ˜¯åŒä¸€ä¸ªä¸œè¥¿ âŒ

**ä¸ºä»€ä¹ˆé”™ï¼Ÿ**

å¾ˆå¤šåˆå­¦è€…æ··æ·†è¿™ä¸¤ä¸ªæ¦‚å¿µï¼š

- **äº¤æ˜“å“ˆå¸Œï¼ˆTransaction Hashï¼‰**ï¼šå¯¹**å•ç¬”äº¤æ˜“æ•°æ®**è¿›è¡Œå“ˆå¸Œï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¿™ç¬”äº¤æ˜“
- **åŒºå—å“ˆå¸Œï¼ˆBlock Hashï¼‰**ï¼šå¯¹**æ•´ä¸ªåŒºå—å¤´**è¿›è¡Œå“ˆå¸Œï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¿™ä¸ªåŒºå—

```javascript
// âŒ é”™è¯¯ç†è§£
const tx = await signer.sendTransaction({...});
console.log(tx.hash); // 0xabc123...ï¼ˆäº¤æ˜“å“ˆå¸Œï¼‰

// è¿™ä¸ªå“ˆå¸Œä¸æ˜¯åŒºå—å“ˆå¸Œï¼
// äº¤æ˜“è¿˜æ²¡è¢«æ‰“åŒ…è¿›åŒºå—ï¼Œå“ªæ¥çš„åŒºå—å“ˆå¸Œï¼Ÿ
```

**ä¸ºä»€ä¹ˆäººä»¬å®¹æ˜“è¿™æ ·é”™ï¼Ÿ**

å› ä¸ºä¸¤è€…éƒ½æ˜¯"å“ˆå¸Œ"ï¼Œä¸”éƒ½åœ¨åŒºå—æµè§ˆå™¨ä¸Šæ˜¾ç¤ºï¼Œå®¹æ˜“æ··æ·†ã€‚

**æ­£ç¡®ç†è§£ï¼š**

```javascript
// å‘é€äº¤æ˜“
const tx = await signer.sendTransaction({
  to: "0xBob...",
  value: ethers.parseEther("1.0")
});

// 1. ç«‹å³è¿”å›äº¤æ˜“å“ˆå¸Œï¼ˆæ­¤æ—¶äº¤æ˜“è¿˜åœ¨å†…å­˜æ± ï¼Œæœªä¸Šé“¾ï¼‰
console.log("äº¤æ˜“å“ˆå¸Œ (Tx Hash):", tx.hash);
// â†’ 0x1234abcd...ï¼ˆå”¯ä¸€æ ‡è¯†è¿™ç¬”äº¤æ˜“ï¼‰

// 2. ç­‰å¾…äº¤æ˜“è¢«æ‰“åŒ…è¿›åŒºå—
const receipt = await tx.wait();

// 3. ç°åœ¨å¯ä»¥çœ‹åˆ°åŒºå—å“ˆå¸Œï¼ˆäº¤æ˜“å·²è¢«æ‰“åŒ…ï¼‰
console.log("åŒºå—å“ˆå¸Œ (Block Hash):", receipt.blockHash);
// â†’ 0x5678efgh...ï¼ˆå”¯ä¸€æ ‡è¯†åŒ…å«è¿™ç¬”äº¤æ˜“çš„åŒºå—ï¼‰

console.log("åŒºå—å· (Block Number):", receipt.blockNumber);
// â†’ 18234567ï¼ˆåŒºå—é«˜åº¦ï¼‰
```

**ä¸¤è€…çš„è®¡ç®—æ–¹å¼ï¼š**

```javascript
// äº¤æ˜“å“ˆå¸Œ = Keccak256(RLPç¼–ç çš„äº¤æ˜“æ•°æ®)
const txHash = keccak256(rlp.encode({
  nonce: 5,
  gasPrice: 30000000000,
  gasLimit: 21000,
  to: "0xBob...",
  value: 1000000000000000000,
  data: "0x",
  v: 27, r: "0x...", s: "0x..."
}));

// åŒºå—å“ˆå¸Œ = Keccak256(RLPç¼–ç çš„åŒºå—å¤´)
const blockHash = keccak256(rlp.encode({
  parentHash: "0x...",
  stateRoot: "0x...",
  transactionsRoot: "0x...",  // æ³¨æ„ï¼šè¿™æ˜¯æ‰€æœ‰äº¤æ˜“çš„Merkleæ ¹ï¼Œä¸æ˜¯å•ä¸ªäº¤æ˜“å“ˆå¸Œ
  receiptsRoot: "0x...",
  timestamp: 1625097600,
  number: 12345678,
  // ... å…¶ä»–Headerå­—æ®µ
}));
```

**åœ¨Etherscanä¸Šçš„åŒºåˆ«ï¼š**

```
äº¤æ˜“è¯¦æƒ…é¡µé¢:
  - Transaction Hash: 0x1234abcd...  â† ç‚¹å‡»è¿™ä¸ªå¯ä»¥æŸ¥çœ‹è¿™ç¬”äº¤æ˜“
  - Block: 18234567                   â† è¿™ç¬”äº¤æ˜“è¢«æ‰“åŒ…åœ¨å“ªä¸ªåŒºå—
  - Block Hash: 0x5678efgh...         â† ç‚¹å‡»è¿™ä¸ªå¯ä»¥æŸ¥çœ‹æ•´ä¸ªåŒºå—çš„æ‰€æœ‰äº¤æ˜“

åŒºå—è¯¦æƒ…é¡µé¢:
  - Block Hash: 0x5678efgh...         â† è¿™ä¸ªåŒºå—çš„å“ˆå¸Œ
  - Transactions: 150 transactions     â† è¿™ä¸ªåŒºå—åŒ…å«150ç¬”äº¤æ˜“
    - Tx Hash #1: 0x1234abcd...
    - Tx Hash #2: 0xaabbccdd...
    - ...
```

---

## 7. ã€å®æˆ˜ä»£ç ã€‘

### åŸºç¡€å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼šJavaScriptæ¨¡æ‹ŸåŒºå—é“¾

```javascript
// ===== 1. å¯¼å…¥ä¾èµ– =====
const crypto = require('crypto');

// ç®€åŒ–ç‰ˆKeccak256ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ç”¨ ethers.js çš„å®ç°ï¼‰
function keccak256(data) {
  return crypto.createHash('sha256').update(data).digest('hex');
}

// ===== 2. äº¤æ˜“ç±» =====
class Transaction {
  constructor(from, to, value) {
    this.from = from;
    this.to = to;
    this.value = value;
    this.timestamp = Date.now();
  }

  // è®¡ç®—äº¤æ˜“å“ˆå¸Œ
  calculateHash() {
    const data = this.from + this.to + this.value + this.timestamp;
    return keccak256(data);
  }
}

// ===== 3. åŒºå—ç±» =====
class Block {
  constructor(index, transactions, previousHash = '') {
    this.index = index;               // åŒºå—å·
    this.timestamp = Date.now();      // æ—¶é—´æˆ³
    this.transactions = transactions; // äº¤æ˜“åˆ—è¡¨
    this.previousHash = previousHash; // çˆ¶åŒºå—å“ˆå¸Œ
    this.hash = this.calculateHash(); // æœ¬åŒºå—å“ˆå¸Œ
  }

  // è®¡ç®—åŒºå—å“ˆå¸Œï¼ˆç®€åŒ–ç‰ˆï¼Œå®é™…ä»¥å¤ªåŠä½¿ç”¨RLPç¼–ç ï¼‰
  calculateHash() {
    const data =
      this.index +
      this.previousHash +
      this.timestamp +
      JSON.stringify(this.transactions);
    return keccak256(data);
  }
}

// ===== 4. åŒºå—é“¾ç±» =====
class Blockchain {
  constructor() {
    this.chain = [this.createGenesisBlock()];
  }

  // åˆ›å»ºåˆ›ä¸–åŒºå—ï¼ˆç¬¬ä¸€ä¸ªåŒºå—ï¼‰
  createGenesisBlock() {
    return new Block(0, [], '0');
  }

  // è·å–æœ€æ–°åŒºå—
  getLatestBlock() {
    return this.chain[this.chain.length - 1];
  }

  // æ·»åŠ æ–°åŒºå—
  addBlock(transactions) {
    const previousBlock = this.getLatestBlock();
    const newBlock = new Block(
      previousBlock.index + 1,
      transactions,
      previousBlock.hash  // é“¾æ¥åˆ°ä¸Šä¸€ä¸ªåŒºå—
    );
    this.chain.push(newBlock);
    return newBlock;
  }

  // éªŒè¯åŒºå—é“¾å®Œæ•´æ€§
  isChainValid() {
    for (let i = 1; i < this.chain.length; i++) {
      const currentBlock = this.chain[i];
      const previousBlock = this.chain[i - 1];

      // æ£€æŸ¥1ï¼šå½“å‰åŒºå—å“ˆå¸Œæ˜¯å¦æ­£ç¡®
      if (currentBlock.hash !== currentBlock.calculateHash()) {
        console.log(`åŒºå—${i}çš„å“ˆå¸Œä¸åŒ¹é…`);
        return false;
      }

      // æ£€æŸ¥2ï¼šæ˜¯å¦æ­£ç¡®é“¾æ¥åˆ°ä¸Šä¸€ä¸ªåŒºå—
      if (currentBlock.previousHash !== previousBlock.hash) {
        console.log(`åŒºå—${i}çš„previousHashä¸åŒ¹é…`);
        return false;
      }
    }

    return true;
  }

  // æ‰“å°åŒºå—é“¾
  printChain() {
    console.log('\n========== åŒºå—é“¾çŠ¶æ€ ==========');
    this.chain.forEach(block => {
      console.log(`\nåŒºå— #${block.index}`);
      console.log(`æ—¶é—´æˆ³: ${new Date(block.timestamp).toISOString()}`);
      console.log(`äº¤æ˜“æ•°é‡: ${block.transactions.length}`);
      console.log(`çˆ¶åŒºå—å“ˆå¸Œ: ${block.previousHash.substring(0, 10)}...`);
      console.log(`åŒºå—å“ˆå¸Œ: ${block.hash.substring(0, 10)}...`);
    });
    console.log('\n================================\n');
  }
}

// ===== 5. åœºæ™¯æ¼”ç¤º =====

console.log("=== åœºæ™¯1ï¼šåˆ›å»ºåŒºå—é“¾å¹¶æ·»åŠ åŒºå— ===\n");

// åˆ›å»ºåŒºå—é“¾
const myBlockchain = new Blockchain();

// æ·»åŠ ç¬¬ä¸€æ‰¹äº¤æ˜“
const tx1 = new Transaction('Alice', 'Bob', 50);
const tx2 = new Transaction('Bob', 'Charlie', 25);
myBlockchain.addBlock([tx1, tx2]);

// æ·»åŠ ç¬¬äºŒæ‰¹äº¤æ˜“
const tx3 = new Transaction('Charlie', 'David', 10);
myBlockchain.addBlock([tx3]);

// æ‰“å°åŒºå—é“¾
myBlockchain.printChain();

// éªŒè¯åŒºå—é“¾
console.log("åŒºå—é“¾æ˜¯å¦æœ‰æ•ˆï¼Ÿ", myBlockchain.isChainValid()); // true

// ===== 6. åœºæ™¯2ï¼šå°è¯•ç¯¡æ”¹åŒºå— =====

console.log("\n=== åœºæ™¯2ï¼šå°è¯•ç¯¡æ”¹å†å²åŒºå— ===\n");

// ç¯¡æ”¹ç¬¬1å·åŒºå—çš„äº¤æ˜“
console.log("ç¯¡æ”¹å‰çš„åŒºå—1å“ˆå¸Œ:", myBlockchain.chain[1].hash.substring(0, 10) + "...");

myBlockchain.chain[1].transactions[0].value = 5000; // Alice â†’ Bob æ”¹æˆ5000

console.log("ç¯¡æ”¹åçš„åŒºå—1å“ˆå¸Œ:", myBlockchain.chain[1].hash.substring(0, 10) + "...");
console.log("ï¼ˆæ³¨æ„ï¼šå“ˆå¸Œæ²¡æœ‰è‡ªåŠ¨æ›´æ–°ï¼Œå› ä¸ºæˆ‘ä»¬ç›´æ¥ä¿®æ”¹äº†å¯¹è±¡ï¼‰");

console.log("\néªŒè¯åŒºå—é“¾å®Œæ•´æ€§:");
console.log("åŒºå—é“¾æ˜¯å¦æœ‰æ•ˆï¼Ÿ", myBlockchain.isChainValid()); // false

console.log("\nåŸå› ï¼šåŒºå—1çš„å®é™…å†…å®¹è¢«æ”¹äº†ï¼Œä½†å“ˆå¸Œè¿˜æ˜¯æ—§çš„");
console.log("è¿™å°±æ˜¯åŒºå—é“¾é˜²ç¯¡æ”¹çš„åŸç†ï¼šä»»ä½•ä¿®æ”¹éƒ½èƒ½è¢«æ£€æµ‹åˆ°ï¼");

// ===== 7. åœºæ™¯3ï¼šæ¼”ç¤ºParent Hashé“¾æ¥ =====

console.log("\n=== åœºæ™¯3ï¼šéªŒè¯Parent Hashé“¾æ¥ ===\n");

// é‡æ–°åˆ›å»ºå¹²å‡€çš„åŒºå—é“¾
const cleanChain = new Blockchain();
cleanChain.addBlock([new Transaction('A', 'B', 100)]);
cleanChain.addBlock([new Transaction('B', 'C', 50)]);
cleanChain.addBlock([new Transaction('C', 'D', 25)]);

// æ˜¾ç¤ºé“¾æ¥å…³ç³»
console.log("åŒºå—é“¾æ¥å…³ç³»:");
for (let i = 0; i < cleanChain.chain.length; i++) {
  const block = cleanChain.chain[i];
  console.log(`åŒºå—${i}: hash=${block.hash.substring(0, 8)}... parentHash=${block.previousHash.substring(0, 8)}...`);

  if (i > 0) {
    const parentBlock = cleanChain.chain[i - 1];
    const isLinked = (block.previousHash === parentBlock.hash);
    console.log(`  â†’ ${isLinked ? 'âœ…' : 'âŒ'} æ­£ç¡®é“¾æ¥åˆ°åŒºå—${i-1}`);
  }
}
```

**è¿è¡Œè¾“å‡ºç¤ºä¾‹ï¼š**

```
=== åœºæ™¯1ï¼šåˆ›å»ºåŒºå—é“¾å¹¶æ·»åŠ åŒºå— ===

========== åŒºå—é“¾çŠ¶æ€ ==========

åŒºå— #0
æ—¶é—´æˆ³: 2024-01-15T10:30:00.000Z
äº¤æ˜“æ•°é‡: 0
çˆ¶åŒºå—å“ˆå¸Œ: 0...
åŒºå—å“ˆå¸Œ: a1b2c3d4e5...

åŒºå— #1
æ—¶é—´æˆ³: 2024-01-15T10:30:01.234Z
äº¤æ˜“æ•°é‡: 2
çˆ¶åŒºå—å“ˆå¸Œ: a1b2c3d4e5...
åŒºå—å“ˆå¸Œ: f6g7h8i9j0...

åŒºå— #2
æ—¶é—´æˆ³: 2024-01-15T10:30:02.456Z
äº¤æ˜“æ•°é‡: 1
çˆ¶åŒºå—å“ˆå¸Œ: f6g7h8i9j0...
åŒºå—å“ˆå¸Œ: k1l2m3n4o5...

================================

åŒºå—é“¾æ˜¯å¦æœ‰æ•ˆï¼Ÿ true

=== åœºæ™¯2ï¼šå°è¯•ç¯¡æ”¹å†å²åŒºå— ===

ç¯¡æ”¹å‰çš„åŒºå—1å“ˆå¸Œ: f6g7h8i9j0...
ç¯¡æ”¹åçš„åŒºå—1å“ˆå¸Œ: f6g7h8i9j0...
ï¼ˆæ³¨æ„ï¼šå“ˆå¸Œæ²¡æœ‰è‡ªåŠ¨æ›´æ–°ï¼Œå› ä¸ºæˆ‘ä»¬ç›´æ¥ä¿®æ”¹äº†å¯¹è±¡ï¼‰

éªŒè¯åŒºå—é“¾å®Œæ•´æ€§:
åŒºå—é“¾æ˜¯å¦æœ‰æ•ˆï¼Ÿ false

åŸå› ï¼šåŒºå—1çš„å®é™…å†…å®¹è¢«æ”¹äº†ï¼Œä½†å“ˆå¸Œè¿˜æ˜¯æ—§çš„
è¿™å°±æ˜¯åŒºå—é“¾é˜²ç¯¡æ”¹çš„åŸç†ï¼šä»»ä½•ä¿®æ”¹éƒ½èƒ½è¢«æ£€æµ‹åˆ°ï¼
```

---

### è¿›é˜¶ï¼šçœŸå®ä»¥å¤ªåŠåŒºå—æŸ¥è¯¢ï¼ˆethers.jsï¼‰

```javascript
// ===== 1. å®‰è£…ä¾èµ– =====
// npm install ethers

const { ethers } = require('ethers');

// ===== 2. è¿æ¥ä»¥å¤ªåŠä¸»ç½‘ =====
const provider = new ethers.JsonRpcProvider('https://eth.llamarpc.com');

// ===== 3. æŸ¥è¯¢æœ€æ–°åŒºå—ä¿¡æ¯ =====
async function exploreLatestBlock() {
  console.log("=== æŸ¥è¯¢æœ€æ–°åŒºå— ===\n");

  // è·å–æœ€æ–°åŒºå—å·
  const latestBlockNumber = await provider.getBlockNumber();
  console.log(`æœ€æ–°åŒºå—å·: ${latestBlockNumber}`);

  // è·å–æœ€æ–°åŒºå—è¯¦æƒ…
  const block = await provider.getBlock(latestBlockNumber);

  console.log(`\nåŒºå—è¯¦æƒ…:`);
  console.log(`  åŒºå—å“ˆå¸Œ: ${block.hash}`);
  console.log(`  çˆ¶åŒºå—å“ˆå¸Œ: ${block.parentHash}`);
  console.log(`  æ—¶é—´æˆ³: ${new Date(block.timestamp * 1000).toISOString()}`);
  console.log(`  äº¤æ˜“æ•°é‡: ${block.transactions.length}`);
  console.log(`  Gasä½¿ç”¨: ${block.gasUsed.toString()}`);
  console.log(`  Gasä¸Šé™: ${block.gasLimit.toString()}`);
  console.log(`  çŸ¿å·¥/éªŒè¯è€…: ${block.miner}`);

  // éªŒè¯Parent Hashé“¾æ¥
  console.log(`\néªŒè¯é“¾æ¥å…³ç³»:`);
  const parentBlock = await provider.getBlock(latestBlockNumber - 1);
  const isLinked = (block.parentHash === parentBlock.hash);
  console.log(`  åŒºå—${latestBlockNumber}çš„parentHash: ${block.parentHash.substring(0, 10)}...`);
  console.log(`  åŒºå—${latestBlockNumber - 1}çš„hash:        ${parentBlock.hash.substring(0, 10)}...`);
  console.log(`  ${isLinked ? 'âœ…' : 'âŒ'} æ­£ç¡®é“¾æ¥`);
}

// ===== 4. æŸ¥è¯¢ç‰¹å®šäº¤æ˜“ =====
async function exploreTransaction(txHash) {
  console.log(`\n=== æŸ¥è¯¢äº¤æ˜“ ${txHash.substring(0, 10)}... ===\n`);

  // è·å–äº¤æ˜“è¯¦æƒ…
  const tx = await provider.getTransaction(txHash);

  console.log(`äº¤æ˜“è¯¦æƒ…:`);
  console.log(`  äº¤æ˜“å“ˆå¸Œ: ${tx.hash}`);
  console.log(`  ä»: ${tx.from}`);
  console.log(`  åˆ°: ${tx.to}`);
  console.log(`  é‡‘é¢: ${ethers.formatEther(tx.value)} ETH`);
  console.log(`  Nonce: ${tx.nonce}`);
  console.log(`  Gas Limit: ${tx.gasLimit.toString()}`);

  // è·å–äº¤æ˜“æ”¶æ®
  const receipt = await provider.getTransactionReceipt(txHash);

  console.log(`\näº¤æ˜“æ”¶æ®:`);
  console.log(`  åŒºå—å·: ${receipt.blockNumber}`);
  console.log(`  åŒºå—å“ˆå¸Œ: ${receipt.blockHash}`);
  console.log(`  Gasä½¿ç”¨: ${receipt.gasUsed.toString()}`);
  console.log(`  çŠ¶æ€: ${receipt.status === 1 ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'}`);
}

// ===== 5. éªŒè¯åŒºå—é“¾è¿ç»­æ€§ =====
async function verifyBlockchainIntegrity(startBlock, endBlock) {
  console.log(`\n=== éªŒè¯åŒºå— ${startBlock} åˆ° ${endBlock} çš„é“¾æ¥ ===\n`);

  for (let i = startBlock + 1; i <= endBlock; i++) {
    const currentBlock = await provider.getBlock(i);
    const parentBlock = await provider.getBlock(i - 1);

    const isLinked = (currentBlock.parentHash === parentBlock.hash);

    if (!isLinked) {
      console.log(`âŒ åŒºå—${i}é“¾æ¥æ–­è£‚ï¼`);
      return false;
    }

    console.log(`âœ… åŒºå—${i} â†’ åŒºå—${i-1} (${currentBlock.parentHash.substring(0, 10)}...)`);
  }

  console.log(`\næ‰€æœ‰åŒºå—é“¾æ¥æ­£å¸¸ï¼`);
  return true;
}

// ===== 6. è¿è¡Œç¤ºä¾‹ =====
(async () => {
  try {
    // æŸ¥è¯¢æœ€æ–°åŒºå—
    await exploreLatestBlock();

    // éªŒè¯æœ€è¿‘10ä¸ªåŒºå—çš„è¿ç»­æ€§
    const latestBlockNumber = await provider.getBlockNumber();
    await verifyBlockchainIntegrity(latestBlockNumber - 10, latestBlockNumber);

  } catch (error) {
    console.error("é”™è¯¯:", error);
  }
})();
```

---

## 8. ã€é¢è¯•å¿…é—®ã€‘

### é—®é¢˜1ï¼š"è¯·è§£é‡ŠåŒºå—ã€äº¤æ˜“å’Œå“ˆå¸Œä¹‹é—´çš„å…³ç³»"

**æ™®é€šå›ç­”ï¼ˆâŒ ä¸å‡ºå½©ï¼‰ï¼š**

"åŒºå—åŒ…å«äº¤æ˜“ï¼Œå“ˆå¸Œç”¨æ¥éªŒè¯æ•°æ®ã€‚æ¯ä¸ªåŒºå—éƒ½æœ‰å“ˆå¸Œå€¼ï¼Œé€šè¿‡å“ˆå¸ŒæŠŠåŒºå—é“¾æ¥èµ·æ¥ã€‚"

**å‡ºå½©å›ç­”ï¼ˆâœ… æ¨èï¼‰ï¼š**

> **åŒºå—ã€äº¤æ˜“ã€å“ˆå¸Œä¸‰è€…æ„æˆäº†åŒºå—é“¾çš„æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œå®ƒä»¬çš„å…³ç³»å¯ä»¥ä»ä¸‰ä¸ªå±‚é¢ç†è§£ï¼š**
>
> **1. æ•°æ®ç»„ç»‡å±‚é¢**ï¼š
> - äº¤æ˜“æ˜¯åŒºå—é“¾çŠ¶æ€æ”¹å˜çš„æœ€å°å•å…ƒï¼ˆå¦‚Alice â†’ Bob 1 ETHï¼‰
> - åŒºå—æ˜¯äº¤æ˜“çš„æ‰¹é‡å®¹å™¨ï¼Œå°†å¤šç¬”äº¤æ˜“æ‰“åŒ…æˆä¸€ä¸ªæ•°æ®å—ï¼ˆå¦‚ä¸€ä¸ªåŒºå—åŒ…å«150-300ç¬”äº¤æ˜“ï¼‰
> - å“ˆå¸Œå‡½æ•°ï¼ˆKeccak256ï¼‰å°†åŒºå—æ•°æ®å‹ç¼©æˆ256ä½æŒ‡çº¹ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†
>
> **2. å®Œæ•´æ€§éªŒè¯å±‚é¢**ï¼š
> - ä»¥å¤ªåŠä½¿ç”¨ä¸‰ä¸ªMerkleæ ¹ï¼ˆState Root, Transactions Root, Receipts Rootï¼‰æ¥é«˜æ•ˆéªŒè¯æ•°æ®
> - Transactions Rootæ˜¯æ‰€æœ‰äº¤æ˜“çš„Merkleæ ‘æ ¹ï¼Œå¯ä»¥ç”¨O(log n)æ—¶é—´éªŒè¯æŸç¬”äº¤æ˜“æ˜¯å¦åœ¨åŒºå—ä¸­
> - åŒºå—å“ˆå¸Œæ˜¯å¯¹æ•´ä¸ªåŒºå—å¤´ï¼ˆåŒ…å«ä¸‰ä¸ªMerkleæ ¹ï¼‰çš„Keccak256å“ˆå¸Œï¼Œä»»ä½•æ•°æ®æ”¹åŠ¨éƒ½ä¼šå¯¼è‡´å“ˆå¸Œå®Œå…¨ä¸åŒ
>
> **3. é“¾å¼ç»“æ„å±‚é¢**ï¼š
> - æ¯ä¸ªåŒºå—çš„HeaderåŒ…å«çˆ¶åŒºå—å“ˆå¸Œï¼ˆparent hashï¼‰ï¼ŒæŒ‡å‘ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼
> - è¿™ç§é“¾å¼ç»“æ„ä¿è¯äº†ä¸å¯ç¯¡æ”¹æ€§ï¼šä¿®æ”¹å†å²åŒºå—ä¼šå¯¼è‡´å…¶å“ˆå¸Œæ”¹å˜ï¼Œåç»­æ‰€æœ‰åŒºå—çš„parent hashéªŒè¯å¤±è´¥
> - ä»åˆ›ä¸–åŒºå—åˆ°æœ€æ–°åŒºå—å½¢æˆä¸€æ¡å®Œæ•´çš„å“ˆå¸Œé“¾ï¼Œè¿™å°±æ˜¯"åŒºå—é“¾"åç§°çš„ç”±æ¥
>
> **ä¸æ¯”ç‰¹å¸çš„å…³é”®åŒºåˆ«**ï¼š
> - æ¯”ç‰¹å¸ä½¿ç”¨SHA-256åŒé‡å“ˆå¸Œï¼Œä»¥å¤ªåŠä½¿ç”¨Keccak256å•æ¬¡å“ˆå¸Œ
> - ä»¥å¤ªåŠæœ‰ä¸‰ä¸ªMerkleæ ¹ï¼ˆçŠ¶æ€/äº¤æ˜“/æ”¶æ®ï¼‰ï¼Œæ¯”ç‰¹å¸åªæœ‰äº¤æ˜“Merkleæ ¹
> - ä»¥å¤ªåŠçš„çŠ¶æ€æ ¹ä½¿å¾—è½»å®¢æˆ·ç«¯å¯ä»¥éªŒè¯è´¦æˆ·ä½™é¢è€Œæ— éœ€ä¸‹è½½æ‰€æœ‰äº¤æ˜“
>
> **åœ¨å®é™…DAppå¼€å‘ä¸­çš„åº”ç”¨**ï¼š
> - å‘é€äº¤æ˜“åç«‹å³å¾—åˆ°äº¤æ˜“å“ˆå¸Œï¼ˆtxHashï¼‰ï¼Œå¯ä»¥ç”¨å®ƒè¿½è¸ªäº¤æ˜“çŠ¶æ€
> - äº¤æ˜“è¢«æ‰“åŒ…åä¼šæœ‰åŒºå—å“ˆå¸Œï¼ˆblockHashï¼‰å’ŒåŒºå—å·ï¼ˆblockNumberï¼‰
> - é€šè¿‡éªŒè¯parent hashé“¾æ¥ï¼Œå¯ä»¥ç¡®è®¤äº¤æ˜“çš„æœ€ç»ˆæ€§ï¼ˆé€šå¸¸ç­‰å¾…12ä¸ªåŒºå—ç¡®è®¤ï¼‰

**ä¸ºä»€ä¹ˆè¿™ä¸ªå›ç­”å‡ºå½©ï¼Ÿ**
1. âœ… åˆ†å±‚æ¬¡è§£é‡Šï¼ˆæ•°æ®ç»„ç»‡ã€å®Œæ•´æ€§éªŒè¯ã€é“¾å¼ç»“æ„ï¼‰ï¼Œå±•ç¤ºæ·±åº¦ç†è§£
2. âœ… æåˆ°äº†å…³é”®æŠ€æœ¯ç»†èŠ‚ï¼ˆMerkle Treeã€ä¸‰ä¸ªæ ¹ã€Keccak256ï¼‰
3. âœ… å¯¹æ¯”äº†ä¸æ¯”ç‰¹å¸çš„åŒºåˆ«ï¼Œå±•ç¤ºæ¨ªå‘çŸ¥è¯†
4. âœ… è”ç³»åˆ°å®é™…DAppå¼€å‘ï¼Œå±•ç¤ºå®æˆ˜èƒ½åŠ›

---

### é—®é¢˜2ï¼š"å¦‚æœæˆ‘ç¯¡æ”¹äº†ç¬¬100å·åŒºå—çš„äº¤æ˜“ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"

**æ™®é€šå›ç­”ï¼ˆâŒ ä¸å‡ºå½©ï¼‰ï¼š**

"åé¢æ‰€æœ‰åŒºå—çš„å“ˆå¸Œéƒ½ä¼šå˜ï¼Œæ‰€ä»¥åŒºå—é“¾ä¼šæ£€æµ‹åˆ°ç¯¡æ”¹ï¼Œäº¤æ˜“ä¼šå¤±è´¥ã€‚"

**å‡ºå½©å›ç­”ï¼ˆâœ… æ¨èï¼‰ï¼š**

> **ç¯¡æ”¹å†å²åŒºå—ä¼šè§¦å‘ä¸€ç³»åˆ—éªŒè¯å¤±è´¥ï¼Œå…·ä½“åˆ†ä¸‰ä¸ªé˜¶æ®µï¼š**
>
> **é˜¶æ®µ1ï¼šæœ¬åœ°ç¯¡æ”¹ï¼ˆæŠ€æœ¯ä¸Šå¾ˆå®¹æ˜“ï¼‰**
> - ä¿®æ”¹ç¬¬100å·åŒºå—çš„äº¤æ˜“æ•°æ®ï¼ˆå¦‚æŠŠ1 ETHæ”¹æˆ1000 ETHï¼‰
> - é‡æ–°è®¡ç®—ç¬¬100å·åŒºå—çš„å“ˆå¸Œï¼ˆæ¯«ç§’çº§ï¼Œå› ä¸ºKeccak256è®¡ç®—å¾ˆå¿«ï¼‰
> - æ›´æ–°ç¬¬101å·åŒºå—çš„parent hashå­—æ®µ
> - é€’å½’æ›´æ–°102ã€103...ç›´åˆ°æœ€æ–°åŒºå—çš„parent hash
>
> **é˜¶æ®µ2ï¼šå…±è¯†éªŒè¯å¤±è´¥ï¼ˆå…³é”®éšœç¢ï¼‰**
> - åœ¨PoSä»¥å¤ªåŠä¸­ï¼Œæ¯ä¸ªåŒºå—éœ€è¦è¢«éšæœºé€‰ä¸­çš„éªŒè¯è€…ç­¾å
> - ä½ ç¯¡æ”¹çš„åŒºå—ç¼ºå°‘æœ‰æ•ˆçš„éªŒè¯è€…ç­¾åï¼Œå…¶ä»–èŠ‚ç‚¹ä¼šæ‹’ç»
> - è¦é€šè¿‡éªŒè¯ï¼Œéœ€è¦æ§åˆ¶è¶…è¿‡å…¨ç½‘2/3çš„è´¨æŠ¼ETHï¼ˆçº¦æ•°ç™¾äº¿ç¾å…ƒï¼‰
> - å³ä½¿ä½ æœ‰è¿™ä¹ˆå¤šèµ„é‡‘ï¼Œåè®®å¯ä»¥é€šè¿‡ç¤¾ä¼šå…±è¯†ç¡¬åˆ†å‰å›æ»š
>
> **é˜¶æ®µ3ï¼šç½‘ç»œå…±è¯†ï¼ˆæœ€ç»ˆä¿éšœï¼‰**
> - ä»¥å¤ªåŠä½¿ç”¨"æœ€é•¿é“¾è§„åˆ™"ï¼ˆå®é™…æ˜¯æœ€é‡é“¾ï¼Œç´¯è®¡éš¾åº¦æœ€å¤§ï¼‰
> - ä½ çš„ç¯¡æ”¹é“¾ä¼šè¢«ç½‘ç»œè®¤ä¸ºæ˜¯"åˆ†å‰é“¾"
> - ç”±äºä½ çš„ç®—åŠ›/è´¨æŠ¼ä¸è¶³ï¼Œè¯šå®é“¾ä¼šç»§ç»­å¢é•¿å¹¶è¶…è¿‡ä½ çš„é“¾
> - æœ€ç»ˆç½‘ç»œä¼šä¸¢å¼ƒä½ çš„ç¯¡æ”¹é“¾ï¼Œé‡‡ç”¨è¯šå®é“¾
>
> **å…·ä½“æˆæœ¬ä¼°ç®—ï¼ˆä»¥å¤ªåŠPoSï¼‰**ï¼š
> - å½“å‰å…¨ç½‘è´¨æŠ¼çº¦3200ä¸‡ETH
> - éœ€è¦æ§åˆ¶2/3å³çº¦2100ä¸‡ETHï¼ˆæŒ‰ETHä»·æ ¼$2000è®¡ç®—çº¦420äº¿ç¾å…ƒï¼‰
> - ä¸”æ”»å‡»æˆåŠŸåï¼ŒETHä»·æ ¼ä¼šæš´è·Œï¼Œæ”»å‡»è€…æŸå¤±æƒ¨é‡
> - è¿™å°±æ˜¯"ç»æµæœ€ç»ˆæ€§"ï¼šæ”»å‡»æˆæœ¬è¿œå¤§äºæ½œåœ¨æ”¶ç›Š
>
> **åœ¨æ¯”ç‰¹å¸ï¼ˆPoWï¼‰ä¸‹çš„åŒºåˆ«**ï¼š
> - éœ€è¦æ§åˆ¶è¶…è¿‡å…¨ç½‘51%ç®—åŠ›
> - é‡æ–°æŒ–æ˜ä»ç¬¬100å·åˆ°æœ€æ–°çš„æ‰€æœ‰åŒºå—ï¼ˆå‡è®¾1000ä¸ªåŒºå—=çº¦1å‘¨ï¼‰
> - åœ¨è¿™1å‘¨å†…ï¼Œè¯šå®çŸ¿å·¥ä¹Ÿåœ¨æŒ–æ–°åŒºå—ï¼Œä½ éœ€è¦çš„ç®—åŠ›å®é™…è¿œè¶…51%
> - è¿™å°±æ˜¯"51%æ”»å‡»"ç†è®ºï¼Œå®é™…å‡ ä¹ä¸å¯èƒ½å®ç°
>
> **å®é™…æ¡ˆä¾‹**ï¼š
> - 2016å¹´The DAOæ”»å‡»åï¼Œä»¥å¤ªåŠç¤¾åŒºé€šè¿‡ç¡¬åˆ†å‰å›æ»šäº†é“¾ï¼ˆå½¢æˆETHå’ŒETCï¼‰
> - 2019å¹´Ethereum Classicï¼ˆETCï¼‰é­å—51%æ”»å‡»ï¼ŒæŸå¤±çº¦110ä¸‡ç¾å…ƒ
> - è¿™è¯æ˜äº†è¶³å¤Ÿå»ä¸­å¿ƒåŒ–çš„ç½‘ç»œï¼ˆå¦‚ETHï¼‰å‡ ä¹æ— æ³•è¢«æ”»å‡»

**ä¸ºä»€ä¹ˆè¿™ä¸ªå›ç­”å‡ºå½©ï¼Ÿ**
1. âœ… åˆ†é˜¶æ®µåˆ†æï¼ˆæœ¬åœ°ç¯¡æ”¹â†’å…±è¯†éªŒè¯â†’ç½‘ç»œå…±è¯†ï¼‰ï¼Œé€»è¾‘æ¸…æ™°
2. âœ… é‡åŒ–äº†æ”»å‡»æˆæœ¬ï¼ˆ420äº¿ç¾å…ƒï¼‰ï¼Œå±•ç¤ºæ·±å…¥æ€è€ƒ
3. âœ… å¯¹æ¯”äº†PoSå’ŒPoWçš„åŒºåˆ«
4. âœ… å¼•ç”¨äº†çœŸå®å†å²æ¡ˆä¾‹ï¼ˆThe DAOã€ETCæ”»å‡»ï¼‰
5. âœ… è§£é‡Šäº†"ç»æµæœ€ç»ˆæ€§"å’Œ"51%æ”»å‡»"ç­‰é«˜çº§æ¦‚å¿µ

---

## 9. ã€åŒ–éª¨ç»µæŒã€‘

### å¡ç‰‡1ï¼šç›´è§‰ç†è§£ - åŒºå—é“¾æ˜¯ä»€ä¹ˆï¼Ÿ ğŸ¯

**ä¸€å¥è¯ï¼š** åŒºå—é“¾æ˜¯ä¸€ä¸ªåªèƒ½è¿½åŠ ã€ä¸èƒ½ä¿®æ”¹çš„å…¬å…±è´¦æœ¬ï¼Œæ¯ä¸ªäººéƒ½æœ‰å®Œæ•´å‰¯æœ¬ï¼Œé€šè¿‡å¯†ç å­¦ä¿è¯ä¸€è‡´æ€§ã€‚

**ä¸¾ä¾‹ï¼š**
æƒ³è±¡ä¸€ä¸ªå…¨ç­å…±äº«çš„è´¦æœ¬ï¼Œè®°å½•è°å€Ÿè°é’±ï¼š
- ä¼ ç»Ÿæ–¹å¼ï¼šç­é•¿ä¿ç®¡è´¦æœ¬ï¼ˆä¸­å¿ƒåŒ–ï¼Œç­é•¿å¯ä»¥ç¯¡æ”¹ï¼‰
- åŒºå—é“¾æ–¹å¼ï¼šæ¯äººéƒ½æœ‰ä¸€ä»½è´¦æœ¬å‰¯æœ¬ï¼Œæ–°è®°å½•éœ€è¦å¤§å®¶åŒæ„æ‰èƒ½å†™å…¥

**åº”ç”¨ï¼š** ä»¥å¤ªåŠæ¯12ç§’äº§ç”Ÿä¸€ä¸ªæ–°åŒºå—ï¼Œå…¨çƒæ•°åƒä¸ªèŠ‚ç‚¹åŒæ—¶éªŒè¯å’Œå­˜å‚¨ï¼Œç¡®ä¿æ²¡æœ‰å•ç‚¹æ•…éšœã€‚

---

### å¡ç‰‡2ï¼šå½¢å¼åŒ–å®šä¹‰ - åŒºå—ç»“æ„ ğŸ“

**ä¸€å¥è¯ï¼š** åŒºå— = Headerï¼ˆå…ƒæ•°æ®+ä¸‰ä¸ªMerkleæ ¹ï¼‰+ Bodyï¼ˆäº¤æ˜“åˆ—è¡¨ï¼‰ï¼ŒHeaderå“ˆå¸Œä½œä¸ºåŒºå—å”¯ä¸€æ ‡è¯†ã€‚

**ä¸¾ä¾‹ï¼š**
```javascript
Block {
  header: {
    parentHash: "0xabc...",  // é“¾æ¥ä¸Šä¸€ä¸ªåŒºå—
    stateRoot: "0xdef...",   // è´¦æˆ·çŠ¶æ€å¿«ç…§
    transactionsRoot: "0x...",
    number: 18000000,
    timestamp: 1625097600
  },
  body: {
    transactions: [tx1, tx2, tx3, ...]
  }
}
```

**åº”ç”¨ï¼š** è½»å®¢æˆ·ç«¯åªéœ€ä¸‹è½½Headerï¼ˆçº¦500å­—èŠ‚ï¼‰å°±èƒ½éªŒè¯äº¤æ˜“ï¼Œæ— éœ€ä¸‹è½½å®Œæ•´åŒºå—ï¼ˆå¯èƒ½å‡ MBï¼‰ã€‚

---

### å¡ç‰‡3ï¼šå…³é”®æ¦‚å¿µ - Keccak256å“ˆå¸Œ ğŸ”

**ä¸€å¥è¯ï¼š** Keccak256æ˜¯ä»¥å¤ªåŠçš„å“ˆå¸Œå‡½æ•°ï¼Œå°†ä»»æ„é•¿åº¦æ•°æ®æ˜ å°„ä¸º256ä½æŒ‡çº¹ï¼Œå…·æœ‰å•å‘æ€§å’ŒæŠ—ç¢°æ’æ€§ã€‚

**ä¸¾ä¾‹ï¼š**
```javascript
keccak256("Hello")
â†’ 0x06b3dfaec148fb1bb2b066f10ec285e7c9bf402ab32aa78a5d38e34566810cd2

keccak256("hello") // åªæ”¹äº†å¤§å°å†™
â†’ 0x1c8aff950685...ï¼ˆå®Œå…¨ä¸åŒçš„è¾“å‡ºï¼‰
```

**åº”ç”¨ï¼š** ç”¨äºç”Ÿæˆä»¥å¤ªåŠåœ°å€ã€äº¤æ˜“å“ˆå¸Œã€åŒºå—å“ˆå¸Œã€å‡½æ•°é€‰æ‹©å™¨ç­‰ï¼Œæ˜¯ä»¥å¤ªåŠå¯†ç å­¦çš„åŸºçŸ³ã€‚

---

### å¡ç‰‡4ï¼šå…³é”®æ¦‚å¿µ - Parent Hashé“¾æ¥ â›“ï¸

**ä¸€å¥è¯ï¼š** æ¯ä¸ªåŒºå—HeaderåŒ…å«çˆ¶åŒºå—å“ˆå¸Œï¼ˆparent hashï¼‰ï¼Œå½¢æˆé“¾å¼ç»“æ„ï¼Œä¿è¯å†å²ä¸å¯ç¯¡æ”¹ã€‚

**ä¸¾ä¾‹ï¼š**
```
Block 100 (hash: 0xAAA)
         â†‘
Block 101 (parentHash: 0xAAA, hash: 0xBBB)
         â†‘
Block 102 (parentHash: 0xBBB, hash: 0xCCC)

ç¯¡æ”¹Block 100 â†’ hashå˜æˆ0xXXX
â†’ Block 101çš„parentHashä»æ˜¯0xAAA
â†’ éªŒè¯å¤±è´¥ï¼
```

**åº”ç”¨ï¼š** è¿™å°±æ˜¯"åŒºå—é“¾"åç§°çš„ç”±æ¥ï¼Œä¹Ÿæ˜¯é˜²ç¯¡æ”¹çš„æ ¸å¿ƒæœºåˆ¶ã€‚è½»å®¢æˆ·ç«¯é€šè¿‡éªŒè¯parent hashé“¾å¯ä»¥è¿½æº¯åˆ°åˆ›ä¸–åŒºå—ã€‚

---

### å¡ç‰‡5ï¼šç¼–ç¨‹å®ç° - ç®€åŒ–åŒºå—é“¾ ğŸ’»

**ä¸€å¥è¯ï¼š** ç”¨JavaScriptå®ç°ä¸€ä¸ªç®€åŒ–ç‰ˆåŒºå—é“¾ï¼ŒåŒ…å«åŒºå—ç±»ã€äº¤æ˜“ç±»å’Œé“¾éªŒè¯é€»è¾‘ã€‚

**ä¸¾ä¾‹ï¼š**
```javascript
class Block {
  constructor(transactions, previousHash) {
    this.transactions = transactions;
    this.previousHash = previousHash;
    this.timestamp = Date.now();
    this.hash = keccak256(
      previousHash + JSON.stringify(transactions) + timestamp
    );
  }
}

class Blockchain {
  constructor() {
    this.chain = [this.createGenesisBlock()];
  }

  addBlock(transactions) {
    const previousBlock = this.getLatestBlock();
    const newBlock = new Block(transactions, previousBlock.hash);
    this.chain.push(newBlock);
  }

  isChainValid() {
    for (let i = 1; i < this.chain.length; i++) {
      if (this.chain[i].previousHash !== this.chain[i-1].hash) {
        return false;
      }
    }
    return true;
  }
}
```

**åº”ç”¨ï¼š** ç†è§£è¿™ä¸ªç®€åŒ–å®ç°åï¼Œå°±èƒ½ç†è§£ä»¥å¤ªåŠçš„åŒºå—ç»“æ„ï¼Œåªæ˜¯ä»¥å¤ªåŠå¢åŠ äº†å…±è¯†æœºåˆ¶ã€Gasã€çŠ¶æ€æ ‘ç­‰é«˜çº§ç‰¹æ€§ã€‚

---

### å¡ç‰‡6ï¼šå¯¹æ¯”åŒºåˆ† - äº¤æ˜“å“ˆå¸Œ vs åŒºå—å“ˆå¸Œ ğŸ†š

**ä¸€å¥è¯ï¼š** äº¤æ˜“å“ˆå¸Œå”¯ä¸€æ ‡è¯†ä¸€ç¬”äº¤æ˜“ï¼ŒåŒºå—å“ˆå¸Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ªåŒºå—ï¼ŒäºŒè€…å®Œå…¨ä¸åŒä¸”ç”¨é€”ä¸åŒã€‚

**ä¸¾ä¾‹ï¼š**
```javascript
// å‘é€äº¤æ˜“
const tx = await signer.sendTransaction({...});
console.log("äº¤æ˜“å“ˆå¸Œ:", tx.hash); // 0x1234abcd...

// ç­‰å¾…æ‰“åŒ…
const receipt = await tx.wait();
console.log("åŒºå—å“ˆå¸Œ:", receipt.blockHash); // 0x5678efgh...
console.log("åŒºå—å·:", receipt.blockNumber); // 18234567
```

**åŒºåˆ«è¡¨ï¼š**

| ç‰¹æ€§ | äº¤æ˜“å“ˆå¸Œ | åŒºå—å“ˆå¸Œ |
|------|---------|---------|
| æ ‡è¯†å¯¹è±¡ | å•ç¬”äº¤æ˜“ | æ•´ä¸ªåŒºå— |
| ä½•æ—¶ç”Ÿæˆ | äº¤æ˜“ç­¾ååç«‹å³ | åŒºå—è¢«æŒ–å‡ºæ—¶ |
| åŒ…å«å…³ç³» | 1ç¬”äº¤æ˜“ | 150-300ç¬”äº¤æ˜“ |
| æŸ¥è¯¢ç”¨é€” | æŸ¥äº¤æ˜“çŠ¶æ€ | æŸ¥åŒºå—æ‰€æœ‰äº¤æ˜“ |

**åº”ç”¨ï¼š** åœ¨EtherscanæŸ¥è¯¢æ—¶ï¼Œç”¨äº¤æ˜“å“ˆå¸Œæ‰¾ç‰¹å®šäº¤æ˜“ï¼Œç”¨åŒºå—å“ˆå¸Œæˆ–åŒºå—å·æŸ¥çœ‹åŒºå—å†…æ‰€æœ‰äº¤æ˜“ã€‚

---

### å¡ç‰‡7ï¼šè¿›é˜¶ç†è§£ - Merkle Tree ğŸŒ³

**ä¸€å¥è¯ï¼š** Merkle Treeå°†æ‰€æœ‰äº¤æ˜“ç»„ç»‡æˆæ ‘çŠ¶ç»“æ„ï¼Œåªéœ€å­˜å‚¨æ ¹å“ˆå¸Œå°±èƒ½é«˜æ•ˆéªŒè¯ä»»æ„äº¤æ˜“çš„å­˜åœ¨æ€§ã€‚

**ä¸¾ä¾‹ï¼š**
```
å‡è®¾åŒºå—æœ‰4ç¬”äº¤æ˜“:
        Root Hash (å­˜å‚¨åœ¨Block Header)
          /          \
      Hash01        Hash23
       /  \          /  \
   Hash0 Hash1  Hash2 Hash3
     |     |      |     |
    Tx0   Tx1    Tx2   Tx3

éªŒè¯Tx0åœ¨åŒºå—ä¸­åªéœ€æä¾›: Hash1, Hash23
éªŒè¯è·¯å¾„: Hash0 + Hash1 â†’ Hash01
         Hash01 + Hash23 â†’ Root Hash
å¯¹æ¯”Root Hashæ˜¯å¦åŒ¹é…
```

**åº”ç”¨ï¼š** ä»¥å¤ªåŠä½¿ç”¨Merkle Patricia Treeï¼ˆMPTï¼‰ç»„ç»‡Stateã€Transactionsã€Receiptsï¼Œè½»å®¢æˆ·ç«¯åªéœ€ä¸‹è½½å°‘é‡è¯æ˜å°±èƒ½éªŒè¯äº¤æ˜“ã€‚

---

### å¡ç‰‡8ï¼šé«˜çº§åº”ç”¨ - è½»å®¢æˆ·ç«¯éªŒè¯ ğŸ“±

**ä¸€å¥è¯ï¼š** è½»å®¢æˆ·ç«¯åªä¸‹è½½åŒºå—å¤´ï¼ˆçº¦500å­—èŠ‚ï¼‰ï¼Œé€šè¿‡Merkleè¯æ˜éªŒè¯äº¤æ˜“ï¼Œæ— éœ€ä¸‹è½½å®Œæ•´åŒºå—ï¼ˆå‡ MBï¼‰ã€‚

**ä¸¾ä¾‹ï¼š**
```javascript
// è½»å®¢æˆ·ç«¯éªŒè¯æµç¨‹
1. ä¸‹è½½åŒºå—å¤´ï¼ˆ500å­—èŠ‚ï¼‰
   header = {
     transactionsRoot: "0xabc...",
     stateRoot: "0xdef...",
     ...
   }

2. å‘å…¨èŠ‚ç‚¹è¯·æ±‚Merkleè¯æ˜
   proof = getMerkleProof(txHash)

3. æœ¬åœ°éªŒè¯
   computedRoot = verifyMerkleProof(txHash, proof)
   if (computedRoot === header.transactionsRoot) {
     // äº¤æ˜“ç¡®å®åœ¨è¿™ä¸ªåŒºå—ä¸­ï¼
   }
```

**åº”ç”¨ï¼š** MetaMaskç­‰æµè§ˆå™¨é’±åŒ…å°±æ˜¯è½»å®¢æˆ·ç«¯ï¼Œæ— éœ€åŒæ­¥å‡ ç™¾GBçš„åŒºå—æ•°æ®ï¼ŒåªåŒæ­¥åŒºå—å¤´å°±èƒ½éªŒè¯äº¤æ˜“ã€‚

---

### å¡ç‰‡9ï¼šåœ¨ä»¥å¤ªåŠç”Ÿæ€ä¸­çš„åº”ç”¨ ğŸŒ

**ä¸€å¥è¯ï¼š** åŒºå—ã€äº¤æ˜“ã€å“ˆå¸Œæ˜¯ä»¥å¤ªåŠæ‰€æœ‰åº”ç”¨çš„åŸºç¡€ï¼Œä»ç®€å•è½¬è´¦åˆ°å¤æ‚DeFiåè®®éƒ½ä¾èµ–è¿™ä¸‰è€…ã€‚

**ä¸¾ä¾‹ï¼š**

**1. ç®€å•è½¬è´¦ï¼š**
```javascript
// Aliceç»™Bobè½¬1 ETH
const tx = await signer.sendTransaction({
  to: "0xBob",
  value: ethers.parseEther("1.0")
});
// è·å¾—äº¤æ˜“å“ˆå¸Œï¼Œç­‰å¾…è¢«æ‰“åŒ…è¿›åŒºå—
```

**2. DeFiï¼ˆUniswapäº¤æ¢ï¼‰ï¼š**
```javascript
// äº¤æ¢ETHä¸ºUSDC
const tx = await uniswapRouter.swapExactETHForTokens(...);
// åŒæ ·çš„äº¤æ˜“æµç¨‹ï¼šå‘é€â†’è·å¾—txHashâ†’æ‰“åŒ…è¿›åŒºå—â†’ç¡®è®¤
```

**3. NFTé“¸é€ ï¼š**
```javascript
// é“¸é€ NFT
const tx = await nftContract.mint(tokenURI);
// äº¤æ˜“è®°å½•åœ¨åŒºå—ä¸­ï¼ŒNFTæ‰€æœ‰æƒè®°å½•åœ¨State Rootä¸­
```

**åº”ç”¨ï¼š** æ— è®ºå¤šå¤æ‚çš„DAppï¼Œåº•å±‚éƒ½æ˜¯ï¼šåˆ›å»ºäº¤æ˜“ â†’ æ‰“åŒ…è¿›åŒºå— â†’ é€šè¿‡å“ˆå¸ŒéªŒè¯ â†’ æ›´æ–°çŠ¶æ€ã€‚

---

### å¡ç‰‡10ï¼šæ€»ç»“ä¸å»¶ä¼¸ ğŸ“

**ä¸€å¥è¯ï¼š** åŒºå—ã€äº¤æ˜“ã€å“ˆå¸Œæ„æˆäº†åŒºå—é“¾çš„æ ¸å¿ƒä¸‰è§’ï¼Œç†è§£å®ƒä»¬æ˜¯æ·±å…¥å­¦ä¹ æ™ºèƒ½åˆçº¦ã€DeFiã€Layer2çš„åŸºç¡€ã€‚

**æ ¸å¿ƒè¦ç‚¹æ€»ç»“ï¼š**

1. **åŒºå—** = äº¤æ˜“çš„æ‰¹é‡å®¹å™¨ï¼ˆHeader + Bodyï¼‰
2. **å“ˆå¸Œ** = æ•°æ®çš„å”¯ä¸€æŒ‡çº¹ï¼ˆKeccak256ï¼‰
3. **é“¾æ¥** = é€šè¿‡Parent Hashå½¢æˆä¸å¯ç¯¡æ”¹çš„é“¾
4. **éªŒè¯** = Merkle Treeå®ç°é«˜æ•ˆéªŒè¯
5. **åº”ç”¨** = æ‰€æœ‰DAppçš„åº•å±‚åŸºç¡€

**ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®ï¼š**

- **åç»­çŸ¥è¯†ç‚¹**ï¼š
  - å…¬é’¥/ç§é’¥/åœ°å€ç”Ÿæˆï¼ˆç†è§£è´¦æˆ·æ¨¡å‹ï¼‰
  - Gasè´¹ç”¨æœºåˆ¶ï¼ˆç†è§£äº¤æ˜“æˆæœ¬ï¼‰
  - EVMæ‰§è¡ŒåŸç†ï¼ˆç†è§£åˆçº¦å¦‚ä½•è¿è¡Œï¼‰
  - Merkle Patricia Treeï¼ˆæ·±å…¥Stateç®¡ç†ï¼‰

- **å®æˆ˜ç»ƒä¹ **ï¼š
  - ç”¨ethers.jsæŸ¥è¯¢çœŸå®ä»¥å¤ªåŠåŒºå—
  - å®ç°ä¸€ä¸ªç®€åŒ–ç‰ˆåŒºå—é“¾éªŒè¯å™¨
  - åˆ†æEtherscanä¸Šçš„çœŸå®äº¤æ˜“å’ŒåŒºå—
  - å­¦ä¹ å¦‚ä½•è®¡ç®—äº¤æ˜“å“ˆå¸Œå’ŒéªŒè¯ç­¾å

**å»¶ä¼¸èµ„æºï¼š**
- [Ethereum Block Structure](https://www.geeksforgeeks.org/ethereum-block-structure/)
- [Understanding Ethereum Transactions](https://ethereum.org/en/developers/docs/transactions/)
- [Keccak256 in Ethereum](https://medium.com/@joichiro.sai/understanding-keccak256-in-ethereum-blockchain-security-d20f1a881de3)

---

## 10. ã€ä¸€å¥è¯æ€»ç»“ã€‘

**åŒºå—æ˜¯ä»¥å¤ªåŠæ‰¹é‡æ‰“åŒ…äº¤æ˜“çš„æ•°æ®å®¹å™¨ï¼Œé€šè¿‡Keccak256å“ˆå¸Œå‡½æ•°ç”Ÿæˆå”¯ä¸€æŒ‡çº¹ï¼Œæ¯ä¸ªåŒºå—çš„parent hashé“¾æ¥å‰ä¸€ä¸ªåŒºå—å½¢æˆä¸å¯ç¯¡æ”¹çš„é“¾å¼ç»“æ„ï¼Œè¿™æ˜¯åŒºå—é“¾å»ä¸­å¿ƒåŒ–ã€é˜²ç¯¡æ”¹çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä¹Ÿæ˜¯æ‰€æœ‰DAppå¼€å‘çš„åŸºç¡€ã€‚**

---

## ğŸ“š é™„å½•

### å­¦ä¹ æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬çŸ¥è¯†ç‚¹å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- [ ] è§£é‡ŠåŒºå—çš„Headerå’ŒBodyåˆ†åˆ«åŒ…å«ä»€ä¹ˆ
- [ ] è¯´å‡ºä»¥å¤ªåŠåŒºå—å¤´çš„ä¸‰ä¸ªMerkleæ ¹åŠå…¶ä½œç”¨
- [ ] ç†è§£Keccak256çš„å››å¤§å¯†ç å­¦ç‰¹æ€§
- [ ] è§£é‡Šparent hashå¦‚ä½•å®ç°é˜²ç¯¡æ”¹
- [ ] åŒºåˆ†äº¤æ˜“å“ˆå¸Œå’ŒåŒºå—å“ˆå¸Œçš„ä¸åŒç”¨é€”
- [ ] ä½¿ç”¨ethers.jsæŸ¥è¯¢åŒºå—å’Œäº¤æ˜“ä¿¡æ¯
- [ ] ç†è§£ä¸ºä»€ä¹ˆç¯¡æ”¹å†å²åŒºå—åœ¨ç»æµä¸Šä¸å¯è¡Œ
- [ ] è¯´å‡ºMerkle Treeåœ¨è½»å®¢æˆ·ç«¯éªŒè¯ä¸­çš„ä½œç”¨
- [ ] è§£é‡Šä¸ºä»€ä¹ˆä»¥å¤ªåŠä½¿ç”¨Keccak256è€ŒéSHA-256
- [ ] åœ¨Etherscanä¸Šç†Ÿç»ƒæŸ¥è¯¢åŒºå—å’Œäº¤æ˜“

### å¿«é€Ÿå‚è€ƒå¡

**å¸¸ç”¨ethers.jså‘½ä»¤ï¼š**

```javascript
// è¿æ¥æä¾›è€…
const provider = new ethers.JsonRpcProvider('RPC_URL');

// æŸ¥è¯¢æœ€æ–°åŒºå—å·
const blockNumber = await provider.getBlockNumber();

// æŸ¥è¯¢åŒºå—è¯¦æƒ…
const block = await provider.getBlock(blockNumber);

// æŸ¥è¯¢äº¤æ˜“è¯¦æƒ…
const tx = await provider.getTransaction(txHash);

// æŸ¥è¯¢äº¤æ˜“æ”¶æ®
const receipt = await provider.getTransactionReceipt(txHash);

// éªŒè¯åŒºå—é“¾æ¥
const parentBlock = await provider.getBlock(block.number - 1);
console.log(block.parentHash === parentBlock.hash);
```

**å…³é”®æ¦‚å¿µé€Ÿè®°ï¼š**

- **åŒºå—æ—¶é—´**ï¼šä»¥å¤ªåŠPoSåçº¦12ç§’/å—
- **åŒºå—å¤§å°**ï¼šåŠ¨æ€è°ƒæ•´ï¼Œé€šè¿‡Gas Limitæ§åˆ¶
- **å“ˆå¸Œé•¿åº¦**ï¼š256ä½ = 64ä¸ª16è¿›åˆ¶å­—ç¬¦ = 32å­—èŠ‚
- **Parent Hash**ï¼šæ°¸è¿œæŒ‡å‘å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œ
- **åˆ›ä¸–åŒºå—**ï¼šç¬¬0å·åŒºå—ï¼Œparent hashä¸º0x000...

### ä¸‹ä¸€æ­¥å­¦ä¹ 

æ¨èæŒ‰ä»¥ä¸‹é¡ºåºç»§ç»­å­¦ä¹ ï¼š

1. **å…¬é’¥/ç§é’¥/åœ°å€çš„ç”ŸæˆåŸç†** - ç†è§£è´¦æˆ·æ¨¡å‹å’Œç­¾åéªŒè¯
2. **Gasè´¹ç”¨æœºåˆ¶** - ç†è§£äº¤æ˜“æˆæœ¬å’ŒEIP-1559
3. **è´¦æˆ·æ¨¡å‹(EOA vs åˆçº¦è´¦æˆ·)** - ç†è§£ä»¥å¤ªåŠçš„ä¸¤ç§è´¦æˆ·ç±»å‹
4. **Solidityæ™ºèƒ½åˆçº¦åŸºç¡€** - å¼€å§‹ç¼–å†™é“¾ä¸Šä»£ç 
5. **Merkle Patricia Tree** - æ·±å…¥ç†è§£çŠ¶æ€å­˜å‚¨

### å‚è€ƒèµ„æº

**å®˜æ–¹æ–‡æ¡£ï¼š**
- [Blocks | ethereum.org](https://ethereum.org/developers/docs/blocks/)
- [Transactions | ethereum.org](https://ethereum.org/developers/docs/transactions/)

**æ·±å…¥é˜…è¯»ï¼š**
- [Ethereum Block Structure - GeeksforGeeks](https://www.geeksforgeeks.org/ethereum-block-structure/)
- [Understanding Keccak256 in Ethereum](https://medium.com/@joichiro.sai/understanding-keccak256-in-ethereum-blockchain-security-d20f1a881de3)
- [Learn Ethereum in 2024: Hash functions](https://jpmorais.medium.com/learn-ethereum-in-2024-10-hash-functions-and-ethereum-6f442b9cb4d1)

**å¼€å‘å·¥å…·ï¼š**
- [Etherscan](https://etherscan.io/) - åŒºå—æµè§ˆå™¨
- [Ethers.jsæ–‡æ¡£](https://docs.ethers.org/v6/) - å‰ç«¯åº“
- [Remix IDE](https://remix.ethereum.org/) - åœ¨çº¿Solidity IDE

---

**ç‰ˆæœ¬ï¼š** v1.0
**åˆ›å»ºæ—¥æœŸï¼š** 2025-12-07
**ä½œè€…ï¼š** Claude Code
**é€‚ç”¨äººç¾¤ï¼š** å‰ç«¯å·¥ç¨‹å¸ˆè½¬Web3å¼€å‘

---

**è®°ä½ï¼š** åŒºå—é“¾çš„"é“¾"æ¥è‡ªparent hashçš„é“¾æ¥ï¼Œ"åŒºå—"æ¥è‡ªäº¤æ˜“çš„æ‰¹é‡æ‰“åŒ…ï¼Œ"å“ˆå¸Œ"ä¿è¯äº†æ•°æ®çš„å®Œæ•´æ€§å’Œä¸å¯ç¯¡æ”¹æ€§ã€‚ç†è§£è¿™ä¸‰è€…çš„å…³ç³»ï¼Œä½ å°±æŒæ¡äº†åŒºå—é“¾çš„æ ¸å¿ƒï¼ğŸ¯
