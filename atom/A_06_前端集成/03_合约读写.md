# åˆçº¦è¯»å†™

## 1. ã€30å­—æ ¸å¿ƒã€‘

**åˆçº¦è¯»å†™æ˜¯DAppä¸æ™ºèƒ½åˆçº¦äº¤äº’çš„æ ¸å¿ƒæ“ä½œï¼Œè¯»æ“ä½œè°ƒç”¨view/pureå‡½æ•°å…è´¹è·å–é“¾ä¸Šæ•°æ®ï¼Œå†™æ“ä½œä¿®æ”¹çŠ¶æ€éœ€è¦ç­¾åå¹¶æ¶ˆè€—Gasï¼Œwagmié€šè¿‡useReadContractå’ŒuseWriteContractå°è£…äº†å®Œæ•´çš„äº¤äº’æµç¨‹ã€‚**

---

## 2. ã€ç¬¬ä¸€æ€§åŸç†ã€‘

### ä»€ä¹ˆæ˜¯ç¬¬ä¸€æ€§åŸç†ï¼Ÿ

**ç¬¬ä¸€æ€§åŸç†**ï¼šå›åˆ°äº‹ç‰©æœ€åŸºæœ¬çš„çœŸç†ï¼Œä»æºå¤´æ€è€ƒé—®é¢˜

### åˆçº¦è¯»å†™çš„ç¬¬ä¸€æ€§åŸç† ğŸ¯

#### 1. æœ€åŸºç¡€çš„å®šä¹‰

**è¯»æ“ä½œ = æŸ¥è¯¢é“¾ä¸Šæ•°æ®ï¼Œä¸æ”¹å˜çŠ¶æ€**
**å†™æ“ä½œ = ä¿®æ”¹é“¾ä¸ŠçŠ¶æ€ï¼Œéœ€è¦äº¤æ˜“**

æ ¸å¿ƒæœ¬è´¨ï¼š
- **è¯»**ï¼šä»»ä½•äººéƒ½å¯ä»¥å…è´¹æŸ¥è¯¢å…¬å¼€æ•°æ®
- **å†™**ï¼šéœ€è¦ç§é’¥ç­¾å + æ”¯ä»˜ Gas è´¹ç”¨

ä»…æ­¤è€Œå·²ï¼æ²¡æœ‰æ›´åŸºç¡€çš„äº†ã€‚

#### 2. ä¸ºä»€ä¹ˆéœ€è¦åŒºåˆ†è¯»å†™ï¼Ÿ

**æ ¸å¿ƒé—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸èƒ½æ‰€æœ‰æ“ä½œéƒ½ä¸€æ ·å¤„ç†ï¼Ÿ**

åŒºå—é“¾çš„æœ¬è´¨æ˜¯**å…¨çƒå…±äº«çš„æ•°æ®åº“**ï¼š
- **è¯»å–**ï¼šå°±åƒæŸ¥å­—å…¸ï¼ŒæŸ¥å¤šå°‘æ¬¡éƒ½ä¸å½±å“å­—å…¸å†…å®¹
- **å†™å…¥**ï¼šå°±åƒåœ¨å…¬å‘Šæ¿ä¸Šå†™å­—ï¼Œæ¯æ¬¡å†™å…¥éƒ½è¦è¢«æ‰€æœ‰äººéªŒè¯å’Œè®°å½•

**ç»æµå­¦è€ƒé‡ï¼š**
- è¯»å–ä¸æ”¹å˜çŠ¶æ€ â†’ ä¸éœ€è¦å…±è¯† â†’ ä¸éœ€è¦ä»˜è´¹
- å†™å…¥æ”¹å˜çŠ¶æ€ â†’ éœ€è¦å…¨ç½‘å…±è¯† â†’ éœ€è¦ä»˜è´¹ï¼ˆGasï¼‰

#### 3. åˆçº¦è¯»å†™çš„ä¸‰å±‚ä»·å€¼

##### ä»·å€¼1ï¼šæ•°æ®è·å– - å…è´¹è¯»å–é“¾ä¸Šä¿¡æ¯

```typescript
// è¯»å–ä»£å¸ä½™é¢ï¼ˆå…è´¹ï¼‰
const { data: balance } = useReadContract({
  address: tokenAddress,
  abi: erc20Abi,
  functionName: 'balanceOf',
  args: [userAddress],
});
// balance = 1000000000000000000n (1 token with 18 decimals)

// è¯»å– NFT æŒæœ‰è€…
const { data: owner } = useReadContract({
  address: nftAddress,
  abi: erc721Abi,
  functionName: 'ownerOf',
  args: [tokenId],
});
```

##### ä»·å€¼2ï¼šçŠ¶æ€ä¿®æ”¹ - å®‰å…¨çš„é“¾ä¸Šæ“ä½œ

```typescript
// è½¬è´¦ä»£å¸ï¼ˆéœ€è¦ç­¾å + Gasï¼‰
const { writeContract } = useWriteContract();

writeContract({
  address: tokenAddress,
  abi: erc20Abi,
  functionName: 'transfer',
  args: [recipient, amount],
});
// é’±åŒ…å¼¹å‡ºç¡®è®¤æ¡†
// ç”¨æˆ·ç¡®è®¤åäº¤æ˜“ä¸Šé“¾
```

##### ä»·å€¼3ï¼šå®æ—¶åé¦ˆ - å®Œæ•´çš„äº¤äº’é—­ç¯

```typescript
// è¯»å– â†’ å±•ç¤º â†’ å†™å…¥ â†’ ç­‰å¾… â†’ æ›´æ–°
function TransferFlow() {
  // 1. è¯»å–å½“å‰ä½™é¢
  const { data: balance, refetch } = useReadContract({...});

  // 2. æ‰§è¡Œè½¬è´¦
  const { writeContract, data: hash } = useWriteContract();

  // 3. ç­‰å¾…äº¤æ˜“ç¡®è®¤
  const { isSuccess } = useWaitForTransactionReceipt({ hash });

  // 4. äº¤æ˜“æˆåŠŸååˆ·æ–°ä½™é¢
  useEffect(() => {
    if (isSuccess) refetch();
  }, [isSuccess]);
}
```

#### 4. ä»ç¬¬ä¸€æ€§åŸç†æ¨å¯¼åˆçº¦è¯»å†™è®¾è®¡

**æ¨ç†é“¾ï¼š**

```
1. å‰æï¼šDApp éœ€è¦ä¸æ™ºèƒ½åˆçº¦äº¤äº’
   â†“
2. æ¨å¯¼ï¼šåˆçº¦æœ‰çŠ¶æ€ï¼ˆå˜é‡ï¼‰å’Œå‡½æ•°
   â†“
3. æ¨å¯¼ï¼šå‡½æ•°åˆ†ä¸ºåªè¯»ï¼ˆview/pureï¼‰å’Œå†™å…¥
   â†“
4. æ¨å¯¼ï¼šåªè¯»ä¸æ”¹å˜çŠ¶æ€ â†’ æœ¬åœ°æ‰§è¡Œ â†’ å…è´¹
   â†“
5. æ¨å¯¼ï¼šå†™å…¥æ”¹å˜çŠ¶æ€ â†’ éœ€è¦äº¤æ˜“ â†’ ä»˜ Gas
   â†“
6. æ¨å¯¼ï¼šäº¤æ˜“éœ€è¦ç­¾å â†’ è°ƒç”¨é’±åŒ…
   â†“
7. æ¨å¯¼ï¼šäº¤æ˜“éœ€è¦ç¡®è®¤ â†’ ç­‰å¾…å‡ºå—
   â†“
8. æœ€ç»ˆï¼šè¯»ï¼ˆå…è´¹å¿«é€Ÿï¼‰+ å†™ï¼ˆä»˜è´¹å¼‚æ­¥ï¼‰= å®Œæ•´äº¤äº’
```

#### 5. ä¸€å¥è¯æ€»ç»“ç¬¬ä¸€æ€§åŸç†

**åˆçº¦è¯»å†™çš„æœ¬è´¨åŒºåˆ«åœ¨äºæ˜¯å¦æ”¹å˜é“¾ä¸ŠçŠ¶æ€ï¼šè¯»æ“ä½œæœ¬åœ°æ‰§è¡Œå³å¯è¿”å›ç»“æœï¼Œå…è´¹ä¸”åŒæ­¥ï¼›å†™æ“ä½œéœ€è¦æ‰“åŒ…è¿›äº¤æ˜“ã€å…¨ç½‘å…±è¯†ã€çŸ¿å·¥æ‰§è¡Œï¼Œå› æ­¤éœ€è¦ç­¾åå’ŒGasï¼Œæ˜¯å¼‚æ­¥è¿‡ç¨‹ã€‚**

---

## 3. ã€3ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‘

### æ ¸å¿ƒæ¦‚å¿µ1ï¼šè¯»æ“ä½œ useReadContract ğŸ“–

**ä¸€å¥è¯å®šä¹‰ï¼š** è°ƒç”¨åˆçº¦çš„ view/pure å‡½æ•°ï¼Œå…è´¹è·å–é“¾ä¸Šæ•°æ®ï¼Œè‡ªåŠ¨ç¼“å­˜å’Œåˆ·æ–°ã€‚

```typescript
import { useReadContract } from 'wagmi';

// ERC20 ä»£å¸ ABIï¼ˆåªéœ€è¦ç”¨åˆ°çš„å‡½æ•°ï¼‰
const erc20Abi = [
  {
    name: 'balanceOf',
    type: 'function',
    stateMutability: 'view',
    inputs: [{ name: 'account', type: 'address' }],
    outputs: [{ name: '', type: 'uint256' }],
  },
  {
    name: 'totalSupply',
    type: 'function',
    stateMutability: 'view',
    inputs: [],
    outputs: [{ name: '', type: 'uint256' }],
  },
  {
    name: 'decimals',
    type: 'function',
    stateMutability: 'view',
    inputs: [],
    outputs: [{ name: '', type: 'uint8' }],
  },
] as const;

function TokenInfo({ tokenAddress, userAddress }) {
  // è¯»å–ä½™é¢
  const {
    data: balance,      // è¿”å›å€¼ï¼ˆbigintï¼‰
    isLoading,          // æ˜¯å¦åŠ è½½ä¸­
    isError,            // æ˜¯å¦å‡ºé”™
    error,              // é”™è¯¯ä¿¡æ¯
    refetch,            // æ‰‹åŠ¨åˆ·æ–°
    isRefetching,       // æ˜¯å¦æ­£åœ¨åˆ·æ–°
  } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'balanceOf',
    args: [userAddress],
    // å¯é€‰é…ç½®
    query: {
      enabled: !!userAddress,  // æ¡ä»¶æŸ¥è¯¢
      staleTime: 1000 * 60,    // 1åˆ†é’Ÿå†…è®¤ä¸ºæ•°æ®æ–°é²œ
      refetchInterval: 10000,  // æ¯10ç§’è‡ªåŠ¨åˆ·æ–°
    },
  });

  // è¯»å–æ€»ä¾›åº”é‡
  const { data: totalSupply } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'totalSupply',
  });

  // è¯»å–ç²¾åº¦
  const { data: decimals } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'decimals',
  });

  if (isLoading) return <div>åŠ è½½ä¸­...</div>;
  if (isError) return <div>é”™è¯¯: {error?.message}</div>;

  return (
    <div>
      <p>ä½™é¢: {formatUnits(balance ?? 0n, decimals ?? 18)}</p>
      <p>æ€»ä¾›åº”: {formatUnits(totalSupply ?? 0n, decimals ?? 18)}</p>
      <button onClick={() => refetch()}>
        {isRefetching ? 'åˆ·æ–°ä¸­...' : 'åˆ·æ–°'}
      </button>
    </div>
  );
}
```

**è¯»æ“ä½œç‰¹ç‚¹ï¼š**

| ç‰¹æ€§ | è¯´æ˜ |
|-----|------|
| è´¹ç”¨ | å…è´¹ï¼ˆä¸æ¶ˆè€— Gasï¼‰ |
| é€Ÿåº¦ | å³æ—¶è¿”å›ï¼ˆæ¯«ç§’çº§ï¼‰ |
| ç­¾å | ä¸éœ€è¦é’±åŒ…ç­¾å |
| ç¼“å­˜ | wagmi è‡ªåŠ¨ç¼“å­˜ |
| åˆ·æ–° | æ‰‹åŠ¨ refetch æˆ–è‡ªåŠ¨ |

---

### æ ¸å¿ƒæ¦‚å¿µ2ï¼šå†™æ“ä½œ useWriteContract âœï¸

**ä¸€å¥è¯å®šä¹‰ï¼š** è°ƒç”¨åˆçº¦çš„çŠ¶æ€ä¿®æ”¹å‡½æ•°ï¼Œéœ€è¦é’±åŒ…ç­¾åå’Œ Gas è´¹ç”¨ï¼Œè¿”å›äº¤æ˜“å“ˆå¸Œã€‚

```typescript
import { useWriteContract, useWaitForTransactionReceipt } from 'wagmi';
import { parseUnits } from 'viem';

// ERC20 å†™å…¥å‡½æ•° ABI
const erc20WriteAbi = [
  {
    name: 'transfer',
    type: 'function',
    stateMutability: 'nonpayable',
    inputs: [
      { name: 'to', type: 'address' },
      { name: 'amount', type: 'uint256' },
    ],
    outputs: [{ name: '', type: 'bool' }],
  },
  {
    name: 'approve',
    type: 'function',
    stateMutability: 'nonpayable',
    inputs: [
      { name: 'spender', type: 'address' },
      { name: 'amount', type: 'uint256' },
    ],
    outputs: [{ name: '', type: 'bool' }],
  },
] as const;

function TokenTransfer({ tokenAddress }) {
  const [recipient, setRecipient] = useState('');
  const [amount, setAmount] = useState('');

  // å†™å…¥åˆçº¦
  const {
    writeContract,     // å‘èµ·å†™å…¥çš„å‡½æ•°
    data: hash,        // äº¤æ˜“å“ˆå¸Œ
    isPending,         // ç­‰å¾…ç”¨æˆ·ç¡®è®¤
    isError,           // æ˜¯å¦å‡ºé”™
    error,             // é”™è¯¯ä¿¡æ¯
  } = useWriteContract();

  // ç­‰å¾…äº¤æ˜“ç¡®è®¤
  const {
    isLoading: isConfirming,  // ç­‰å¾…åŒºå—ç¡®è®¤
    isSuccess,                 // äº¤æ˜“æˆåŠŸ
    data: receipt,             // äº¤æ˜“æ”¶æ®
  } = useWaitForTransactionReceipt({ hash });

  // æ‰§è¡Œè½¬è´¦
  const handleTransfer = () => {
    writeContract({
      address: tokenAddress,
      abi: erc20WriteAbi,
      functionName: 'transfer',
      args: [
        recipient as `0x${string}`,
        parseUnits(amount, 18),  // è½¬æ¢ä¸º wei
      ],
    });
  };

  return (
    <div>
      <input
        placeholder="æ¥æ”¶åœ°å€"
        value={recipient}
        onChange={(e) => setRecipient(e.target.value)}
      />
      <input
        placeholder="é‡‘é¢"
        value={amount}
        onChange={(e) => setAmount(e.target.value)}
      />

      <button onClick={handleTransfer} disabled={isPending || isConfirming}>
        {isPending && 'è¯·åœ¨é’±åŒ…ç¡®è®¤...'}
        {isConfirming && 'ç­‰å¾…åŒºå—ç¡®è®¤...'}
        {!isPending && !isConfirming && 'è½¬è´¦'}
      </button>

      {/* çŠ¶æ€æ˜¾ç¤º */}
      {hash && <div>äº¤æ˜“å“ˆå¸Œ: {hash}</div>}
      {isSuccess && <div>âœ… äº¤æ˜“æˆåŠŸ!</div>}
      {isError && <div>âŒ é”™è¯¯: {error?.message}</div>}
    </div>
  );
}
```

**å†™æ“ä½œæµç¨‹ï¼š**

```
ç”¨æˆ·ç‚¹å‡» â†’ writeContract() â†’ é’±åŒ…å¼¹çª—
    â†“
ç”¨æˆ·ç¡®è®¤ â†’ äº¤æ˜“ç­¾å â†’ æäº¤åˆ°ç½‘ç»œ
    â†“
è¿”å› hash â†’ ç­‰å¾…ç¡®è®¤ â†’ äº¤æ˜“æˆåŠŸ/å¤±è´¥
```

**å†™æ“ä½œç‰¹ç‚¹ï¼š**

| ç‰¹æ€§ | è¯´æ˜ |
|-----|------|
| è´¹ç”¨ | éœ€è¦ Gasï¼ˆå–å†³äºæ“ä½œå¤æ‚åº¦ï¼‰ |
| é€Ÿåº¦ | å¼‚æ­¥ï¼ˆéœ€è¦ç­‰å¾…å‡ºå—ï¼Œé€šå¸¸10-30ç§’ï¼‰ |
| ç­¾å | å¿…é¡»é’±åŒ…ç­¾å |
| è¿”å› | äº¤æ˜“å“ˆå¸Œï¼ˆä¸æ˜¯ç»“æœï¼‰ |
| ç¡®è®¤ | éœ€è¦ useWaitForTransactionReceipt |

---

### æ ¸å¿ƒæ¦‚å¿µ3ï¼šABI åˆçº¦æ¥å£ ğŸ“‹

**ä¸€å¥è¯å®šä¹‰ï¼š** ABIï¼ˆApplication Binary Interfaceï¼‰æ˜¯åˆçº¦çš„æ¥å£æè¿°ï¼Œå‘Šè¯‰å‰ç«¯å¦‚ä½•ç¼–ç å‚æ•°å’Œè§£ç è¿”å›å€¼ã€‚

```typescript
// ===== ABI çš„ç»“æ„ =====

// å®Œæ•´çš„ ERC20 ABIï¼ˆéƒ¨åˆ†ï¼‰
const erc20Abi = [
  // äº‹ä»¶
  {
    type: 'event',
    name: 'Transfer',
    inputs: [
      { name: 'from', type: 'address', indexed: true },
      { name: 'to', type: 'address', indexed: true },
      { name: 'value', type: 'uint256', indexed: false },
    ],
  },

  // view å‡½æ•°ï¼ˆè¯»å–ï¼‰
  {
    type: 'function',
    name: 'balanceOf',
    stateMutability: 'view',
    inputs: [{ name: 'account', type: 'address' }],
    outputs: [{ name: '', type: 'uint256' }],
  },

  // pure å‡½æ•°ï¼ˆçº¯è®¡ç®—ï¼‰
  {
    type: 'function',
    name: 'decimals',
    stateMutability: 'pure',  // æˆ– view
    inputs: [],
    outputs: [{ name: '', type: 'uint8' }],
  },

  // nonpayable å‡½æ•°ï¼ˆå†™å…¥ï¼Œä¸æ¥æ”¶ ETHï¼‰
  {
    type: 'function',
    name: 'transfer',
    stateMutability: 'nonpayable',
    inputs: [
      { name: 'to', type: 'address' },
      { name: 'amount', type: 'uint256' },
    ],
    outputs: [{ name: '', type: 'bool' }],
  },

  // payable å‡½æ•°ï¼ˆå†™å…¥ï¼Œæ¥æ”¶ ETHï¼‰
  {
    type: 'function',
    name: 'deposit',
    stateMutability: 'payable',
    inputs: [],
    outputs: [],
  },
] as const;  // as const ä¿è¯ç±»å‹æ¨æ–­

// ===== ç®€åŒ– ABIï¼ˆäººç±»å¯è¯»æ ¼å¼ï¼‰=====

// viem æ”¯æŒç®€åŒ–çš„ ABI æ ¼å¼
const simpleAbi = [
  'function balanceOf(address account) view returns (uint256)',
  'function transfer(address to, uint256 amount) returns (bool)',
  'event Transfer(address indexed from, address indexed to, uint256 value)',
] as const;
```

**stateMutability å¯¹ç…§è¡¨ï¼š**

| stateMutability | è¯»/å†™ | Gas | ç­¾å | è¯´æ˜ |
|-----------------|------|-----|------|------|
| `view` | è¯» | å…è´¹ | ä¸éœ€è¦ | åªè¯»å–çŠ¶æ€ |
| `pure` | è¯» | å…è´¹ | ä¸éœ€è¦ | ä¸è¯»å–çŠ¶æ€ |
| `nonpayable` | å†™ | éœ€è¦ | éœ€è¦ | ä¿®æ”¹çŠ¶æ€ï¼Œä¸æ¥æ”¶ ETH |
| `payable` | å†™ | éœ€è¦ | éœ€è¦ | ä¿®æ”¹çŠ¶æ€ï¼Œå¯æ¥æ”¶ ETH |

**è·å– ABI çš„æ–¹å¼ï¼š**

```typescript
// 1. ä» Etherscan å¤åˆ¶
// https://etherscan.io/address/0x...#code â†’ Contract ABI

// 2. ä½¿ç”¨ TypeChain ç”Ÿæˆï¼ˆç¼–è¯‘æ—¶ï¼‰
// npx typechain --target ethers-v6 ./artifacts/**/*.json

// 3. ä½¿ç”¨ wagmi CLI ç”Ÿæˆ
// npx wagmi generate

// 4. ä» npm åŒ…å¯¼å…¥ï¼ˆæ ‡å‡†åˆçº¦ï¼‰
import { erc20Abi, erc721Abi } from 'viem';
```

---

## 4. ã€æœ€å°å¯ç”¨ã€‘

æŒæ¡ä»¥ä¸‹å†…å®¹ï¼Œå°±èƒ½å®ç°åŸºæœ¬çš„åˆçº¦äº¤äº’ï¼š

### 4.1 è¯»å– ERC20 ä»£å¸ä½™é¢

```typescript
import { useReadContract } from 'wagmi';
import { formatUnits } from 'viem';
import { erc20Abi } from 'viem';  // viem å†…ç½® ERC20 ABI

function TokenBalance({ tokenAddress, userAddress }) {
  const { data: balance } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'balanceOf',
    args: [userAddress],
  });

  const { data: decimals } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'decimals',
  });

  const formattedBalance = balance && decimals
    ? formatUnits(balance, decimals)
    : '0';

  return <span>{formattedBalance}</span>;
}
```

### 4.2 è½¬è´¦ä»£å¸

```typescript
import { useWriteContract, useWaitForTransactionReceipt } from 'wagmi';
import { parseUnits } from 'viem';
import { erc20Abi } from 'viem';

function Transfer({ tokenAddress, decimals = 18 }) {
  const { writeContract, data: hash, isPending } = useWriteContract();
  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({ hash });

  const handleTransfer = (to: string, amount: string) => {
    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'transfer',
      args: [to as `0x${string}`, parseUnits(amount, decimals)],
    });
  };

  return (
    <button
      onClick={() => handleTransfer('0x...', '100')}
      disabled={isPending || isConfirming}
    >
      {isPending ? 'ç¡®è®¤ä¸­...' : isConfirming ? 'ç­‰å¾…...' : 'è½¬è´¦'}
    </button>
  );
}
```

### 4.3 æˆæƒä»£å¸ï¼ˆapproveï¼‰

```typescript
import { useWriteContract } from 'wagmi';
import { parseUnits, maxUint256 } from 'viem';
import { erc20Abi } from 'viem';

function Approve({ tokenAddress, spenderAddress }) {
  const { writeContract, isPending } = useWriteContract();

  // æˆæƒæœ€å¤§é¢åº¦
  const handleApprove = () => {
    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'approve',
      args: [spenderAddress, maxUint256],  // æ— é™æˆæƒ
    });
  };

  // æˆæƒæŒ‡å®šé¢åº¦
  const handleApproveAmount = (amount: string) => {
    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'approve',
      args: [spenderAddress, parseUnits(amount, 18)],
    });
  };

  return <button onClick={handleApprove} disabled={isPending}>æˆæƒ</button>;
}
```

### 4.4 è¯»å– NFT ä¿¡æ¯

```typescript
import { useReadContract } from 'wagmi';
import { erc721Abi } from 'viem';

function NFTInfo({ nftAddress, tokenId }) {
  // è¯»å–æŒæœ‰è€…
  const { data: owner } = useReadContract({
    address: nftAddress,
    abi: erc721Abi,
    functionName: 'ownerOf',
    args: [BigInt(tokenId)],
  });

  // è¯»å–å…ƒæ•°æ® URI
  const { data: tokenURI } = useReadContract({
    address: nftAddress,
    abi: erc721Abi,
    functionName: 'tokenURI',
    args: [BigInt(tokenId)],
  });

  return (
    <div>
      <p>æŒæœ‰è€…: {owner}</p>
      <p>å…ƒæ•°æ®: {tokenURI}</p>
    </div>
  );
}
```

---

**è¿™äº›çŸ¥è¯†è¶³ä»¥ï¼š**
- âœ… è¯»å–ä»»æ„ ERC20/ERC721 åˆçº¦æ•°æ®
- âœ… æ‰§è¡Œä»£å¸è½¬è´¦
- âœ… å¤„ç†ä»£å¸æˆæƒ
- âœ… ç­‰å¾…äº¤æ˜“ç¡®è®¤

---

## 5. ã€1ä¸ªç±»æ¯”ã€‘

### ç±»æ¯”1ï¼šåˆçº¦è¯»å†™ = ATM æœºæ“ä½œ ğŸ§

#### ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼šé“¶è¡Œ ATM æœº

æƒ³è±¡ä½ åœ¨ä½¿ç”¨é“¶è¡Œ ATM æœºï¼š

**ATM æ“ä½œå¯¹åº”ï¼š**

| ATM æ“ä½œ | åˆçº¦æ“ä½œ | è¯´æ˜ |
|---------|---------|------|
| æŸ¥è¯¢ä½™é¢ | è¯»æ“ä½œ | å…è´¹ã€å³æ—¶ |
| å–æ¬¾ | å†™æ“ä½œ | éœ€è¦ç¡®è®¤ã€æ‰£æ‰‹ç»­è´¹ |
| é“¶è¡Œå¡ | é’±åŒ… | èº«ä»½å’Œæˆæƒ |
| è¾“å…¥å¯†ç  | é’±åŒ…ç­¾å | ç¡®è®¤æ“ä½œ |
| äº¤æ˜“å‡­æ¡ | äº¤æ˜“å“ˆå¸Œ | æ“ä½œè¯æ˜ |
| ç­‰å¾…å‡ºé’ | ç­‰å¾…ç¡®è®¤ | å¼‚æ­¥è¿‡ç¨‹ |

**è¯¦ç»†ç±»æ¯”ï¼š**

```
æŸ¥è¯¢ä½™é¢ï¼ˆè¯»æ“ä½œï¼‰ï¼š
1. æ’å¡ â†’ è¿æ¥é’±åŒ…
2. é€‰æ‹©"æŸ¥è¯¢ä½™é¢" â†’ useReadContract
3. ç«‹å³æ˜¾ç¤ºä½™é¢ â†’ è¿”å› data
4. å…è´¹ã€æ— éœ€å¯†ç  â†’ å…è´¹ã€æ— éœ€ç­¾å

å–æ¬¾ï¼ˆå†™æ“ä½œï¼‰ï¼š
1. æ’å¡ â†’ è¿æ¥é’±åŒ…
2. é€‰æ‹©"å–æ¬¾" â†’ writeContract
3. è¾“å…¥é‡‘é¢ â†’ è®¾ç½®å‚æ•°
4. è¾“å…¥å¯†ç ç¡®è®¤ â†’ é’±åŒ…ç­¾å
5. ç­‰å¾…å‡ºé’ â†’ ç­‰å¾…åŒºå—ç¡®è®¤
6. æ‹¿å‡­æ¡ â†’ è·å¾—äº¤æ˜“å“ˆå¸Œ
7. æ‰£æ‰‹ç»­è´¹ â†’ æ¶ˆè€— Gas
```

**ä¸¾ä¾‹ï¼š**

```typescript
// æŸ¥ä½™é¢ = æŸ¥ ATM ä½™é¢ï¼ˆå…è´¹ã€å³æ—¶ï¼‰
const { data: balance } = useReadContract({
  functionName: 'balanceOf',
  args: [myAddress],
});

// è½¬è´¦ = ATM å–æ¬¾ï¼ˆéœ€ç¡®è®¤ã€ç­‰å¾…ã€æ‰£è´¹ï¼‰
const { writeContract, data: hash } = useWriteContract();
writeContract({
  functionName: 'transfer',
  args: [toAddress, amount],
});
// é’±åŒ…å¼¹å‡º = ATM è¦æ±‚è¾“å…¥å¯†ç 
// ç­‰å¾…ç¡®è®¤ = ç­‰å¾… ATM å‡ºé’
// äº¤æ˜“å“ˆå¸Œ = ATM å‡­æ¡
```

---

#### å‰ç«¯é¢†åŸŸç±»æ¯”ï¼šHTTP GET vs POST

å¦‚æœä½ ç†Ÿæ‚‰ RESTful APIï¼Œåˆçº¦è¯»å†™å°±åƒ GET å’Œ POSTï¼š

**GET vs è¯»æ“ä½œï¼š**

```typescript
// ===== HTTP GET =====
const response = await fetch('/api/user/balance');
const data = await response.json();
// ç‰¹ç‚¹ï¼šå¹‚ç­‰ã€å¯ç¼“å­˜ã€æ— å‰¯ä½œç”¨

// ===== åˆçº¦è¯»æ“ä½œ =====
const { data } = useReadContract({
  functionName: 'balanceOf',
  args: [address],
});
// ç‰¹ç‚¹ï¼šå¹‚ç­‰ã€å¯ç¼“å­˜ã€æ— å‰¯ä½œç”¨
```

**POST vs å†™æ“ä½œï¼š**

```typescript
// ===== HTTP POST =====
const response = await fetch('/api/transfer', {
  method: 'POST',
  body: JSON.stringify({ to, amount }),
  headers: { 'Authorization': 'Bearer xxx' },  // éœ€è¦è®¤è¯
});
// ç‰¹ç‚¹ï¼šéå¹‚ç­‰ã€éœ€è¦è®¤è¯ã€æœ‰å‰¯ä½œç”¨

// ===== åˆçº¦å†™æ“ä½œ =====
writeContract({
  functionName: 'transfer',
  args: [to, amount],
});
// ç‰¹ç‚¹ï¼šéå¹‚ç­‰ã€éœ€è¦ç­¾åã€æœ‰å‰¯ä½œç”¨
```

**è¯¦ç»†å¯¹æ¯”ï¼š**

| ç‰¹æ€§ | HTTP GET | åˆçº¦è¯» | HTTP POST | åˆçº¦å†™ |
|-----|----------|--------|-----------|--------|
| å‰¯ä½œç”¨ | æ—  | æ—  | æœ‰ | æœ‰ |
| å¹‚ç­‰æ€§ | âœ… | âœ… | âŒ | âŒ |
| è®¤è¯ | å¯é€‰ | ä¸éœ€è¦ | é€šå¸¸éœ€è¦ | å¿…é¡»ç­¾å |
| ç¼“å­˜ | å¯ç¼“å­˜ | wagmi ç¼“å­˜ | ä¸ç¼“å­˜ | ä¸ç¼“å­˜ |
| è´¹ç”¨ | å…è´¹ | å…è´¹ | å…è´¹ | éœ€è¦ Gas |

**ä»£ç å¯¹æ¯”ï¼š**

```typescript
// ===== React Query + axios =====
// è¯»å–
const { data } = useQuery({
  queryKey: ['balance', userId],
  queryFn: () => axios.get(`/api/balance/${userId}`),
});

// å†™å…¥
const { mutate } = useMutation({
  mutationFn: (data) => axios.post('/api/transfer', data),
});

// ===== wagmi =====
// è¯»å–
const { data } = useReadContract({
  address, abi, functionName: 'balanceOf', args: [userId],
});

// å†™å…¥
const { writeContract } = useWriteContract();
```

---

### ç±»æ¯”2ï¼šABI = API æ–‡æ¡£ ğŸ“š

#### ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼šé¤å…èœå•

æƒ³è±¡ ABI å°±åƒé¤å…èœå•ï¼š

```
èœå•ï¼ˆABIï¼‰ï¼š
â”œâ”€â”€ èœåï¼ˆå‡½æ•°åï¼‰
â”œâ”€â”€ ä»·æ ¼ï¼ˆGasï¼‰
â”œâ”€â”€ é…æ–™ï¼ˆå‚æ•°ç±»å‹ï¼‰
â””â”€â”€ æˆå“ï¼ˆè¿”å›å€¼ï¼‰
```

**ä¸¾ä¾‹ï¼š**

```
èœå•ï¼š
- å®«ä¿é¸¡ä¸ï¼ˆtransferï¼‰
  - ææ–™ï¼šé¸¡è‚‰(address to)ã€èŠ±ç”Ÿ(uint256 amount)
  - ä»·æ ¼ï¼š50å…ƒï¼ˆGasï¼‰
  - å‡ºå“ï¼šä¸€ç›˜èœï¼ˆbool successï¼‰

ABIï¼š
{
  name: 'transfer',
  inputs: [
    { name: 'to', type: 'address' },
    { name: 'amount', type: 'uint256' }
  ],
  outputs: [{ type: 'bool' }]
}
```

#### å‰ç«¯é¢†åŸŸç±»æ¯”ï¼šTypeScript æ¥å£

```typescript
// TypeScript æ¥å£
interface TransferFunction {
  (to: string, amount: bigint): Promise<boolean>;
}

// Solidity ABI
{
  name: 'transfer',
  inputs: [
    { name: 'to', type: 'address' },      // string
    { name: 'amount', type: 'uint256' }   // bigint
  ],
  outputs: [{ type: 'bool' }]             // boolean
}
```

---

### ç±»æ¯”æ€»ç»“è¡¨

| åˆçº¦è¯»å†™æ¦‚å¿µ | ç”Ÿæ´»åœºæ™¯ç±»æ¯” | å‰ç«¯é¢†åŸŸç±»æ¯” |
|-------------|-------------|-------------|
| è¯»æ“ä½œ | ATM æŸ¥ä½™é¢ | HTTP GET |
| å†™æ“ä½œ | ATM å–æ¬¾ | HTTP POST |
| ABI | é¤å…èœå• | TypeScript æ¥å£ |
| å‚æ•°ç¼–ç  | ç‚¹èœæŠ¥èœå | JSON.stringify |
| è¿”å›å€¼è§£ç  | ä¸Šèœ | JSON.parse |
| Gas | ATM æ‰‹ç»­è´¹ | äº‘æœåŠ¡è´¹ç”¨ |
| äº¤æ˜“å“ˆå¸Œ | å–æ¬¾å‡­æ¡ | è¯·æ±‚ ID |
| ç­‰å¾…ç¡®è®¤ | ç­‰å¾…å‡ºé’ | Loading çŠ¶æ€ |

---

## 6. ã€åç›´è§‰ç‚¹ã€‘

### è¯¯åŒº1ï¼šå†™æ“ä½œçš„è¿”å›å€¼å°±æ˜¯å‡½æ•°ç»“æœ âŒ

**ä¸ºä»€ä¹ˆé”™ï¼Ÿ**

writeContract è¿”å›çš„æ˜¯**äº¤æ˜“å“ˆå¸Œ**ï¼Œä¸æ˜¯å‡½æ•°çš„è¿”å›å€¼ã€‚å‡½æ•°è¿”å›å€¼éœ€è¦åœ¨äº¤æ˜“ç¡®è®¤åä» receipt çš„ logs ä¸­è§£æã€‚

```typescript
// âŒ é”™è¯¯ç†è§£
const { writeContract, data } = useWriteContract();
await writeContract({ functionName: 'transfer', args: [to, amount] });
console.log(data);  // data æ˜¯äº¤æ˜“å“ˆå¸Œ '0x...'ï¼Œä¸æ˜¯ true/false

// âœ… æ­£ç¡®ç†è§£
const { writeContract, data: hash } = useWriteContract();
const { data: receipt } = useWaitForTransactionReceipt({ hash });
// receipt.logs åŒ…å«äº‹ä»¶æ—¥å¿—
// å‡½æ•°è¿”å›å€¼éœ€è¦ä» logs ä¸­è§£æï¼ˆé€šå¸¸ä¸éœ€è¦ï¼Œçœ‹äº‹ä»¶å°±å¤Ÿäº†ï¼‰
```

**ä¸ºä»€ä¹ˆäº¤æ˜“ä¸ç›´æ¥è¿”å›ç»“æœï¼Ÿ**

```
å†™æ“ä½œæµç¨‹ï¼š
1. ç”¨æˆ·ç­¾å â†’ äº¤æ˜“å‘é€åˆ°èŠ‚ç‚¹
2. äº¤æ˜“è¿›å…¥å†…å­˜æ±  â†’ ç­‰å¾…æ‰“åŒ…
3. çŸ¿å·¥æ‰“åŒ…æ‰§è¡Œ â†’ ç»“æœå†™å…¥åŒºå—
4. åŒºå—å¹¿æ’­ â†’ å…¨ç½‘ç¡®è®¤

å‰ç«¯ä¸èƒ½ç­‰è¿™ä¹ˆä¹…ï¼Œæ‰€ä»¥ï¼š
- ç­¾ååç«‹å³è¿”å›å“ˆå¸Œ
- ç”¨å“ˆå¸Œå¼‚æ­¥æŸ¥è¯¢ç»“æœ
```

**ä¸ºä»€ä¹ˆäººä»¬å®¹æ˜“è¿™æ ·é”™ï¼Ÿ**

ä¹ æƒ¯äº†åŒæ­¥çš„å‡½æ•°è°ƒç”¨ï¼ˆ`const result = fn()`ï¼‰ï¼Œä»¥ä¸ºåŒºå—é“¾ä¹Ÿæ˜¯è¿™æ ·ã€‚

---

### è¯¯åŒº2ï¼šè¯»æ“ä½œæ€»æ˜¯å…è´¹çš„ âŒ

**ä¸ºä»€ä¹ˆé”™ï¼Ÿ**

è¯»æ“ä½œ**åœ¨å¤–éƒ¨è°ƒç”¨æ—¶**å…è´¹ï¼Œä½†**åœ¨åˆçº¦å†…éƒ¨è°ƒç”¨æ—¶**ä¼šæ¶ˆè€— Gasã€‚

```solidity
// Solidity åˆçº¦
contract Example {
    mapping(address => uint256) public balances;

    // å¤–éƒ¨è°ƒç”¨ view å‡½æ•°ï¼šå…è´¹
    function getBalance(address user) external view returns (uint256) {
        return balances[user];
    }

    // åœ¨å†™æ“ä½œä¸­è°ƒç”¨ view å‡½æ•°ï¼šæ¶ˆè€— Gasï¼
    function transferWithCheck(address to, uint256 amount) external {
        uint256 balance = balances[msg.sender];  // è¯»å–æ¶ˆè€— Gas
        require(balance >= amount, "Insufficient");
        balances[msg.sender] -= amount;
        balances[to] += amount;
    }
}
```

```typescript
// å‰ç«¯ï¼šå¤–éƒ¨è°ƒç”¨ view å‡½æ•°ï¼Œå…è´¹
const { data } = useReadContract({
  functionName: 'getBalance',
  args: [userAddress],
});

// ä½† transferWithCheck å†…éƒ¨çš„è¯»å–ä¼šè®¡å…¥ Gas
```

**ä¸ºä»€ä¹ˆäººä»¬å®¹æ˜“è¿™æ ·é”™ï¼Ÿ**

åªä»å‰ç«¯è§’åº¦çœ‹ï¼Œä»¥ä¸ºæ‰€æœ‰ view å‡½æ•°éƒ½å…è´¹ã€‚å®é™…ä¸Š"å…è´¹"æ˜¯å› ä¸ºä¸éœ€è¦å…±è¯†ï¼Œä½† EVM æ‰§è¡Œæœ¬èº«æ˜¯æœ‰æˆæœ¬çš„ã€‚

---

### è¯¯åŒº3ï¼šäº¤æ˜“ç¡®è®¤åä¸€å®šæˆåŠŸæ‰§è¡Œäº† âŒ

**ä¸ºä»€ä¹ˆé”™ï¼Ÿ**

äº¤æ˜“ç¡®è®¤ï¼ˆä¸Šé“¾ï¼‰ä¸ç­‰äºæ‰§è¡ŒæˆåŠŸã€‚äº¤æ˜“å¯èƒ½å› ä¸ºï¼š
1. require/revert å¤±è´¥
2. Gas ä¸è¶³
3. åˆçº¦é€»è¾‘é”™è¯¯

è€Œ**å¤±è´¥**ï¼Œä½†ä»ç„¶**ä¸Šé“¾**ï¼ˆæ¶ˆè€— Gasï¼‰ã€‚

```typescript
const { data: receipt } = useWaitForTransactionReceipt({ hash });

// æ£€æŸ¥äº¤æ˜“çŠ¶æ€
if (receipt.status === 'success') {
  console.log('æ‰§è¡ŒæˆåŠŸ');
} else {
  console.log('æ‰§è¡Œå¤±è´¥');  // äº¤æ˜“ä¸Šé“¾äº†ï¼Œä½†åˆçº¦æ‰§è¡Œå¤±è´¥
}

// å¸¸è§å¤±è´¥åŸå› ï¼š
// - "execution reverted" â†’ require å¤±è´¥
// - "out of gas" â†’ Gas Limit è®¾ç½®å¤ªä½
// - "insufficient funds" â†’ ETH ä½™é¢ä¸å¤Ÿä»˜ Gas
```

**ä¸ºä»€ä¹ˆäººä»¬å®¹æ˜“è¿™æ ·é”™ï¼Ÿ**

ä»¥ä¸º"äº¤æ˜“ç¡®è®¤"ç­‰äº"æ“ä½œå®Œæˆ"ã€‚å®é™…ä¸Šäº¤æ˜“å¯èƒ½ä»¥å¤±è´¥çŠ¶æ€ä¸Šé“¾ã€‚

**æ­£ç¡®å¤„ç†ï¼š**

```typescript
const { isSuccess, isError, data: receipt } = useWaitForTransactionReceipt({ hash });

if (isSuccess && receipt.status === 'success') {
  // çœŸæ­£æˆåŠŸ
  showSuccess('è½¬è´¦æˆåŠŸ');
} else if (receipt?.status === 'reverted') {
  // äº¤æ˜“ä¸Šé“¾ä½†æ‰§è¡Œå¤±è´¥
  showError('äº¤æ˜“è¢«å›æ»š');
}
```

---

## 7. ã€å®æˆ˜ä»£ç ã€‘

### åŸºç¡€å®ç°ï¼šå®Œæ•´çš„ ERC20 äº¤äº’ç»„ä»¶

```typescript
// ===== 1. ä»£å¸ä¿¡æ¯å±•ç¤º src/components/TokenInfo.tsx =====

import { useReadContract, useAccount } from 'wagmi';
import { formatUnits } from 'viem';
import { erc20Abi } from 'viem';

interface TokenInfoProps {
  tokenAddress: `0x${string}`;
}

export function TokenInfo({ tokenAddress }: TokenInfoProps) {
  const { address: userAddress } = useAccount();

  // å¹¶è¡Œè¯»å–å¤šä¸ªæ•°æ®
  const { data: name } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'name',
  });

  const { data: symbol } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'symbol',
  });

  const { data: decimals } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'decimals',
  });

  const { data: totalSupply } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'totalSupply',
  });

  const {
    data: balance,
    isLoading,
    refetch,
  } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'balanceOf',
    args: [userAddress!],
    query: {
      enabled: !!userAddress,
    },
  });

  const formatValue = (value: bigint | undefined) => {
    if (!value || !decimals) return '0';
    return formatUnits(value, decimals);
  };

  return (
    <div className="token-info">
      <h3>{name ?? 'Loading...'} ({symbol})</h3>

      <div className="stats">
        <div className="stat">
          <label>æ€»ä¾›åº”é‡</label>
          <value>{formatValue(totalSupply)}</value>
        </div>

        <div className="stat">
          <label>æˆ‘çš„ä½™é¢</label>
          <value>
            {isLoading ? 'åŠ è½½ä¸­...' : formatValue(balance)}
            <button onClick={() => refetch()}>ğŸ”„</button>
          </value>
        </div>
      </div>
    </div>
  );
}
```

```typescript
// ===== 2. ä»£å¸è½¬è´¦ç»„ä»¶ src/components/TokenTransfer.tsx =====

import { useState, useEffect } from 'react';
import { useWriteContract, useWaitForTransactionReceipt, useAccount } from 'wagmi';
import { parseUnits, isAddress } from 'viem';
import { erc20Abi } from 'viem';

interface TokenTransferProps {
  tokenAddress: `0x${string}`;
  decimals: number;
  onSuccess?: () => void;
}

export function TokenTransfer({ tokenAddress, decimals, onSuccess }: TokenTransferProps) {
  const { address: userAddress } = useAccount();
  const [recipient, setRecipient] = useState('');
  const [amount, setAmount] = useState('');

  // å†™å…¥åˆçº¦
  const {
    writeContract,
    data: hash,
    isPending,
    isError: isWriteError,
    error: writeError,
    reset,
  } = useWriteContract();

  // ç­‰å¾…äº¤æ˜“ç¡®è®¤
  const {
    isLoading: isConfirming,
    isSuccess,
    isError: isConfirmError,
    error: confirmError,
    data: receipt,
  } = useWaitForTransactionReceipt({ hash });

  // äº¤æ˜“æˆåŠŸåå›è°ƒ
  useEffect(() => {
    if (isSuccess) {
      onSuccess?.();
      // æ¸…ç©ºè¡¨å•
      setRecipient('');
      setAmount('');
    }
  }, [isSuccess, onSuccess]);

  // éªŒè¯è¾“å…¥
  const isValidRecipient = recipient && isAddress(recipient);
  const isValidAmount = amount && parseFloat(amount) > 0;
  const canSubmit = isValidRecipient && isValidAmount && !isPending && !isConfirming;

  // æ‰§è¡Œè½¬è´¦
  const handleTransfer = () => {
    if (!canSubmit) return;

    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'transfer',
      args: [recipient as `0x${string}`, parseUnits(amount, decimals)],
    });
  };

  // è·å–çŠ¶æ€æ–‡æœ¬
  const getStatusText = () => {
    if (isPending) return 'â³ è¯·åœ¨é’±åŒ…ä¸­ç¡®è®¤...';
    if (isConfirming) return 'â›“ï¸ ç­‰å¾…åŒºå—ç¡®è®¤...';
    if (isSuccess) return 'âœ… è½¬è´¦æˆåŠŸï¼';
    if (isWriteError) return `âŒ ${writeError?.message}`;
    if (isConfirmError) return `âŒ ${confirmError?.message}`;
    return null;
  };

  return (
    <div className="token-transfer">
      <h3>è½¬è´¦</h3>

      <div className="form">
        <div className="field">
          <label>æ¥æ”¶åœ°å€</label>
          <input
            type="text"
            placeholder="0x..."
            value={recipient}
            onChange={(e) => setRecipient(e.target.value)}
            disabled={isPending || isConfirming}
          />
          {recipient && !isValidRecipient && (
            <span className="error">æ— æ•ˆçš„åœ°å€æ ¼å¼</span>
          )}
        </div>

        <div className="field">
          <label>é‡‘é¢</label>
          <input
            type="number"
            placeholder="0.0"
            value={amount}
            onChange={(e) => setAmount(e.target.value)}
            disabled={isPending || isConfirming}
            min="0"
            step="0.000001"
          />
        </div>

        <button
          onClick={handleTransfer}
          disabled={!canSubmit}
          className="transfer-btn"
        >
          {isPending ? 'ç¡®è®¤ä¸­...' : isConfirming ? 'ç­‰å¾…ä¸­...' : 'è½¬è´¦'}
        </button>
      </div>

      {/* çŠ¶æ€æ˜¾ç¤º */}
      {getStatusText() && (
        <div className={`status ${isSuccess ? 'success' : isWriteError || isConfirmError ? 'error' : 'pending'}`}>
          {getStatusText()}
        </div>
      )}

      {/* äº¤æ˜“è¯¦æƒ… */}
      {hash && (
        <div className="transaction-info">
          <p>
            äº¤æ˜“å“ˆå¸Œ:
            <a
              href={`https://etherscan.io/tx/${hash}`}
              target="_blank"
              rel="noopener noreferrer"
            >
              {hash.slice(0, 10)}...{hash.slice(-8)}
            </a>
          </p>
        </div>
      )}

      {/* é‡ç½®æŒ‰é’® */}
      {(isSuccess || isWriteError || isConfirmError) && (
        <button onClick={() => reset()} className="reset-btn">
          æ–°çš„è½¬è´¦
        </button>
      )}
    </div>
  );
}
```

```typescript
// ===== 3. ä»£å¸æˆæƒç»„ä»¶ src/components/TokenApproval.tsx =====

import { useState } from 'react';
import {
  useReadContract,
  useWriteContract,
  useWaitForTransactionReceipt,
} from 'wagmi';
import { parseUnits, formatUnits, maxUint256 } from 'viem';
import { erc20Abi } from 'viem';

interface TokenApprovalProps {
  tokenAddress: `0x${string}`;
  spenderAddress: `0x${string}`;
  userAddress: `0x${string}`;
  decimals: number;
}

export function TokenApproval({
  tokenAddress,
  spenderAddress,
  userAddress,
  decimals,
}: TokenApprovalProps) {
  const [customAmount, setCustomAmount] = useState('');

  // è¯»å–å½“å‰æˆæƒé¢åº¦
  const { data: allowance, refetch } = useReadContract({
    address: tokenAddress,
    abi: erc20Abi,
    functionName: 'allowance',
    args: [userAddress, spenderAddress],
  });

  // å†™å…¥æˆæƒ
  const { writeContract, data: hash, isPending, reset } = useWriteContract();

  // ç­‰å¾…ç¡®è®¤
  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({
    hash,
  });

  // æ ¼å¼åŒ–æˆæƒé¢åº¦æ˜¾ç¤º
  const formatAllowance = () => {
    if (!allowance) return '0';
    if (allowance === maxUint256) return 'æ— é™';
    return formatUnits(allowance, decimals);
  };

  // æˆæƒæ— é™é¢åº¦
  const approveUnlimited = () => {
    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'approve',
      args: [spenderAddress, maxUint256],
    });
  };

  // æˆæƒæŒ‡å®šé¢åº¦
  const approveCustom = () => {
    if (!customAmount) return;
    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'approve',
      args: [spenderAddress, parseUnits(customAmount, decimals)],
    });
  };

  // æ’¤é”€æˆæƒ
  const revokeApproval = () => {
    writeContract({
      address: tokenAddress,
      abi: erc20Abi,
      functionName: 'approve',
      args: [spenderAddress, 0n],
    });
  };

  // æˆåŠŸååˆ·æ–°
  if (isSuccess) {
    refetch();
    reset();
  }

  return (
    <div className="token-approval">
      <h3>ä»£å¸æˆæƒ</h3>

      <div className="current-allowance">
        <label>å½“å‰æˆæƒé¢åº¦:</label>
        <span>{formatAllowance()}</span>
      </div>

      <div className="approval-actions">
        {/* æ— é™æˆæƒ */}
        <button
          onClick={approveUnlimited}
          disabled={isPending || isConfirming}
        >
          æˆæƒæ— é™é¢åº¦
        </button>

        {/* è‡ªå®šä¹‰é¢åº¦ */}
        <div className="custom-approval">
          <input
            type="number"
            placeholder="è¾“å…¥é¢åº¦"
            value={customAmount}
            onChange={(e) => setCustomAmount(e.target.value)}
            disabled={isPending || isConfirming}
          />
          <button
            onClick={approveCustom}
            disabled={!customAmount || isPending || isConfirming}
          >
            æˆæƒ
          </button>
        </div>

        {/* æ’¤é”€æˆæƒ */}
        {allowance && allowance > 0n && (
          <button
            onClick={revokeApproval}
            disabled={isPending || isConfirming}
            className="revoke-btn"
          >
            æ’¤é”€æˆæƒ
          </button>
        )}
      </div>

      {/* çŠ¶æ€ */}
      {isPending && <p>â³ è¯·åœ¨é’±åŒ…ä¸­ç¡®è®¤...</p>}
      {isConfirming && <p>â›“ï¸ ç­‰å¾…åŒºå—ç¡®è®¤...</p>}
    </div>
  );
}
```

```typescript
// ===== 4. å®Œæ•´çš„ä»£å¸äº¤äº’é¡µé¢ src/pages/Token.tsx =====

import { useAccount } from 'wagmi';
import { TokenInfo } from '../components/TokenInfo';
import { TokenTransfer } from '../components/TokenTransfer';
import { TokenApproval } from '../components/TokenApproval';

// USDC åœ°å€ï¼ˆä¸»ç½‘ï¼‰
const USDC_ADDRESS = '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48' as const;
const USDC_DECIMALS = 6;

// Uniswap Routerï¼ˆç¤ºä¾‹æˆæƒç›®æ ‡ï¼‰
const UNISWAP_ROUTER = '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45' as const;

export function TokenPage() {
  const { address, isConnected } = useAccount();

  if (!isConnected) {
    return <div>è¯·å…ˆè¿æ¥é’±åŒ…</div>;
  }

  return (
    <div className="token-page">
      {/* ä»£å¸ä¿¡æ¯ */}
      <section>
        <TokenInfo tokenAddress={USDC_ADDRESS} />
      </section>

      {/* è½¬è´¦åŠŸèƒ½ */}
      <section>
        <TokenTransfer
          tokenAddress={USDC_ADDRESS}
          decimals={USDC_DECIMALS}
          onSuccess={() => {
            console.log('è½¬è´¦æˆåŠŸï¼Œå¯ä»¥åœ¨è¿™é‡Œåˆ·æ–°ä½™é¢');
          }}
        />
      </section>

      {/* æˆæƒç®¡ç† */}
      <section>
        <TokenApproval
          tokenAddress={USDC_ADDRESS}
          spenderAddress={UNISWAP_ROUTER}
          userAddress={address!}
          decimals={USDC_DECIMALS}
        />
      </section>
    </div>
  );
}
```

**è¿è¡Œæ•ˆæœï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USD Coin (USDC)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ€»ä¾›åº”é‡: 35,000,000,000                        â”‚
â”‚  æˆ‘çš„ä½™é¢: 1,234.56 ğŸ”„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è½¬è´¦                                           â”‚
â”‚  æ¥æ”¶åœ°å€: [0x________________]                  â”‚
â”‚  é‡‘é¢: [100.00_____]                            â”‚
â”‚  [è½¬è´¦]                                         â”‚
â”‚                                                 â”‚
â”‚  â³ è¯·åœ¨é’±åŒ…ä¸­ç¡®è®¤...                            â”‚
â”‚  äº¤æ˜“å“ˆå¸Œ: 0x1234...abcd                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»£å¸æˆæƒ                                       â”‚
â”‚  å½“å‰æˆæƒé¢åº¦: æ— é™                              â”‚
â”‚  [æˆæƒæ— é™é¢åº¦] [è¾“å…¥é¢åº¦] [æˆæƒ] [æ’¤é”€æˆæƒ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ã€é¢è¯•å¿…é—®ã€‘

### é—®é¢˜1ï¼š"åˆçº¦è¯»æ“ä½œå’Œå†™æ“ä½œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"

**æ™®é€šå›ç­”ï¼ˆâŒ ä¸å‡ºå½©ï¼‰ï¼š**

"è¯»ä¸è¦ Gasï¼Œå†™è¦ Gasã€‚è¯»ç”¨ viewï¼Œå†™ç”¨æ™®é€šå‡½æ•°ã€‚"

**å‡ºå½©å›ç­”ï¼ˆâœ… æ¨èï¼‰ï¼š**

> **è¯»æ“ä½œå’Œå†™æ“ä½œåœ¨å¤šä¸ªç»´åº¦æœ‰æœ¬è´¨åŒºåˆ«ï¼š**
>
> **1. æ‰§è¡Œå±‚é¢**
> | ç‰¹æ€§ | è¯»æ“ä½œ | å†™æ“ä½œ |
> |-----|-------|-------|
> | æ‰§è¡Œä½ç½® | æœ¬åœ°èŠ‚ç‚¹ | å…¨ç½‘çŸ¿å·¥ |
> | æ˜¯å¦ä¸Šé“¾ | ä¸ä¸Šé“¾ | ä¸Šé“¾ |
> | æ˜¯å¦éœ€è¦å…±è¯† | ä¸éœ€è¦ | éœ€è¦ |
>
> **2. ç”¨æˆ·ä½“éªŒå±‚é¢**
> | ç‰¹æ€§ | è¯»æ“ä½œ | å†™æ“ä½œ |
> |-----|-------|-------|
> | è´¹ç”¨ | å…è´¹ | éœ€è¦ Gas |
> | ç­¾å | ä¸éœ€è¦ | å¿…é¡» |
> | é€Ÿåº¦ | å³æ—¶ï¼ˆæ¯«ç§’ï¼‰ | å¼‚æ­¥ï¼ˆ10-30ç§’ï¼‰|
> | è¿”å›å€¼ | å‡½æ•°ç»“æœ | äº¤æ˜“å“ˆå¸Œ |
>
> **3. ä»£ç å±‚é¢**
> ```typescript
> // è¯»æ“ä½œï¼šç›´æ¥è¿”å›ç»“æœ
> const { data } = useReadContract({
>   functionName: 'balanceOf',
>   args: [address],
> });
> // data å°±æ˜¯ä½™é¢
>
> // å†™æ“ä½œï¼šè¿”å›å“ˆå¸Œï¼Œéœ€è¦ç­‰å¾…ç¡®è®¤
> const { writeContract, data: hash } = useWriteContract();
> const { isSuccess } = useWaitForTransactionReceipt({ hash });
> // éœ€è¦ä¸¤æ­¥æ‰èƒ½ç¡®è®¤æˆåŠŸ
> ```
>
> **4. ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**
> - è¯»æ“ä½œä¸æ”¹å˜çŠ¶æ€ï¼Œä»»ä½•èŠ‚ç‚¹éƒ½èƒ½è®¡ç®—ï¼Œæ— éœ€å…±è¯†
> - å†™æ“ä½œæ”¹å˜çŠ¶æ€ï¼Œéœ€è¦å…¨ç½‘éªŒè¯ï¼Œæ¶ˆè€—è®¡ç®—èµ„æº
> - Gas æœºåˆ¶é˜²æ­¢æ»¥ç”¨å’Œ DDoS æ”»å‡»

**ä¸ºä»€ä¹ˆè¿™ä¸ªå›ç­”å‡ºå½©ï¼Ÿ**
1. âœ… å¤šç»´åº¦å¯¹æ¯”ï¼ˆæ‰§è¡Œ/ç”¨æˆ·ä½“éªŒ/ä»£ç ï¼‰
2. âœ… æœ‰ä»£ç ç¤ºä¾‹
3. âœ… è§£é‡Šäº†è®¾è®¡åŸå› 

---

### é—®é¢˜2ï¼š"å¦‚ä½•ä¼˜åŒ–åˆçº¦è¯»å–æ€§èƒ½ï¼Ÿ"

**æ™®é€šå›ç­”ï¼ˆâŒ ä¸å‡ºå½©ï¼‰ï¼š**

"ç”¨ç¼“å­˜ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°ã€‚"

**å‡ºå½©å›ç­”ï¼ˆâœ… æ¨èï¼‰ï¼š**

> **ä¼˜åŒ–åˆçº¦è¯»å–æœ‰å‡ ä¸ªå±‚é¢çš„ç­–ç•¥ï¼š**
>
> **1. wagmi å†…ç½®ç¼“å­˜ï¼ˆé»˜è®¤ï¼‰**
> ```typescript
> // è‡ªåŠ¨å»é‡å’Œç¼“å­˜
> useReadContract({ ... });  // ç»„ä»¶ A
> useReadContract({ ... });  // ç»„ä»¶ Bï¼ˆå…±äº«ç¼“å­˜ï¼‰
> ```
>
> **2. é…ç½®ç¼“å­˜ç­–ç•¥**
> ```typescript
> useReadContract({
>   functionName: 'symbol',
>   query: {
>     staleTime: Infinity,  // æ°¸ä¸è¿‡æœŸï¼ˆé€‚åˆä¸å˜çš„æ•°æ®ï¼‰
>     gcTime: 1000 * 60 * 60, // ç¼“å­˜1å°æ—¶
>   },
> });
> ```
>
> **3. ä½¿ç”¨ Multicall æ‰¹é‡è¯»å–**
> ```typescript
> // å¤šä¸ªè¯·æ±‚åˆå¹¶ä¸ºä¸€æ¬¡ RPC è°ƒç”¨
> const results = await publicClient.multicall({
>   contracts: [
>     { address, abi, functionName: 'name' },
>     { address, abi, functionName: 'symbol' },
>     { address, abi, functionName: 'decimals' },
>   ],
> });
> // ä¸€æ¬¡è¯·æ±‚è·å–ä¸‰ä¸ªæ•°æ®
> ```
>
> **4. é€‰æ‹©åˆé€‚çš„ RPC èŠ‚ç‚¹**
> - ä½¿ç”¨ Alchemy/Infura ç­‰ä¸“ä¸šæœåŠ¡
> - è€ƒè™‘åœ°ç†ä½ç½®ï¼ˆé€‰æ‹©è¿‘çš„èŠ‚ç‚¹ï¼‰
> - ä½¿ç”¨ WebSocket è€Œé HTTPï¼ˆå‡å°‘å»¶è¿Ÿï¼‰
>
> **5. æŒ‰æ•°æ®ç‰¹æ€§åŒºåˆ†ç­–ç•¥**
> | æ•°æ®ç±»å‹ | ç­–ç•¥ | ç¤ºä¾‹ |
> |---------|------|------|
> | é™æ€æ•°æ® | é•¿æœŸç¼“å­˜ | name, symbol, decimals |
> | ä½é¢‘å˜åŒ– | ä¸­ç­‰ç¼“å­˜ | totalSupply |
> | å®æ—¶æ•°æ® | çŸ­æœŸç¼“å­˜ | balance, allowance |
> | æ•æ„Ÿæ•°æ® | æ¯æ¬¡è¯·æ±‚ | ä»·æ ¼ |
>
> **6. æ¡ä»¶æŸ¥è¯¢é¿å…æ— æ•ˆè¯·æ±‚**
> ```typescript
> useReadContract({
>   functionName: 'balanceOf',
>   args: [address],
>   query: {
>     enabled: !!address,  // address å­˜åœ¨æ‰è¯·æ±‚
>   },
> });
> ```

**ä¸ºä»€ä¹ˆè¿™ä¸ªå›ç­”å‡ºå½©ï¼Ÿ**
1. âœ… å¤šå±‚æ¬¡ç­–ç•¥ï¼ˆç¼“å­˜/æ‰¹é‡/èŠ‚ç‚¹/æ¡ä»¶ï¼‰
2. âœ… æœ‰å…·ä½“ä»£ç 
3. âœ… æŒ‰æ•°æ®ç‰¹æ€§åŒºåˆ†

---

## 9. ã€åŒ–éª¨ç»µæŒã€‘

### å¡ç‰‡1ï¼šç›´è§‰ç†è§£ - è¯»å†™çš„åŒºåˆ« ğŸ¯

**ä¸€å¥è¯ï¼š** è¯»æ“ä½œåƒæŸ¥å­—å…¸ï¼ˆå…è´¹å³æ—¶ï¼‰ï¼Œå†™æ“ä½œåƒå‘å…¬å‘Šï¼ˆä»˜è´¹å¼‚æ­¥ï¼‰ã€‚

**ä¸¾ä¾‹ï¼š**
```typescript
// è¯»ï¼šæŸ¥ä½™é¢
const { data } = useReadContract({ functionName: 'balanceOf' });

// å†™ï¼šè½¬è´¦
const { writeContract } = useWriteContract();
writeContract({ functionName: 'transfer' });
```

**åº”ç”¨ï¼š** æ ¹æ®æ“ä½œç±»å‹é€‰æ‹©æ­£ç¡®çš„ Hookã€‚

---

### å¡ç‰‡2ï¼šå½¢å¼åŒ–å®šä¹‰ - stateMutability ğŸ“

**ä¸€å¥è¯ï¼š** Solidity å‡½æ•°çš„ stateMutability å†³å®šäº†æ˜¯è¯»è¿˜æ˜¯å†™ã€‚

| stateMutability | ç±»å‹ | Gas |
|-----------------|------|-----|
| view | è¯» | å…è´¹ |
| pure | è¯» | å…è´¹ |
| nonpayable | å†™ | éœ€è¦ |
| payable | å†™ | éœ€è¦ |

**åº”ç”¨ï¼š** çœ‹ ABI åˆ¤æ–­å‡½æ•°ç±»å‹ã€‚

---

### å¡ç‰‡3ï¼šå…³é”®æ¦‚å¿µ1 - useReadContract ğŸ“–

**ä¸€å¥è¯ï¼š** è¯»å–åˆçº¦æ•°æ®çš„ Hookï¼Œè¿”å› dataã€isLoadingã€refetchã€‚

```typescript
const { data, isLoading, refetch } = useReadContract({
  address, abi, functionName, args,
});
```

**åº”ç”¨ï¼š** å±•ç¤ºä½™é¢ã€ä»£å¸ä¿¡æ¯ç­‰ã€‚

---

### å¡ç‰‡4ï¼šå…³é”®æ¦‚å¿µ2 - useWriteContract âœï¸

**ä¸€å¥è¯ï¼š** å†™å…¥åˆçº¦çš„ Hookï¼Œè¿”å› writeContract å‡½æ•°å’Œäº¤æ˜“å“ˆå¸Œã€‚

```typescript
const { writeContract, data: hash, isPending } = useWriteContract();
writeContract({ address, abi, functionName, args });
```

**åº”ç”¨ï¼š** è½¬è´¦ã€æˆæƒã€é“¸é€ ç­‰çŠ¶æ€ä¿®æ”¹æ“ä½œã€‚

---

### å¡ç‰‡5ï¼šç¼–ç¨‹å®ç° - ç­‰å¾…ç¡®è®¤ â³

**ä¸€å¥è¯ï¼š** ä½¿ç”¨ useWaitForTransactionReceipt ç­‰å¾…äº¤æ˜“ç¡®è®¤ã€‚

```typescript
const { isLoading, isSuccess, data: receipt } =
  useWaitForTransactionReceipt({ hash });
```

**åº”ç”¨ï¼š** æ˜¾ç¤ºäº¤æ˜“çŠ¶æ€ã€æˆåŠŸååˆ·æ–°æ•°æ®ã€‚

---

### å¡ç‰‡6ï¼šå¯¹æ¯”åŒºåˆ† - hash vs receipt ğŸ†š

**ä¸€å¥è¯ï¼š** hash æ˜¯äº¤æ˜“æ ‡è¯†ï¼ˆç«‹å³è¿”å›ï¼‰ï¼Œreceipt æ˜¯æ‰§è¡Œç»“æœï¼ˆç¡®è®¤åè¿”å›ï¼‰ã€‚

| å†…å®¹ | æ¥æº | æ—¶æœº |
|-----|------|------|
| hash | writeContract | ç­¾åå |
| receipt | waitForTransactionReceipt | ç¡®è®¤å |

**åº”ç”¨ï¼š** ç”¨ hash å±•ç¤ºé“¾æ¥ï¼Œç”¨ receipt åˆ¤æ–­æˆåŠŸã€‚

---

### å¡ç‰‡7ï¼šè¿›é˜¶ç†è§£ - ABI ç±»å‹ ğŸ“‹

**ä¸€å¥è¯ï¼š** ABI å®šä¹‰äº†å‡½æ•°ç­¾åï¼ŒTypeScript å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚

```typescript
// as const ä¿è¯ç±»å‹æ¨æ–­
const abi = [
  { name: 'balanceOf', ... }
] as const;

// data ç±»å‹è‡ªåŠ¨æ¨æ–­ä¸º bigint
const { data } = useReadContract({ abi, functionName: 'balanceOf' });
```

**åº”ç”¨ï¼š** ä½¿ç”¨ as const è·å¾—å®Œæ•´ç±»å‹æ”¯æŒã€‚

---

### å¡ç‰‡8ï¼šé«˜çº§åº”ç”¨ - Multicall ğŸ“¦

**ä¸€å¥è¯ï¼š** å°†å¤šä¸ªè¯»å–è¯·æ±‚åˆå¹¶ä¸ºä¸€æ¬¡ RPC è°ƒç”¨ã€‚

```typescript
const results = await publicClient.multicall({
  contracts: [
    { address, abi, functionName: 'name' },
    { address, abi, functionName: 'symbol' },
  ],
});
```

**åº”ç”¨ï¼š** æ‰¹é‡è¯»å–ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°ã€‚

---

### å¡ç‰‡9ï¼šå®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ ğŸŒ

**ä¸€å¥è¯ï¼š** å®Œæ•´çš„åˆçº¦äº¤äº’éœ€è¦å¤„ç† loadingã€errorã€success ä¸‰ç§çŠ¶æ€ã€‚

**æ ‡å‡†æµç¨‹ï¼š**
```
è¯»å–æ•°æ® â†’ ç”¨æˆ·è¾“å…¥ â†’ éªŒè¯ â†’ å†™å…¥ â†’ ç­‰å¾… â†’ æ›´æ–°
```

**åº”ç”¨ï¼š** æ„å»ºå®Œæ•´çš„äº¤æ˜“æµç¨‹ UIã€‚

---

### å¡ç‰‡10ï¼šæ€»ç»“ä¸å»¶ä¼¸ ğŸ“

**ä¸€å¥è¯ï¼š** åˆçº¦è¯»å†™æ˜¯ DApp çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒæŒæ¡å®ƒå°±èƒ½å®ç°å¤§éƒ¨åˆ†åŒºå—é“¾äº¤äº’ã€‚

**æ ¸å¿ƒè¦ç‚¹ï¼š**
1. è¯»å…è´¹å³æ—¶ï¼Œå†™ä»˜è´¹å¼‚æ­¥
2. useReadContract è¯»ï¼ŒuseWriteContract å†™
3. å†™æ“ä½œéœ€è¦ç­‰å¾…ç¡®è®¤
4. ABI å®šä¹‰äº†æ¥å£
5. å–„ç”¨ç¼“å­˜å’Œæ‰¹é‡æŸ¥è¯¢

**ä¸‹ä¸€æ­¥å­¦ä¹ ï¼š**
- äº¤æ˜“çŠ¶æ€å¤„ç†
- äº‹ä»¶ç›‘å¬
- Gas ä¼°ç®—å’Œä¼˜åŒ–

---

## 10. ã€ä¸€å¥è¯æ€»ç»“ã€‘

**åˆçº¦è¯»å†™æ˜¯ DApp ä¸æ™ºèƒ½åˆçº¦äº¤äº’çš„ä¸¤ç§åŸºæœ¬æ“ä½œï¼šè¯»æ“ä½œé€šè¿‡ useReadContract è°ƒç”¨ view/pure å‡½æ•°ï¼Œå…è´¹ä¸”å³æ—¶è¿”å›æ•°æ®ï¼›å†™æ“ä½œé€šè¿‡ useWriteContract å‘èµ·äº¤æ˜“ï¼Œéœ€è¦é’±åŒ…ç­¾åå’Œ Gas è´¹ç”¨ï¼Œè¿”å›äº¤æ˜“å“ˆå¸Œåè¿˜éœ€è¦ useWaitForTransactionReceipt ç­‰å¾…åŒºå—ç¡®è®¤ï¼Œæ˜¯æ„å»ºå®Œæ•´ DApp åŠŸèƒ½çš„æ ¸å¿ƒèƒ½åŠ›ã€‚**

---

## ğŸ“š é™„å½•

### å­¦ä¹ æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬çŸ¥è¯†ç‚¹å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- [ ] ä½¿ç”¨ useReadContract è¯»å–åˆçº¦æ•°æ®
- [ ] ä½¿ç”¨ useWriteContract å‘èµ·äº¤æ˜“
- [ ] ä½¿ç”¨ useWaitForTransactionReceipt ç­‰å¾…ç¡®è®¤
- [ ] ç†è§£ ABI çš„ç»“æ„å’Œä½œç”¨
- [ ] å¤„ç†äº¤æ˜“çš„ loading/success/error çŠ¶æ€
- [ ] é…ç½®ç¼“å­˜ç­–ç•¥ä¼˜åŒ–æ€§èƒ½
- [ ] å®ç°ä»£å¸è½¬è´¦å’ŒæˆæƒåŠŸèƒ½

### å¿«é€Ÿå‚è€ƒå¡

**è¯»å–åˆçº¦ï¼š**
```typescript
const { data, isLoading, refetch } = useReadContract({
  address: '0x...',
  abi: erc20Abi,
  functionName: 'balanceOf',
  args: [userAddress],
});
```

**å†™å…¥åˆçº¦ï¼š**
```typescript
const { writeContract, data: hash, isPending } = useWriteContract();

writeContract({
  address: '0x...',
  abi: erc20Abi,
  functionName: 'transfer',
  args: [recipient, amount],
});
```

**ç­‰å¾…ç¡®è®¤ï¼š**
```typescript
const { isLoading, isSuccess } = useWaitForTransactionReceipt({ hash });
```

**å¸¸ç”¨å·¥å…·å‡½æ•°ï¼š**
```typescript
import { parseUnits, formatUnits } from 'viem';

// è½¬æ¢ä¸ºæœ€å°å•ä½
parseUnits('100', 18);  // 100000000000000000000n

// è½¬æ¢ä¸ºå¯è¯»æ ¼å¼
formatUnits(100000000000000000000n, 18);  // "100"
```

### ä¸‹ä¸€æ­¥å­¦ä¹ 

æ¨èæŒ‰ä»¥ä¸‹é¡ºåºç»§ç»­å­¦ä¹ ï¼š

1. **äº¤æ˜“çŠ¶æ€å¤„ç†** - å®Œå–„äº¤æ˜“ UI ä½“éªŒ
2. **äº‹ä»¶ç›‘å¬** - å®æ—¶æ›´æ–°æ•°æ®
3. **Gas ä¼°ç®—** - ä¼˜åŒ–äº¤æ˜“æˆæœ¬
4. **é”™è¯¯å¤„ç†** - å‹å¥½çš„é”™è¯¯æç¤º

---

**ç‰ˆæœ¬ï¼š** v1.0
**åˆ›å»ºæ—¥æœŸï¼š** 2025-12-12
**ä½œè€…ï¼š** Web3å­¦ä¹ åŠ©æ‰‹
**é€‚ç”¨äººç¾¤ï¼š** å‰ç«¯å·¥ç¨‹å¸ˆè½¬Web3å¼€å‘
